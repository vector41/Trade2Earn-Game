import{n as es,p as ne,e as Or,q as O_,w as tf,t as rf,u as Lc,v as Eo,x as R_,o as jc,y as Ei,V as T_,M as A_,N as Y,z as C_,A as yc,B as $_,K as N_,C as D_,D as Fh,E as L_,H as j_,F as q_,G as Gh,$ as M_,I as z_,J as U_,L as Qn,O as Wh,X as H_,P as k_,Q as qc,_ as nf,R as Lr,S as K_,T as Jh,U as pn,W as Nt,Y as Gt,Z as bi,a0 as hr,a1 as B_,a2 as dn,a3 as sf,a4 as V_,a5 as F_,a6 as G_,a7 as of,a8 as W_,a9 as af,aa as cf,ab as yn,ac as vc,ad as go,ae as mn,af as J_,ag as yo,ah as Q_,ai as Y_,aj as X_,ak as Z_,al as co,am as ew,an as tw,ao as Za,ap as Qh,aq as rw,ar as iw,as as nw,at as Yh,au as sw,av as ow,aw,ax as cw,ay as uw,az as hw,aA as lw,a as fw,aB as Fn,aC as uf,aD as ec,aE as pw,aF as dw,aG as gw}from"./index-d5cPsESa.js";const yw=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,vw=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,mw=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function _w(a,t){if(a==="__proto__"||a==="constructor"&&t&&typeof t=="object"&&"prototype"in t){ww(a);return}return t}function ww(a){console.warn(`[destr] Dropping "${a}" key to prevent prototype pollution.`)}function uo(a,t={}){if(typeof a!="string")return a;const r=a.trim();if(a[0]==='"'&&a.at(-1)==='"'&&!a.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!mw.test(a)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return a}try{if(yw.test(a)||vw.test(a)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(a,_w)}return JSON.parse(a)}catch(n){if(t.strict)throw n;return a}}function bw(a){return!a||typeof a.then!="function"?Promise.resolve(a):a}function Ut(a,...t){try{return bw(a(...t))}catch(r){return Promise.reject(r)}}function Ew(a){const t=typeof a;return a===null||t!=="object"&&t!=="function"}function Iw(a){const t=Object.getPrototypeOf(a);return!t||t.isPrototypeOf(Object)}function vo(a){if(Ew(a))return String(a);if(Iw(a)||Array.isArray(a))return JSON.stringify(a);if(typeof a.toJSON=="function")return vo(a.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function hf(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const mc="base64:";function xw(a){if(typeof a=="string")return a;hf();const t=Buffer.from(a).toString("base64");return mc+t}function Pw(a){return typeof a!="string"||!a.startsWith(mc)?a:(hf(),Buffer.from(a.slice(mc.length),"base64"))}function ur(a){return a?a.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Sw(...a){return ur(a.join(":"))}function ho(a){return a=ur(a),a?a+":":""}const Ow="memory",Rw=()=>{const a=new Map;return{name:Ow,options:{},hasItem(t){return a.has(t)},getItem(t){return a.get(t)??null},getItemRaw(t){return a.get(t)??null},setItem(t,r){a.set(t,r)},setItemRaw(t,r){a.set(t,r)},removeItem(t){a.delete(t)},getKeys(){return Array.from(a.keys())},clear(){a.clear()},dispose(){a.clear()}}};function Tw(a={}){const t={mounts:{"":a.driver||Rw()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=p=>{for(const b of t.mountpoints)if(p.startsWith(b))return{base:b,relativeKey:p.slice(b.length),driver:t.mounts[b]};return{base:"",relativeKey:p,driver:t.mounts[""]}},n=(p,b)=>t.mountpoints.filter(S=>S.startsWith(p)||b&&p.startsWith(S)).map(S=>({relativeBase:p.length>S.length?p.slice(S.length):void 0,mountpoint:S,driver:t.mounts[S]})),s=(p,b)=>{if(t.watching){b=ur(b);for(const S of t.watchListeners)S(p,b)}},c=async()=>{if(!t.watching){t.watching=!0;for(const p in t.mounts)t.unwatch[p]=await Xh(t.mounts[p],s,p)}},l=async()=>{if(t.watching){for(const p in t.unwatch)await t.unwatch[p]();t.unwatch={},t.watching=!1}},d=(p,b,S)=>{const x=new Map,D=C=>{let V=x.get(C.base);return V||(V={driver:C.driver,base:C.base,items:[]},x.set(C.base,V)),V};for(const C of p){const V=typeof C=="string",re=ur(V?C:C.key),he=V?void 0:C.value,le=V||!C.options?b:{...b,...C.options},fe=r(re);D(fe).items.push({key:re,value:he,relativeKey:fe.relativeKey,options:le})}return Promise.all([...x.values()].map(C=>S(C))).then(C=>C.flat())},_={hasItem(p,b={}){p=ur(p);const{relativeKey:S,driver:x}=r(p);return Ut(x.hasItem,S,b)},getItem(p,b={}){p=ur(p);const{relativeKey:S,driver:x}=r(p);return Ut(x.getItem,S,b).then(D=>uo(D))},getItems(p,b){return d(p,b,S=>S.driver.getItems?Ut(S.driver.getItems,S.items.map(x=>({key:x.relativeKey,options:x.options})),b).then(x=>x.map(D=>({key:Sw(S.base,D.key),value:uo(D.value)}))):Promise.all(S.items.map(x=>Ut(S.driver.getItem,x.relativeKey,x.options).then(D=>({key:x.key,value:uo(D)})))))},getItemRaw(p,b={}){p=ur(p);const{relativeKey:S,driver:x}=r(p);return x.getItemRaw?Ut(x.getItemRaw,S,b):Ut(x.getItem,S,b).then(D=>Pw(D))},async setItem(p,b,S={}){if(b===void 0)return _.removeItem(p);p=ur(p);const{relativeKey:x,driver:D}=r(p);D.setItem&&(await Ut(D.setItem,x,vo(b),S),D.watch||s("update",p))},async setItems(p,b){await d(p,b,async S=>{S.driver.setItems&&await Ut(S.driver.setItems,S.items.map(x=>({key:x.relativeKey,value:vo(x.value),options:x.options})),b),S.driver.setItem&&await Promise.all(S.items.map(x=>Ut(S.driver.setItem,x.relativeKey,vo(x.value),x.options)))})},async setItemRaw(p,b,S={}){if(b===void 0)return _.removeItem(p,S);p=ur(p);const{relativeKey:x,driver:D}=r(p);if(D.setItemRaw)await Ut(D.setItemRaw,x,b,S);else if(D.setItem)await Ut(D.setItem,x,xw(b),S);else return;D.watch||s("update",p)},async removeItem(p,b={}){typeof b=="boolean"&&(b={removeMeta:b}),p=ur(p);const{relativeKey:S,driver:x}=r(p);x.removeItem&&(await Ut(x.removeItem,S,b),(b.removeMeta||b.removeMata)&&await Ut(x.removeItem,S+"$",b),x.watch||s("remove",p))},async getMeta(p,b={}){typeof b=="boolean"&&(b={nativeOnly:b}),p=ur(p);const{relativeKey:S,driver:x}=r(p),D=Object.create(null);if(x.getMeta&&Object.assign(D,await Ut(x.getMeta,S,b)),!b.nativeOnly){const C=await Ut(x.getItem,S+"$",b).then(V=>uo(V));C&&typeof C=="object"&&(typeof C.atime=="string"&&(C.atime=new Date(C.atime)),typeof C.mtime=="string"&&(C.mtime=new Date(C.mtime)),Object.assign(D,C))}return D},setMeta(p,b,S={}){return this.setItem(p+"$",b,S)},removeMeta(p,b={}){return this.removeItem(p+"$",b)},async getKeys(p,b={}){p=ho(p);const S=n(p,!0);let x=[];const D=[];for(const C of S){const re=(await Ut(C.driver.getKeys,C.relativeBase,b)).map(he=>C.mountpoint+ur(he)).filter(he=>!x.some(le=>he.startsWith(le)));D.push(...re),x=[C.mountpoint,...x.filter(he=>!he.startsWith(C.mountpoint))]}return p?D.filter(C=>C.startsWith(p)&&!C.endsWith("$")):D.filter(C=>!C.endsWith("$"))},async clear(p,b={}){p=ho(p),await Promise.all(n(p,!1).map(async S=>{if(S.driver.clear)return Ut(S.driver.clear,S.relativeBase,b);if(S.driver.removeItem){const x=await S.driver.getKeys(S.relativeBase||"",b);return Promise.all(x.map(D=>S.driver.removeItem(D,b)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(p=>Zh(p)))},async watch(p){return await c(),t.watchListeners.push(p),async()=>{t.watchListeners=t.watchListeners.filter(b=>b!==p),t.watchListeners.length===0&&await l()}},async unwatch(){t.watchListeners=[],await l()},mount(p,b){if(p=ho(p),p&&t.mounts[p])throw new Error(`already mounted at ${p}`);return p&&(t.mountpoints.push(p),t.mountpoints.sort((S,x)=>x.length-S.length)),t.mounts[p]=b,t.watching&&Promise.resolve(Xh(b,s,p)).then(S=>{t.unwatch[p]=S}).catch(console.error),_},async unmount(p,b=!0){p=ho(p),!(!p||!t.mounts[p])&&(t.watching&&p in t.unwatch&&(t.unwatch[p](),delete t.unwatch[p]),b&&await Zh(t.mounts[p]),t.mountpoints=t.mountpoints.filter(S=>S!==p),delete t.mounts[p])},getMount(p=""){p=ur(p)+":";const b=r(p);return{driver:b.driver,base:b.base}},getMounts(p="",b={}){return p=ur(p),n(p,b.parents).map(x=>({driver:x.driver,base:x.mountpoint}))}};return _}function Xh(a,t,r){return a.watch?a.watch((n,s)=>t(n,r+s)):()=>{}}async function Zh(a){typeof a.dispose=="function"&&await Ut(a.dispose)}function Ki(a){return new Promise((t,r)=>{a.oncomplete=a.onsuccess=()=>t(a.result),a.onabort=a.onerror=()=>r(a.error)})}function lf(a,t){const r=indexedDB.open(a);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=Ki(r);return(s,c)=>n.then(l=>c(l.transaction(t,s).objectStore(t)))}let tc;function ts(){return tc||(tc=lf("keyval-store","keyval")),tc}function el(a,t=ts()){return t("readonly",r=>Ki(r.get(a)))}function Aw(a,t,r=ts()){return r("readwrite",n=>(n.put(t,a),Ki(n.transaction)))}function Cw(a,t=ts()){return t("readwrite",r=>(r.delete(a),Ki(r.transaction)))}function $w(a=ts()){return a("readwrite",t=>(t.clear(),Ki(t.transaction)))}function Nw(a,t){return a.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Ki(a.transaction)}function Dw(a=ts()){return a("readonly",t=>{if(t.getAllKeys)return Ki(t.getAllKeys());const r=[];return Nw(t,n=>r.push(n.key)).then(()=>r)})}const Lw=a=>JSON.stringify(a,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),jw=a=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=a.replace(t,'$1"$2n"$3');return JSON.parse(r,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function rs(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return jw(a)}catch{return a}}function ki(a){return typeof a=="string"?a:Lw(a)||""}const qw="idb-keyval";var Mw=(a={})=>{const t=a.base&&a.base.length>0?`${a.base}:`:"",r=s=>t+s;let n;return a.dbName&&a.storeName&&(n=lf(a.dbName,a.storeName)),{name:qw,options:a,async hasItem(s){return!(typeof await el(r(s),n)>"u")},async getItem(s){return await el(r(s),n)??null},setItem(s,c){return Aw(r(s),c,n)},removeItem(s){return Cw(r(s),n)},getKeys(){return Dw(n)},clear(){return $w(n)}}};const zw="WALLET_CONNECT_V2_INDEXED_DB",Uw="keyvaluestorage";let Hw=class{constructor(){this.indexedDb=Tw({driver:Mw({dbName:zw,storeName:Uw})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,ki(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var rc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},mo={exports:{}};(function(){let a;function t(){}a=t,a.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},a.prototype.setItem=function(r,n){this[r]=String(n)},a.prototype.removeItem=function(r){delete this[r]},a.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},a.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof rc<"u"&&rc.localStorage?mo.exports=rc.localStorage:typeof window<"u"&&window.localStorage?mo.exports=window.localStorage:mo.exports=new t})();function kw(a){var t;return[a[0],rs((t=a[1])!=null?t:"")]}class Kw{constructor(){this.localStorage=mo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(kw)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return rs(r)}async setItem(t,r){this.localStorage.setItem(t,ki(r))}async removeItem(t){this.localStorage.removeItem(t)}}const Bw="wc_storage_version",tl=1,Vw=async(a,t,r)=>{const n=Bw,s=await t.getItem(n);if(s&&s>=tl){r(t);return}const c=await a.getKeys();if(!c.length){r(t);return}const l=[];for(;c.length;){const d=c.shift();if(!d)continue;const _=d.toLowerCase();if(_.includes("wc@")||_.includes("walletconnect")||_.includes("wc_")||_.includes("wallet_connect")){const p=await a.getItem(d);await t.setItem(d,p),l.push(d)}}await t.setItem(n,tl),r(t),Fw(a,l)},Fw=async(a,t)=>{t.length&&t.forEach(async r=>{await a.removeItem(r)})};let Gw=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new Kw;this.storage=t;try{const r=new Hw;Vw(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var _n={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var _c=function(a,t){return _c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])},_c(a,t)};function Ww(a,t){_c(a,t);function r(){this.constructor=a}a.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var wc=function(){return wc=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},wc.apply(this,arguments)};function Jw(a,t){var r={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(r[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(r[n[s]]=a[n[s]]);return r}function Qw(a,t,r,n){var s=arguments.length,c=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,t,r,n);else for(var d=a.length-1;d>=0;d--)(l=a[d])&&(c=(s<3?l(c):s>3?l(t,r,c):l(t,r))||c);return s>3&&c&&Object.defineProperty(t,r,c),c}function Yw(a,t){return function(r,n){t(r,n,a)}}function Xw(a,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,t)}function Zw(a,t,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function d(b){try{p(n.next(b))}catch(S){l(S)}}function _(b){try{p(n.throw(b))}catch(S){l(S)}}function p(b){b.done?c(b.value):s(b.value).then(d,_)}p((n=n.apply(a,t||[])).next())})}function e0(a,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(p){return function(b){return _([p,b])}}function _(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(c=p[0]&2?s.return:p[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,p[1])).done)return c;switch(s=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,s=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){r.label=p[1];break}if(p[0]===6&&r.label<c[1]){r.label=c[1],c=p;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(p);break}c[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(a,r)}catch(b){p=[6,b],s=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function t0(a,t,r,n){n===void 0&&(n=r),a[n]=t[r]}function r0(a,t){for(var r in a)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=a[r])}function bc(a){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&a[t],n=0;if(r)return r.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ff(a,t){var r=typeof Symbol=="function"&&a[Symbol.iterator];if(!r)return a;var n=r.call(a),s,c=[],l;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(d){l={error:d}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(l)throw l.error}}return c}function i0(){for(var a=[],t=0;t<arguments.length;t++)a=a.concat(ff(arguments[t]));return a}function n0(){for(var a=0,t=0,r=arguments.length;t<r;t++)a+=arguments[t].length;for(var n=Array(a),s=0,t=0;t<r;t++)for(var c=arguments[t],l=0,d=c.length;l<d;l++,s++)n[s]=c[l];return n}function Yn(a){return this instanceof Yn?(this.v=a,this):new Yn(a)}function s0(a,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(a,t||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(x){n[x]&&(s[x]=function(D){return new Promise(function(C,V){c.push([x,D,C,V])>1||d(x,D)})})}function d(x,D){try{_(n[x](D))}catch(C){S(c[0][3],C)}}function _(x){x.value instanceof Yn?Promise.resolve(x.value.v).then(p,b):S(c[0][2],x)}function p(x){d("next",x)}function b(x){d("throw",x)}function S(x,D){x(D),c.shift(),c.length&&d(c[0][0],c[0][1])}}function o0(a){var t,r;return t={},n("next"),n("throw",function(s){throw s}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(s,c){t[s]=a[s]?function(l){return(r=!r)?{value:Yn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function a0(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=a[Symbol.asyncIterator],r;return t?t.call(a):(a=typeof bc=="function"?bc(a):a[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(c){r[c]=a[c]&&function(l){return new Promise(function(d,_){l=a[c](l),s(d,_,l.done,l.value)})}}function s(c,l,d,_){Promise.resolve(_).then(function(p){c({value:p,done:d})},l)}}function c0(a,t){return Object.defineProperty?Object.defineProperty(a,"raw",{value:t}):a.raw=t,a}function u0(a){if(a&&a.__esModule)return a;var t={};if(a!=null)for(var r in a)Object.hasOwnProperty.call(a,r)&&(t[r]=a[r]);return t.default=a,t}function h0(a){return a&&a.__esModule?a:{default:a}}function l0(a,t){if(!t.has(a))throw new TypeError("attempted to get private field on non-instance");return t.get(a)}function f0(a,t,r){if(!t.has(a))throw new TypeError("attempted to set private field on non-instance");return t.set(a,r),r}const p0=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return wc},__asyncDelegator:o0,__asyncGenerator:s0,__asyncValues:a0,__await:Yn,__awaiter:Zw,__classPrivateFieldGet:l0,__classPrivateFieldSet:f0,__createBinding:t0,__decorate:Qw,__exportStar:r0,__extends:Ww,__generator:e0,__importDefault:h0,__importStar:u0,__makeTemplateObject:c0,__metadata:Xw,__param:Yw,__read:ff,__rest:Jw,__spread:i0,__spreadArrays:n0,__values:bc},Symbol.toStringTag,{value:"Module"})),Io=es(p0);var zn={},ic={},Un={};let Bi=class{};const d0=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Bi},Symbol.toStringTag,{value:"Module"})),g0=es(d0);var rl;function y0(){if(rl)return Un;rl=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.IHeartBeat=void 0;const a=g0;class t extends a.IEvents{constructor(n){super()}}return Un.IHeartBeat=t,Un}var il;function pf(){return il||(il=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),Io.__exportStar(y0(),a)}(ic)),ic}var nc={},Ui={},nl;function v0(){if(nl)return Ui;nl=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.HEARTBEAT_EVENTS=Ui.HEARTBEAT_INTERVAL=void 0;const a=ne;return Ui.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,Ui.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Ui}var sl;function df(){return sl||(sl=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),Io.__exportStar(v0(),a)}(nc)),nc}var ol;function m0(){if(ol)return zn;ol=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.HeartBeat=void 0;const a=Io,t=Or,r=ne,n=pf(),s=df();class c extends n.IHeartBeat{constructor(d){super(d),this.events=new t.EventEmitter,this.interval=s.HEARTBEAT_INTERVAL,this.interval=(d==null?void 0:d.interval)||s.HEARTBEAT_INTERVAL}static init(d){return a.__awaiter(this,void 0,void 0,function*(){const _=new c(d);return yield _.init(),_})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(d,_){this.events.on(d,_)}once(d,_){this.events.once(d,_)}off(d,_){this.events.off(d,_)}removeListener(d,_){this.events.removeListener(d,_)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(s.HEARTBEAT_EVENTS.pulse)}}return zn.HeartBeat=c,zn}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=Io;t.__exportStar(m0(),a),t.__exportStar(pf(),a),t.__exportStar(df(),a)})(_n);var Re={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ec=function(a,t){return Ec=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])},Ec(a,t)};function _0(a,t){Ec(a,t);function r(){this.constructor=a}a.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Ic=function(){return Ic=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},Ic.apply(this,arguments)};function w0(a,t){var r={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(r[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(r[n[s]]=a[n[s]]);return r}function b0(a,t,r,n){var s=arguments.length,c=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,t,r,n);else for(var d=a.length-1;d>=0;d--)(l=a[d])&&(c=(s<3?l(c):s>3?l(t,r,c):l(t,r))||c);return s>3&&c&&Object.defineProperty(t,r,c),c}function E0(a,t){return function(r,n){t(r,n,a)}}function I0(a,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,t)}function x0(a,t,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function d(b){try{p(n.next(b))}catch(S){l(S)}}function _(b){try{p(n.throw(b))}catch(S){l(S)}}function p(b){b.done?c(b.value):s(b.value).then(d,_)}p((n=n.apply(a,t||[])).next())})}function P0(a,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(p){return function(b){return _([p,b])}}function _(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(c=p[0]&2?s.return:p[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,p[1])).done)return c;switch(s=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,s=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){r.label=p[1];break}if(p[0]===6&&r.label<c[1]){r.label=c[1],c=p;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(p);break}c[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(a,r)}catch(b){p=[6,b],s=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function S0(a,t,r,n){n===void 0&&(n=r),a[n]=t[r]}function O0(a,t){for(var r in a)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=a[r])}function xc(a){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&a[t],n=0;if(r)return r.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function gf(a,t){var r=typeof Symbol=="function"&&a[Symbol.iterator];if(!r)return a;var n=r.call(a),s,c=[],l;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(d){l={error:d}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(l)throw l.error}}return c}function R0(){for(var a=[],t=0;t<arguments.length;t++)a=a.concat(gf(arguments[t]));return a}function T0(){for(var a=0,t=0,r=arguments.length;t<r;t++)a+=arguments[t].length;for(var n=Array(a),s=0,t=0;t<r;t++)for(var c=arguments[t],l=0,d=c.length;l<d;l++,s++)n[s]=c[l];return n}function Xn(a){return this instanceof Xn?(this.v=a,this):new Xn(a)}function A0(a,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(a,t||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(x){n[x]&&(s[x]=function(D){return new Promise(function(C,V){c.push([x,D,C,V])>1||d(x,D)})})}function d(x,D){try{_(n[x](D))}catch(C){S(c[0][3],C)}}function _(x){x.value instanceof Xn?Promise.resolve(x.value.v).then(p,b):S(c[0][2],x)}function p(x){d("next",x)}function b(x){d("throw",x)}function S(x,D){x(D),c.shift(),c.length&&d(c[0][0],c[0][1])}}function C0(a){var t,r;return t={},n("next"),n("throw",function(s){throw s}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(s,c){t[s]=a[s]?function(l){return(r=!r)?{value:Xn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function $0(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=a[Symbol.asyncIterator],r;return t?t.call(a):(a=typeof xc=="function"?xc(a):a[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(c){r[c]=a[c]&&function(l){return new Promise(function(d,_){l=a[c](l),s(d,_,l.done,l.value)})}}function s(c,l,d,_){Promise.resolve(_).then(function(p){c({value:p,done:d})},l)}}function N0(a,t){return Object.defineProperty?Object.defineProperty(a,"raw",{value:t}):a.raw=t,a}function D0(a){if(a&&a.__esModule)return a;var t={};if(a!=null)for(var r in a)Object.hasOwnProperty.call(a,r)&&(t[r]=a[r]);return t.default=a,t}function L0(a){return a&&a.__esModule?a:{default:a}}function j0(a,t){if(!t.has(a))throw new TypeError("attempted to get private field on non-instance");return t.get(a)}function q0(a,t,r){if(!t.has(a))throw new TypeError("attempted to set private field on non-instance");return t.set(a,r),r}const M0=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Ic},__asyncDelegator:C0,__asyncGenerator:A0,__asyncValues:$0,__await:Xn,__awaiter:x0,__classPrivateFieldGet:j0,__classPrivateFieldSet:q0,__createBinding:S0,__decorate:b0,__exportStar:O0,__extends:_0,__generator:P0,__importDefault:L0,__importStar:D0,__makeTemplateObject:N0,__metadata:I0,__param:E0,__read:gf,__rest:w0,__spread:R0,__spreadArrays:T0,__values:xc},Symbol.toStringTag,{value:"Module"})),z0=es(M0);var sc,al;function U0(){if(al)return sc;al=1;function a(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}sc=t;function t(r,n,s){var c=s&&s.stringify||a,l=1;if(typeof r=="object"&&r!==null){var d=n.length+l;if(d===1)return r;var _=new Array(d);_[0]=c(r);for(var p=1;p<d;p++)_[p]=c(n[p]);return _.join(" ")}if(typeof r!="string")return r;var b=n.length;if(b===0)return r;for(var S="",x=1-l,D=-1,C=r&&r.length||0,V=0;V<C;){if(r.charCodeAt(V)===37&&V+1<C){switch(D=D>-1?D:0,r.charCodeAt(V+1)){case 100:case 102:if(x>=b||n[x]==null)break;D<V&&(S+=r.slice(D,V)),S+=Number(n[x]),D=V+2,V++;break;case 105:if(x>=b||n[x]==null)break;D<V&&(S+=r.slice(D,V)),S+=Math.floor(Number(n[x])),D=V+2,V++;break;case 79:case 111:case 106:if(x>=b||n[x]===void 0)break;D<V&&(S+=r.slice(D,V));var re=typeof n[x];if(re==="string"){S+="'"+n[x]+"'",D=V+2,V++;break}if(re==="function"){S+=n[x].name||"<anonymous>",D=V+2,V++;break}S+=c(n[x]),D=V+2,V++;break;case 115:if(x>=b)break;D<V&&(S+=r.slice(D,V)),S+=String(n[x]),D=V+2,V++;break;case 37:D<V&&(S+=r.slice(D,V)),S+="%",D=V+2,V++,x--;break}++x}++V}return D===-1?r:(D<C&&(S+=r.slice(D)),S)}return sc}var oc,cl;function H0(){if(cl)return oc;cl=1;const a=U0();oc=s;const t=de().console||{},r={mapHttpRequest:C,mapHttpResponse:C,wrapRequestSerializer:V,wrapResponseSerializer:V,wrapErrorSerializer:V,req:C,res:C,err:x};function n(j,H){return Array.isArray(j)?j.filter(function(ve){return ve!=="!stdSerializers.err"}):j===!0?Object.keys(H):!1}function s(j){j=j||{},j.browser=j.browser||{};const H=j.browser.transmit;if(H&&typeof H.send!="function")throw Error("pino: transmit option must have a send function");const W=j.browser.write||t;j.browser.write&&(j.browser.asObject=!0);const ve=j.serializers||{},ie=n(j.browser.serialize,ve);let ue=j.browser.serialize;Array.isArray(j.browser.serialize)&&j.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Ce=["error","fatal","warn","info","debug","trace"];typeof W=="function"&&(W.error=W.fatal=W.warn=W.info=W.debug=W.trace=W),j.enabled===!1&&(j.level="silent");const Ue=j.level||"info",m=Object.create(W);m.log||(m.log=re),Object.defineProperty(m,"levelVal",{get:X}),Object.defineProperty(m,"level",{get:ce,set:F});const P={transmit:H,serialize:ie,asObject:j.browser.asObject,levels:Ce,timestamp:D(j)};m.levels=s.levels,m.level=Ue,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=re,m.serializers=ve,m._serialize=ie,m._stdErrSerialize=ue,m.child=k,H&&(m._logEvent=S());function X(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function F(B){if(B!=="silent"&&!this.levels.values[B])throw Error("unknown level "+B);this._level=B,c(P,m,"error","log"),c(P,m,"fatal","error"),c(P,m,"warn","error"),c(P,m,"info","log"),c(P,m,"debug","log"),c(P,m,"trace","log")}function k(B,G){if(!B)throw new Error("missing bindings for child Pino");G=G||{},ie&&B.serializers&&(G.serializers=B.serializers);const Je=G.serializers;if(ie&&Je){var Ke=Object.assign({},ve,Je),qr=j.browser.serialize===!0?Object.keys(Ke):ie;delete B.serializers,_([B],qr,Ke,this._stdErrSerialize)}function Ie(It){this._childLevel=(It._childLevel|0)+1,this.error=p(It,B,"error"),this.fatal=p(It,B,"fatal"),this.warn=p(It,B,"warn"),this.info=p(It,B,"info"),this.debug=p(It,B,"debug"),this.trace=p(It,B,"trace"),Ke&&(this.serializers=Ke,this._serialize=qr),H&&(this._logEvent=S([].concat(It._logEvent.bindings,B)))}return Ie.prototype=this,new Ie(this)}return m}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=r,s.stdTimeFunctions=Object.assign({},{nullTime:he,epochTime:le,unixTime:fe,isoTime:pe});function c(j,H,W,ve){const ie=Object.getPrototypeOf(H);H[W]=H.levelVal>H.levels.values[W]?re:ie[W]?ie[W]:t[W]||t[ve]||re,l(j,H,W)}function l(j,H,W){!j.transmit&&H[W]===re||(H[W]=function(ve){return function(){const ue=j.timestamp(),Ce=new Array(arguments.length),Ue=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var m=0;m<Ce.length;m++)Ce[m]=arguments[m];if(j.serialize&&!j.asObject&&_(Ce,this._serialize,this.serializers,this._stdErrSerialize),j.asObject?ve.call(Ue,d(this,W,Ce,ue)):ve.apply(Ue,Ce),j.transmit){const P=j.transmit.level||H.level,X=s.levels.values[P],ce=s.levels.values[W];if(ce<X)return;b(this,{ts:ue,methodLevel:W,methodValue:ce,transmitLevel:P,transmitValue:s.levels.values[j.transmit.level||H.level],send:j.transmit.send,val:H.levelVal},Ce)}}}(H[W]))}function d(j,H,W,ve){j._serialize&&_(W,j._serialize,j.serializers,j._stdErrSerialize);const ie=W.slice();let ue=ie[0];const Ce={};ve&&(Ce.time=ve),Ce.level=s.levels.values[H];let Ue=(j._childLevel|0)+1;if(Ue<1&&(Ue=1),ue!==null&&typeof ue=="object"){for(;Ue--&&typeof ie[0]=="object";)Object.assign(Ce,ie.shift());ue=ie.length?a(ie.shift(),ie):void 0}else typeof ue=="string"&&(ue=a(ie.shift(),ie));return ue!==void 0&&(Ce.msg=ue),Ce}function _(j,H,W,ve){for(const ie in j)if(ve&&j[ie]instanceof Error)j[ie]=s.stdSerializers.err(j[ie]);else if(typeof j[ie]=="object"&&!Array.isArray(j[ie]))for(const ue in j[ie])H&&H.indexOf(ue)>-1&&ue in W&&(j[ie][ue]=W[ue](j[ie][ue]))}function p(j,H,W){return function(){const ve=new Array(1+arguments.length);ve[0]=H;for(var ie=1;ie<ve.length;ie++)ve[ie]=arguments[ie-1];return j[W].apply(this,ve)}}function b(j,H,W){const ve=H.send,ie=H.ts,ue=H.methodLevel,Ce=H.methodValue,Ue=H.val,m=j._logEvent.bindings;_(W,j._serialize||Object.keys(j.serializers),j.serializers,j._stdErrSerialize===void 0?!0:j._stdErrSerialize),j._logEvent.ts=ie,j._logEvent.messages=W.filter(function(P){return m.indexOf(P)===-1}),j._logEvent.level.label=ue,j._logEvent.level.value=Ce,ve(ue,j._logEvent,Ue),j._logEvent=S(m)}function S(j){return{ts:0,messages:[],bindings:j||[],level:{label:"",value:0}}}function x(j){const H={type:j.constructor.name,msg:j.message,stack:j.stack};for(const W in j)H[W]===void 0&&(H[W]=j[W]);return H}function D(j){return typeof j.timestamp=="function"?j.timestamp:j.timestamp===!1?he:le}function C(){return{}}function V(j){return j}function re(){}function he(){return!1}function le(){return Date.now()}function fe(){return Math.round(Date.now()/1e3)}function pe(){return new Date(Date.now()).toISOString()}function de(){function j(H){return typeof H<"u"&&H}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return j(self)||j(window)||j(this)||{}}}return oc}var Hi={},ul;function yf(){return ul||(ul=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.PINO_CUSTOM_CONTEXT_KEY=Hi.PINO_LOGGER_DEFAULTS=void 0,Hi.PINO_LOGGER_DEFAULTS={level:"info"},Hi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Hi}var tr={},hl;function k0(){if(hl)return tr;hl=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.generateChildLogger=tr.formatChildLoggerContext=tr.getLoggerContext=tr.setBrowserLoggerContext=tr.getBrowserLoggerContext=tr.getDefaultLoggerOptions=void 0;const a=yf();function t(d){return Object.assign(Object.assign({},d),{level:(d==null?void 0:d.level)||a.PINO_LOGGER_DEFAULTS.level})}tr.getDefaultLoggerOptions=t;function r(d,_=a.PINO_CUSTOM_CONTEXT_KEY){return d[_]||""}tr.getBrowserLoggerContext=r;function n(d,_,p=a.PINO_CUSTOM_CONTEXT_KEY){return d[p]=_,d}tr.setBrowserLoggerContext=n;function s(d,_=a.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof d.bindings>"u"?p=r(d,_):p=d.bindings().context||"",p}tr.getLoggerContext=s;function c(d,_,p=a.PINO_CUSTOM_CONTEXT_KEY){const b=s(d,p);return b.trim()?`${b}/${_}`:_}tr.formatChildLoggerContext=c;function l(d,_,p=a.PINO_CUSTOM_CONTEXT_KEY){const b=c(d,_,p),S=d.child({context:b});return n(S,b,p)}return tr.generateChildLogger=l,tr}(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.pino=void 0;const t=z0,r=t.__importDefault(H0());Object.defineProperty(a,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(yf(),a),t.__exportStar(k0(),a)})(Re);class K0 extends Bi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let B0=class extends Bi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},V0=class{constructor(t,r){this.logger=t,this.core=r}},F0=class extends Bi{constructor(t,r){super(),this.relayer=t,this.logger=r}},G0=class extends Bi{constructor(t){super()}},W0=class{constructor(t,r,n,s){this.core=t,this.logger=r,this.name=n}};class J0 extends Bi{constructor(t,r){super(),this.relayer=t,this.logger=r}}let Q0=class extends Bi{constructor(t,r){super(),this.core=t,this.logger=r}},Y0=class{constructor(t,r){this.projectId=t,this.logger=r}},X0=class{constructor(t,r){this.projectId=t,this.logger=r}},Z0=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},eb=class{constructor(t){this.client=t}};var Mc={},vf={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var t=O_,r=tf;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var n=function(){function d(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},d.prototype.update=function(_,p){if(p===void 0&&(p=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var b=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=_[b++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(b=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,b,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=_[b++],p--;return this},d.prototype.finish=function(_){if(!this._finished){var p=this._bytesHashed,b=this._bufferLength,S=p/536870912|0,x=p<<3,D=p%128<112?128:256;this._buffer[b]=128;for(var C=b+1;C<D-8;C++)this._buffer[C]=0;t.writeUint32BE(S,this._buffer,D-8),t.writeUint32BE(x,this._buffer,D-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,D),this._finished=!0}for(var C=0;C<this.digestLength/8;C++)t.writeUint32BE(this._stateHi[C],_,C*8),t.writeUint32BE(this._stateLo[C],_,C*8+4);return this},d.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(_){r.wipe(_.stateHi),r.wipe(_.stateLo),_.buffer&&r.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},d}();a.SHA512=n;var s=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(d,_,p,b,S,x,D){for(var C=p[0],V=p[1],re=p[2],he=p[3],le=p[4],fe=p[5],pe=p[6],de=p[7],j=b[0],H=b[1],W=b[2],ve=b[3],ie=b[4],ue=b[5],Ce=b[6],Ue=b[7],m,P,X,ce,F,k,B,G;D>=128;){for(var Je=0;Je<16;Je++){var Ke=8*Je+x;d[Je]=t.readUint32BE(S,Ke),_[Je]=t.readUint32BE(S,Ke+4)}for(var Je=0;Je<80;Je++){var qr=C,Ie=V,It=re,L=he,N=le,A=fe,h=pe,I=de,ee=j,ge=H,be=W,$e=ve,De=ie,Se=ue,xt=Ce,mt=Ue;if(m=de,P=Ue,F=P&65535,k=P>>>16,B=m&65535,G=m>>>16,m=(le>>>14|ie<<18)^(le>>>18|ie<<14)^(ie>>>9|le<<23),P=(ie>>>14|le<<18)^(ie>>>18|le<<14)^(le>>>9|ie<<23),F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,m=le&fe^~le&pe,P=ie&ue^~ie&Ce,F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,m=s[Je*2],P=s[Je*2+1],F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,m=d[Je%16],P=_[Je%16],F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,k+=F>>>16,B+=k>>>16,G+=B>>>16,X=B&65535|G<<16,ce=F&65535|k<<16,m=X,P=ce,F=P&65535,k=P>>>16,B=m&65535,G=m>>>16,m=(C>>>28|j<<4)^(j>>>2|C<<30)^(j>>>7|C<<25),P=(j>>>28|C<<4)^(C>>>2|j<<30)^(C>>>7|j<<25),F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,m=C&V^C&re^V&re,P=j&H^j&W^H&W,F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,k+=F>>>16,B+=k>>>16,G+=B>>>16,I=B&65535|G<<16,mt=F&65535|k<<16,m=L,P=$e,F=P&65535,k=P>>>16,B=m&65535,G=m>>>16,m=X,P=ce,F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,k+=F>>>16,B+=k>>>16,G+=B>>>16,L=B&65535|G<<16,$e=F&65535|k<<16,V=qr,re=Ie,he=It,le=L,fe=N,pe=A,de=h,C=I,H=ee,W=ge,ve=be,ie=$e,ue=De,Ce=Se,Ue=xt,j=mt,Je%16===15)for(var Ke=0;Ke<16;Ke++)m=d[Ke],P=_[Ke],F=P&65535,k=P>>>16,B=m&65535,G=m>>>16,m=d[(Ke+9)%16],P=_[(Ke+9)%16],F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,X=d[(Ke+1)%16],ce=_[(Ke+1)%16],m=(X>>>1|ce<<31)^(X>>>8|ce<<24)^X>>>7,P=(ce>>>1|X<<31)^(ce>>>8|X<<24)^(ce>>>7|X<<25),F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,X=d[(Ke+14)%16],ce=_[(Ke+14)%16],m=(X>>>19|ce<<13)^(ce>>>29|X<<3)^X>>>6,P=(ce>>>19|X<<13)^(X>>>29|ce<<3)^(ce>>>6|X<<26),F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,k+=F>>>16,B+=k>>>16,G+=B>>>16,d[Ke]=B&65535|G<<16,_[Ke]=F&65535|k<<16}m=C,P=j,F=P&65535,k=P>>>16,B=m&65535,G=m>>>16,m=p[0],P=b[0],F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,k+=F>>>16,B+=k>>>16,G+=B>>>16,p[0]=C=B&65535|G<<16,b[0]=j=F&65535|k<<16,m=V,P=H,F=P&65535,k=P>>>16,B=m&65535,G=m>>>16,m=p[1],P=b[1],F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,k+=F>>>16,B+=k>>>16,G+=B>>>16,p[1]=V=B&65535|G<<16,b[1]=H=F&65535|k<<16,m=re,P=W,F=P&65535,k=P>>>16,B=m&65535,G=m>>>16,m=p[2],P=b[2],F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,k+=F>>>16,B+=k>>>16,G+=B>>>16,p[2]=re=B&65535|G<<16,b[2]=W=F&65535|k<<16,m=he,P=ve,F=P&65535,k=P>>>16,B=m&65535,G=m>>>16,m=p[3],P=b[3],F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,k+=F>>>16,B+=k>>>16,G+=B>>>16,p[3]=he=B&65535|G<<16,b[3]=ve=F&65535|k<<16,m=le,P=ie,F=P&65535,k=P>>>16,B=m&65535,G=m>>>16,m=p[4],P=b[4],F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,k+=F>>>16,B+=k>>>16,G+=B>>>16,p[4]=le=B&65535|G<<16,b[4]=ie=F&65535|k<<16,m=fe,P=ue,F=P&65535,k=P>>>16,B=m&65535,G=m>>>16,m=p[5],P=b[5],F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,k+=F>>>16,B+=k>>>16,G+=B>>>16,p[5]=fe=B&65535|G<<16,b[5]=ue=F&65535|k<<16,m=pe,P=Ce,F=P&65535,k=P>>>16,B=m&65535,G=m>>>16,m=p[6],P=b[6],F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,k+=F>>>16,B+=k>>>16,G+=B>>>16,p[6]=pe=B&65535|G<<16,b[6]=Ce=F&65535|k<<16,m=de,P=Ue,F=P&65535,k=P>>>16,B=m&65535,G=m>>>16,m=p[7],P=b[7],F+=P&65535,k+=P>>>16,B+=m&65535,G+=m>>>16,k+=F>>>16,B+=k>>>16,G+=B>>>16,p[7]=de=B&65535|G<<16,b[7]=Ue=F&65535|k<<16,x+=128,D-=128}return x}function l(d){var _=new n;_.update(d);var p=_.digest();return _.clean(),p}a.hash=l})(vf);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const t=rf,r=vf,n=tf;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function s(L){const N=new Float64Array(16);if(L)for(let A=0;A<L.length;A++)N[A]=L[A];return N}const c=new Uint8Array(32);c[0]=9;const l=s(),d=s([1]),_=s([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=s([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=s([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),S=s([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),x=s([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function D(L,N){for(let A=0;A<16;A++)L[A]=N[A]|0}function C(L){let N=1;for(let A=0;A<16;A++){let h=L[A]+N+65535;N=Math.floor(h/65536),L[A]=h-N*65536}L[0]+=N-1+37*(N-1)}function V(L,N,A){const h=~(A-1);for(let I=0;I<16;I++){const ee=h&(L[I]^N[I]);L[I]^=ee,N[I]^=ee}}function re(L,N){const A=s(),h=s();for(let I=0;I<16;I++)h[I]=N[I];C(h),C(h),C(h);for(let I=0;I<2;I++){A[0]=h[0]-65517;for(let ge=1;ge<15;ge++)A[ge]=h[ge]-65535-(A[ge-1]>>16&1),A[ge-1]&=65535;A[15]=h[15]-32767-(A[14]>>16&1);const ee=A[15]>>16&1;A[14]&=65535,V(h,A,1-ee)}for(let I=0;I<16;I++)L[2*I]=h[I]&255,L[2*I+1]=h[I]>>8}function he(L,N){let A=0;for(let h=0;h<32;h++)A|=L[h]^N[h];return(1&A-1>>>8)-1}function le(L,N){const A=new Uint8Array(32),h=new Uint8Array(32);return re(A,L),re(h,N),he(A,h)}function fe(L){const N=new Uint8Array(32);return re(N,L),N[0]&1}function pe(L,N){for(let A=0;A<16;A++)L[A]=N[2*A]+(N[2*A+1]<<8);L[15]&=32767}function de(L,N,A){for(let h=0;h<16;h++)L[h]=N[h]+A[h]}function j(L,N,A){for(let h=0;h<16;h++)L[h]=N[h]-A[h]}function H(L,N,A){let h,I,ee=0,ge=0,be=0,$e=0,De=0,Se=0,xt=0,mt=0,ot=0,je=0,Ye=0,Xe=0,at=0,He=0,Ze=0,Ne=0,Be=0,ht=0,Me=0,Pt=0,Dt=0,Ht=0,kt=0,qt=0,Jt=0,rr=0,Mr=0,Qt=0,Vr=0,hi=0,Si=0,lt=A[0],rt=A[1],ft=A[2],pt=A[3],ct=A[4],it=A[5],St=A[6],Ot=A[7],dt=A[8],Rt=A[9],gt=A[10],_t=A[11],yt=A[12],Qe=A[13],Tt=A[14],At=A[15];h=N[0],ee+=h*lt,ge+=h*rt,be+=h*ft,$e+=h*pt,De+=h*ct,Se+=h*it,xt+=h*St,mt+=h*Ot,ot+=h*dt,je+=h*Rt,Ye+=h*gt,Xe+=h*_t,at+=h*yt,He+=h*Qe,Ze+=h*Tt,Ne+=h*At,h=N[1],ge+=h*lt,be+=h*rt,$e+=h*ft,De+=h*pt,Se+=h*ct,xt+=h*it,mt+=h*St,ot+=h*Ot,je+=h*dt,Ye+=h*Rt,Xe+=h*gt,at+=h*_t,He+=h*yt,Ze+=h*Qe,Ne+=h*Tt,Be+=h*At,h=N[2],be+=h*lt,$e+=h*rt,De+=h*ft,Se+=h*pt,xt+=h*ct,mt+=h*it,ot+=h*St,je+=h*Ot,Ye+=h*dt,Xe+=h*Rt,at+=h*gt,He+=h*_t,Ze+=h*yt,Ne+=h*Qe,Be+=h*Tt,ht+=h*At,h=N[3],$e+=h*lt,De+=h*rt,Se+=h*ft,xt+=h*pt,mt+=h*ct,ot+=h*it,je+=h*St,Ye+=h*Ot,Xe+=h*dt,at+=h*Rt,He+=h*gt,Ze+=h*_t,Ne+=h*yt,Be+=h*Qe,ht+=h*Tt,Me+=h*At,h=N[4],De+=h*lt,Se+=h*rt,xt+=h*ft,mt+=h*pt,ot+=h*ct,je+=h*it,Ye+=h*St,Xe+=h*Ot,at+=h*dt,He+=h*Rt,Ze+=h*gt,Ne+=h*_t,Be+=h*yt,ht+=h*Qe,Me+=h*Tt,Pt+=h*At,h=N[5],Se+=h*lt,xt+=h*rt,mt+=h*ft,ot+=h*pt,je+=h*ct,Ye+=h*it,Xe+=h*St,at+=h*Ot,He+=h*dt,Ze+=h*Rt,Ne+=h*gt,Be+=h*_t,ht+=h*yt,Me+=h*Qe,Pt+=h*Tt,Dt+=h*At,h=N[6],xt+=h*lt,mt+=h*rt,ot+=h*ft,je+=h*pt,Ye+=h*ct,Xe+=h*it,at+=h*St,He+=h*Ot,Ze+=h*dt,Ne+=h*Rt,Be+=h*gt,ht+=h*_t,Me+=h*yt,Pt+=h*Qe,Dt+=h*Tt,Ht+=h*At,h=N[7],mt+=h*lt,ot+=h*rt,je+=h*ft,Ye+=h*pt,Xe+=h*ct,at+=h*it,He+=h*St,Ze+=h*Ot,Ne+=h*dt,Be+=h*Rt,ht+=h*gt,Me+=h*_t,Pt+=h*yt,Dt+=h*Qe,Ht+=h*Tt,kt+=h*At,h=N[8],ot+=h*lt,je+=h*rt,Ye+=h*ft,Xe+=h*pt,at+=h*ct,He+=h*it,Ze+=h*St,Ne+=h*Ot,Be+=h*dt,ht+=h*Rt,Me+=h*gt,Pt+=h*_t,Dt+=h*yt,Ht+=h*Qe,kt+=h*Tt,qt+=h*At,h=N[9],je+=h*lt,Ye+=h*rt,Xe+=h*ft,at+=h*pt,He+=h*ct,Ze+=h*it,Ne+=h*St,Be+=h*Ot,ht+=h*dt,Me+=h*Rt,Pt+=h*gt,Dt+=h*_t,Ht+=h*yt,kt+=h*Qe,qt+=h*Tt,Jt+=h*At,h=N[10],Ye+=h*lt,Xe+=h*rt,at+=h*ft,He+=h*pt,Ze+=h*ct,Ne+=h*it,Be+=h*St,ht+=h*Ot,Me+=h*dt,Pt+=h*Rt,Dt+=h*gt,Ht+=h*_t,kt+=h*yt,qt+=h*Qe,Jt+=h*Tt,rr+=h*At,h=N[11],Xe+=h*lt,at+=h*rt,He+=h*ft,Ze+=h*pt,Ne+=h*ct,Be+=h*it,ht+=h*St,Me+=h*Ot,Pt+=h*dt,Dt+=h*Rt,Ht+=h*gt,kt+=h*_t,qt+=h*yt,Jt+=h*Qe,rr+=h*Tt,Mr+=h*At,h=N[12],at+=h*lt,He+=h*rt,Ze+=h*ft,Ne+=h*pt,Be+=h*ct,ht+=h*it,Me+=h*St,Pt+=h*Ot,Dt+=h*dt,Ht+=h*Rt,kt+=h*gt,qt+=h*_t,Jt+=h*yt,rr+=h*Qe,Mr+=h*Tt,Qt+=h*At,h=N[13],He+=h*lt,Ze+=h*rt,Ne+=h*ft,Be+=h*pt,ht+=h*ct,Me+=h*it,Pt+=h*St,Dt+=h*Ot,Ht+=h*dt,kt+=h*Rt,qt+=h*gt,Jt+=h*_t,rr+=h*yt,Mr+=h*Qe,Qt+=h*Tt,Vr+=h*At,h=N[14],Ze+=h*lt,Ne+=h*rt,Be+=h*ft,ht+=h*pt,Me+=h*ct,Pt+=h*it,Dt+=h*St,Ht+=h*Ot,kt+=h*dt,qt+=h*Rt,Jt+=h*gt,rr+=h*_t,Mr+=h*yt,Qt+=h*Qe,Vr+=h*Tt,hi+=h*At,h=N[15],Ne+=h*lt,Be+=h*rt,ht+=h*ft,Me+=h*pt,Pt+=h*ct,Dt+=h*it,Ht+=h*St,kt+=h*Ot,qt+=h*dt,Jt+=h*Rt,rr+=h*gt,Mr+=h*_t,Qt+=h*yt,Vr+=h*Qe,hi+=h*Tt,Si+=h*At,ee+=38*Be,ge+=38*ht,be+=38*Me,$e+=38*Pt,De+=38*Dt,Se+=38*Ht,xt+=38*kt,mt+=38*qt,ot+=38*Jt,je+=38*rr,Ye+=38*Mr,Xe+=38*Qt,at+=38*Vr,He+=38*hi,Ze+=38*Si,I=1,h=ee+I+65535,I=Math.floor(h/65536),ee=h-I*65536,h=ge+I+65535,I=Math.floor(h/65536),ge=h-I*65536,h=be+I+65535,I=Math.floor(h/65536),be=h-I*65536,h=$e+I+65535,I=Math.floor(h/65536),$e=h-I*65536,h=De+I+65535,I=Math.floor(h/65536),De=h-I*65536,h=Se+I+65535,I=Math.floor(h/65536),Se=h-I*65536,h=xt+I+65535,I=Math.floor(h/65536),xt=h-I*65536,h=mt+I+65535,I=Math.floor(h/65536),mt=h-I*65536,h=ot+I+65535,I=Math.floor(h/65536),ot=h-I*65536,h=je+I+65535,I=Math.floor(h/65536),je=h-I*65536,h=Ye+I+65535,I=Math.floor(h/65536),Ye=h-I*65536,h=Xe+I+65535,I=Math.floor(h/65536),Xe=h-I*65536,h=at+I+65535,I=Math.floor(h/65536),at=h-I*65536,h=He+I+65535,I=Math.floor(h/65536),He=h-I*65536,h=Ze+I+65535,I=Math.floor(h/65536),Ze=h-I*65536,h=Ne+I+65535,I=Math.floor(h/65536),Ne=h-I*65536,ee+=I-1+37*(I-1),I=1,h=ee+I+65535,I=Math.floor(h/65536),ee=h-I*65536,h=ge+I+65535,I=Math.floor(h/65536),ge=h-I*65536,h=be+I+65535,I=Math.floor(h/65536),be=h-I*65536,h=$e+I+65535,I=Math.floor(h/65536),$e=h-I*65536,h=De+I+65535,I=Math.floor(h/65536),De=h-I*65536,h=Se+I+65535,I=Math.floor(h/65536),Se=h-I*65536,h=xt+I+65535,I=Math.floor(h/65536),xt=h-I*65536,h=mt+I+65535,I=Math.floor(h/65536),mt=h-I*65536,h=ot+I+65535,I=Math.floor(h/65536),ot=h-I*65536,h=je+I+65535,I=Math.floor(h/65536),je=h-I*65536,h=Ye+I+65535,I=Math.floor(h/65536),Ye=h-I*65536,h=Xe+I+65535,I=Math.floor(h/65536),Xe=h-I*65536,h=at+I+65535,I=Math.floor(h/65536),at=h-I*65536,h=He+I+65535,I=Math.floor(h/65536),He=h-I*65536,h=Ze+I+65535,I=Math.floor(h/65536),Ze=h-I*65536,h=Ne+I+65535,I=Math.floor(h/65536),Ne=h-I*65536,ee+=I-1+37*(I-1),L[0]=ee,L[1]=ge,L[2]=be,L[3]=$e,L[4]=De,L[5]=Se,L[6]=xt,L[7]=mt,L[8]=ot,L[9]=je,L[10]=Ye,L[11]=Xe,L[12]=at,L[13]=He,L[14]=Ze,L[15]=Ne}function W(L,N){H(L,N,N)}function ve(L,N){const A=s();let h;for(h=0;h<16;h++)A[h]=N[h];for(h=253;h>=0;h--)W(A,A),h!==2&&h!==4&&H(A,A,N);for(h=0;h<16;h++)L[h]=A[h]}function ie(L,N){const A=s();let h;for(h=0;h<16;h++)A[h]=N[h];for(h=250;h>=0;h--)W(A,A),h!==1&&H(A,A,N);for(h=0;h<16;h++)L[h]=A[h]}function ue(L,N){const A=s(),h=s(),I=s(),ee=s(),ge=s(),be=s(),$e=s(),De=s(),Se=s();j(A,L[1],L[0]),j(Se,N[1],N[0]),H(A,A,Se),de(h,L[0],L[1]),de(Se,N[0],N[1]),H(h,h,Se),H(I,L[3],N[3]),H(I,I,p),H(ee,L[2],N[2]),de(ee,ee,ee),j(ge,h,A),j(be,ee,I),de($e,ee,I),de(De,h,A),H(L[0],ge,be),H(L[1],De,$e),H(L[2],$e,be),H(L[3],ge,De)}function Ce(L,N,A){for(let h=0;h<4;h++)V(L[h],N[h],A)}function Ue(L,N){const A=s(),h=s(),I=s();ve(I,N[2]),H(A,N[0],I),H(h,N[1],I),re(L,h),L[31]^=fe(A)<<7}function m(L,N,A){D(L[0],l),D(L[1],d),D(L[2],d),D(L[3],l);for(let h=255;h>=0;--h){const I=A[h/8|0]>>(h&7)&1;Ce(L,N,I),ue(N,L),ue(L,L),Ce(L,N,I)}}function P(L,N){const A=[s(),s(),s(),s()];D(A[0],b),D(A[1],S),D(A[2],d),H(A[3],b,S),m(L,A,N)}function X(L){if(L.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const N=(0,r.hash)(L);N[0]&=248,N[31]&=127,N[31]|=64;const A=new Uint8Array(32),h=[s(),s(),s(),s()];P(h,N),Ue(A,h);const I=new Uint8Array(64);return I.set(L),I.set(A,32),{publicKey:A,secretKey:I}}a.generateKeyPairFromSeed=X;function ce(L){const N=(0,t.randomBytes)(32,L),A=X(N);return(0,n.wipe)(N),A}a.generateKeyPair=ce;function F(L){if(L.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(L.subarray(32))}a.extractPublicKeyFromSecretKey=F;const k=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function B(L,N){let A,h,I,ee;for(h=63;h>=32;--h){for(A=0,I=h-32,ee=h-12;I<ee;++I)N[I]+=A-16*N[h]*k[I-(h-32)],A=Math.floor((N[I]+128)/256),N[I]-=A*256;N[I]+=A,N[h]=0}for(A=0,I=0;I<32;I++)N[I]+=A-(N[31]>>4)*k[I],A=N[I]>>8,N[I]&=255;for(I=0;I<32;I++)N[I]-=A*k[I];for(h=0;h<32;h++)N[h+1]+=N[h]>>8,L[h]=N[h]&255}function G(L){const N=new Float64Array(64);for(let A=0;A<64;A++)N[A]=L[A];for(let A=0;A<64;A++)L[A]=0;B(L,N)}function Je(L,N){const A=new Float64Array(64),h=[s(),s(),s(),s()],I=(0,r.hash)(L.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const ee=new Uint8Array(64);ee.set(I.subarray(32),32);const ge=new r.SHA512;ge.update(ee.subarray(32)),ge.update(N);const be=ge.digest();ge.clean(),G(be),P(h,be),Ue(ee,h),ge.reset(),ge.update(ee.subarray(0,32)),ge.update(L.subarray(32)),ge.update(N);const $e=ge.digest();G($e);for(let De=0;De<32;De++)A[De]=be[De];for(let De=0;De<32;De++)for(let Se=0;Se<32;Se++)A[De+Se]+=$e[De]*I[Se];return B(ee.subarray(32),A),ee}a.sign=Je;function Ke(L,N){const A=s(),h=s(),I=s(),ee=s(),ge=s(),be=s(),$e=s();return D(L[2],d),pe(L[1],N),W(I,L[1]),H(ee,I,_),j(I,I,L[2]),de(ee,L[2],ee),W(ge,ee),W(be,ge),H($e,be,ge),H(A,$e,I),H(A,A,ee),ie(A,A),H(A,A,I),H(A,A,ee),H(A,A,ee),H(L[0],A,ee),W(h,L[0]),H(h,h,ee),le(h,I)&&H(L[0],L[0],x),W(h,L[0]),H(h,h,ee),le(h,I)?-1:(fe(L[0])===N[31]>>7&&j(L[0],l,L[0]),H(L[3],L[0],L[1]),0)}function qr(L,N,A){const h=new Uint8Array(32),I=[s(),s(),s(),s()],ee=[s(),s(),s(),s()];if(A.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(Ke(ee,L))return!1;const ge=new r.SHA512;ge.update(A.subarray(0,32)),ge.update(L),ge.update(N);const be=ge.digest();return G(be),m(I,ee,be),P(ee,A.subarray(32)),ue(I,ee),Ue(h,I),!he(A,h)}a.verify=qr;function Ie(L){let N=[s(),s(),s(),s()];if(Ke(N,L))throw new Error("Ed25519: invalid public key");let A=s(),h=s(),I=N[1];de(A,d,I),j(h,d,I),ve(h,h),H(A,A,h);let ee=new Uint8Array(32);return re(ee,A),ee}a.convertPublicKeyToX25519=Ie;function It(L){const N=(0,r.hash)(L.subarray(0,32));N[0]&=248,N[31]&=127,N[31]|=64;const A=new Uint8Array(N.subarray(0,32));return(0,n.wipe)(N),A}a.convertSecretKeyToX25519=It})(Mc);const tb="EdDSA",rb="JWT",mf=".",_f="base64url",ib="utf8",nb="utf8",sb=":",ob="did",ab="key",ll="base58btc",cb="z",ub="K36",hb=32;function _o(a){return Eo(Lc(ki(a),ib),_f)}function wf(a){const t=Lc(ub,ll),r=cb+Eo(R_([t,a]),ll);return[ob,ab,r].join(sb)}function lb(a){return Eo(a,_f)}function fb(a){return Lc([_o(a.header),_o(a.payload)].join(mf),nb)}function pb(a){return[_o(a.header),_o(a.payload),lb(a.signature)].join(mf)}function fl(a=rf.randomBytes(hb)){return Mc.generateKeyPairFromSeed(a)}async function db(a,t,r,n,s=ne.fromMiliseconds(Date.now())){const c={alg:tb,typ:rb},l=wf(n.publicKey),d=s+r,_={iss:l,sub:a,aud:t,iat:s,exp:d},p=fb({header:c,payload:_}),b=Mc.sign(n.secretKey,p);return pb({header:c,payload:_,signature:b})}const gb="PARSE_ERROR",yb="INVALID_REQUEST",vb="METHOD_NOT_FOUND",mb="INVALID_PARAMS",bf="INTERNAL_ERROR",zc="SERVER_ERROR",_b=[-32700,-32600,-32601,-32602,-32603],Jn={[gb]:{code:-32700,message:"Parse error"},[yb]:{code:-32600,message:"Invalid Request"},[vb]:{code:-32601,message:"Method not found"},[mb]:{code:-32602,message:"Invalid params"},[bf]:{code:-32603,message:"Internal error"},[zc]:{code:-32e3,message:"Server error"}},Ef=zc;function wb(a){return _b.includes(a)}function pl(a){return Object.keys(Jn).includes(a)?Jn[a]:Jn[Ef]}function bb(a){const t=Object.values(Jn).find(r=>r.code===a);return t||Jn[Ef]}function If(a,t,r){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):a}var xf={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Pc=function(a,t){return Pc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])},Pc(a,t)};function Eb(a,t){Pc(a,t);function r(){this.constructor=a}a.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Sc=function(){return Sc=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},Sc.apply(this,arguments)};function Ib(a,t){var r={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(r[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(r[n[s]]=a[n[s]]);return r}function xb(a,t,r,n){var s=arguments.length,c=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,t,r,n);else for(var d=a.length-1;d>=0;d--)(l=a[d])&&(c=(s<3?l(c):s>3?l(t,r,c):l(t,r))||c);return s>3&&c&&Object.defineProperty(t,r,c),c}function Pb(a,t){return function(r,n){t(r,n,a)}}function Sb(a,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,t)}function Ob(a,t,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function d(b){try{p(n.next(b))}catch(S){l(S)}}function _(b){try{p(n.throw(b))}catch(S){l(S)}}function p(b){b.done?c(b.value):s(b.value).then(d,_)}p((n=n.apply(a,t||[])).next())})}function Rb(a,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(p){return function(b){return _([p,b])}}function _(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(c=p[0]&2?s.return:p[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,p[1])).done)return c;switch(s=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,s=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){r.label=p[1];break}if(p[0]===6&&r.label<c[1]){r.label=c[1],c=p;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(p);break}c[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(a,r)}catch(b){p=[6,b],s=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Tb(a,t,r,n){n===void 0&&(n=r),a[n]=t[r]}function Ab(a,t){for(var r in a)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=a[r])}function Oc(a){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&a[t],n=0;if(r)return r.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pf(a,t){var r=typeof Symbol=="function"&&a[Symbol.iterator];if(!r)return a;var n=r.call(a),s,c=[],l;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(d){l={error:d}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(l)throw l.error}}return c}function Cb(){for(var a=[],t=0;t<arguments.length;t++)a=a.concat(Pf(arguments[t]));return a}function $b(){for(var a=0,t=0,r=arguments.length;t<r;t++)a+=arguments[t].length;for(var n=Array(a),s=0,t=0;t<r;t++)for(var c=arguments[t],l=0,d=c.length;l<d;l++,s++)n[s]=c[l];return n}function Zn(a){return this instanceof Zn?(this.v=a,this):new Zn(a)}function Nb(a,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(a,t||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(x){n[x]&&(s[x]=function(D){return new Promise(function(C,V){c.push([x,D,C,V])>1||d(x,D)})})}function d(x,D){try{_(n[x](D))}catch(C){S(c[0][3],C)}}function _(x){x.value instanceof Zn?Promise.resolve(x.value.v).then(p,b):S(c[0][2],x)}function p(x){d("next",x)}function b(x){d("throw",x)}function S(x,D){x(D),c.shift(),c.length&&d(c[0][0],c[0][1])}}function Db(a){var t,r;return t={},n("next"),n("throw",function(s){throw s}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(s,c){t[s]=a[s]?function(l){return(r=!r)?{value:Zn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function Lb(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=a[Symbol.asyncIterator],r;return t?t.call(a):(a=typeof Oc=="function"?Oc(a):a[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(c){r[c]=a[c]&&function(l){return new Promise(function(d,_){l=a[c](l),s(d,_,l.done,l.value)})}}function s(c,l,d,_){Promise.resolve(_).then(function(p){c({value:p,done:d})},l)}}function jb(a,t){return Object.defineProperty?Object.defineProperty(a,"raw",{value:t}):a.raw=t,a}function qb(a){if(a&&a.__esModule)return a;var t={};if(a!=null)for(var r in a)Object.hasOwnProperty.call(a,r)&&(t[r]=a[r]);return t.default=a,t}function Mb(a){return a&&a.__esModule?a:{default:a}}function zb(a,t){if(!t.has(a))throw new TypeError("attempted to get private field on non-instance");return t.get(a)}function Ub(a,t,r){if(!t.has(a))throw new TypeError("attempted to set private field on non-instance");return t.set(a,r),r}const Hb=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Sc},__asyncDelegator:Db,__asyncGenerator:Nb,__asyncValues:Lb,__await:Zn,__awaiter:Ob,__classPrivateFieldGet:zb,__classPrivateFieldSet:Ub,__createBinding:Tb,__decorate:xb,__exportStar:Ab,__extends:Eb,__generator:Rb,__importDefault:Mb,__importStar:qb,__makeTemplateObject:jb,__metadata:Sb,__param:Pb,__read:Pf,__rest:Ib,__spread:Cb,__spreadArrays:$b,__values:Oc},Symbol.toStringTag,{value:"Module"})),kb=es(Hb);var ii={},dl;function Kb(){if(dl)return ii;dl=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.isBrowserCryptoAvailable=ii.getSubtleCrypto=ii.getBrowerCrypto=void 0;function a(){return(globalThis==null?void 0:globalThis.crypto)||(globalThis==null?void 0:globalThis.msCrypto)||{}}ii.getBrowerCrypto=a;function t(){const n=a();return n.subtle||n.webkitSubtle}ii.getSubtleCrypto=t;function r(){return!!a()&&!!t()}return ii.isBrowserCryptoAvailable=r,ii}var ni={},gl;function Bb(){if(gl)return ni;gl=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowser=ni.isNode=ni.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ni.isReactNative=a;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}ni.isNode=t;function r(){return!a()&&!t()}return ni.isBrowser=r,ni}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=kb;t.__exportStar(Kb(),a),t.__exportStar(Bb(),a)})(xf);function Uc(a=3){const t=Date.now()*Math.pow(10,a),r=Math.floor(Math.random()*Math.pow(10,a));return t+r}function Sf(a=6){return BigInt(Uc(a))}function vn(a,t,r){return{id:r||Uc(),jsonrpc:"2.0",method:a,params:t}}function xo(a,t){return{id:a,jsonrpc:"2.0",result:t}}function Po(a,t,r){return{id:a,jsonrpc:"2.0",error:Vb(t,r)}}function Vb(a,t){return typeof a>"u"?pl(bf):(typeof a=="string"&&(a=Object.assign(Object.assign({},pl(zc)),{message:a})),typeof t<"u"&&(a.data=t),wb(a.code)&&(a=bb(a.code)),a)}class Fb{}class Gb extends Fb{constructor(){super()}}class Wb extends Gb{constructor(t){super()}}const Jb="^https?:",Qb="^wss?:";function Yb(a){const t=a.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Of(a,t){const r=Yb(a);return typeof r>"u"?!1:new RegExp(t).test(r)}function yl(a){return Of(a,Jb)}function vl(a){return Of(a,Qb)}function Xb(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function Rf(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function Hc(a){return Rf(a)&&"method"in a}function So(a){return Rf(a)&&(ai(a)||jr(a))}function ai(a){return"result"in a}function jr(a){return"error"in a}class ci extends Wb{constructor(t){super(t),this.events=new Or.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(vn(t.method,t.params||[],t.id||Sf().toString()),r)}async requestStrict(t,r){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(c){s(c)}this.events.on(`${t.id}`,c=>{jr(c)?s(c.error):n(c.result)});try{await this.connection.send(t,r)}catch(c){s(c)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),So(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Zb=()=>typeof WebSocket<"u"?WebSocket:typeof globalThis<"u"&&typeof globalThis.WebSocket<"u"?globalThis.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),e1=()=>typeof WebSocket<"u"||typeof globalThis<"u"&&typeof globalThis.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",ml=a=>a.split("?")[0],_l=10,t1=Zb();let r1=class{constructor(t){if(this.url=t,this.events=new Or.EventEmitter,this.registering=!1,!vl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ki(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!vl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,s)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),s(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const s=new URLSearchParams(t).get("origin"),c=xf.isReactNative()?{headers:{origin:s}}:{rejectUnauthorized:!Xb(t)},l=new t1(t,[],c);e1()?l.onerror=d=>{const _=d;n(this.emitError(_.error))}:l.on("error",d=>{n(this.emitError(d))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?rs(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),s=n.message||n.toString(),c=Po(t,s);this.events.emit("payload",c)}parseError(t,r=this.url){return If(t,ml(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>_l&&this.events.setMaxListeners(_l)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${ml(this.url)}`));return this.events.emit("register_error",r),r}};var wo={exports:{}};wo.exports;(function(a,t){var r=200,n="__lodash_hash_undefined__",s=1,c=2,l=9007199254740991,d="[object Arguments]",_="[object Array]",p="[object AsyncFunction]",b="[object Boolean]",S="[object Date]",x="[object Error]",D="[object Function]",C="[object GeneratorFunction]",V="[object Map]",re="[object Number]",he="[object Null]",le="[object Object]",fe="[object Promise]",pe="[object Proxy]",de="[object RegExp]",j="[object Set]",H="[object String]",W="[object Symbol]",ve="[object Undefined]",ie="[object WeakMap]",ue="[object ArrayBuffer]",Ce="[object DataView]",Ue="[object Float32Array]",m="[object Float64Array]",P="[object Int8Array]",X="[object Int16Array]",ce="[object Int32Array]",F="[object Uint8Array]",k="[object Uint8ClampedArray]",B="[object Uint16Array]",G="[object Uint32Array]",Je=/[\\^$.*+?()[\]{}|]/g,Ke=/^\[object .+?Constructor\]$/,qr=/^(?:0|[1-9]\d*)$/,Ie={};Ie[Ue]=Ie[m]=Ie[P]=Ie[X]=Ie[ce]=Ie[F]=Ie[k]=Ie[B]=Ie[G]=!0,Ie[d]=Ie[_]=Ie[ue]=Ie[b]=Ie[Ce]=Ie[S]=Ie[x]=Ie[D]=Ie[V]=Ie[re]=Ie[le]=Ie[de]=Ie[j]=Ie[H]=Ie[ie]=!1;var It=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,L=typeof self=="object"&&self&&self.Object===Object&&self,N=It||L||Function("return this")(),A=t&&!t.nodeType&&t,h=A&&!0&&a&&!a.nodeType&&a,I=h&&h.exports===A,ee=I&&It.process,ge=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),be=ge&&ge.isTypedArray;function $e(v,O){for(var U=-1,Q=v==null?0:v.length,Fe=0,me=[];++U<Q;){var et=v[U];O(et,U,v)&&(me[Fe++]=et)}return me}function De(v,O){for(var U=-1,Q=O.length,Fe=v.length;++U<Q;)v[Fe+U]=O[U];return v}function Se(v,O){for(var U=-1,Q=v==null?0:v.length;++U<Q;)if(O(v[U],U,v))return!0;return!1}function xt(v,O){for(var U=-1,Q=Array(v);++U<v;)Q[U]=O(U);return Q}function mt(v){return function(O){return v(O)}}function ot(v,O){return v.has(O)}function je(v,O){return v==null?void 0:v[O]}function Ye(v){var O=-1,U=Array(v.size);return v.forEach(function(Q,Fe){U[++O]=[Fe,Q]}),U}function Xe(v,O){return function(U){return v(O(U))}}function at(v){var O=-1,U=Array(v.size);return v.forEach(function(Q){U[++O]=Q}),U}var He=Array.prototype,Ze=Function.prototype,Ne=Object.prototype,Be=N["__core-js_shared__"],ht=Ze.toString,Me=Ne.hasOwnProperty,Pt=function(){var v=/[^.]+$/.exec(Be&&Be.keys&&Be.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Dt=Ne.toString,Ht=RegExp("^"+ht.call(Me).replace(Je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kt=I?N.Buffer:void 0,qt=N.Symbol,Jt=N.Uint8Array,rr=Ne.propertyIsEnumerable,Mr=He.splice,Qt=qt?qt.toStringTag:void 0,Vr=Object.getOwnPropertySymbols,hi=kt?kt.isBuffer:void 0,Si=Xe(Object.keys,Object),lt=lr(N,"DataView"),rt=lr(N,"Map"),ft=lr(N,"Promise"),pt=lr(N,"Set"),ct=lr(N,"WeakMap"),it=lr(Object,"create"),St=Gr(lt),Ot=Gr(rt),dt=Gr(ft),Rt=Gr(pt),gt=Gr(ct),_t=qt?qt.prototype:void 0,yt=_t?_t.valueOf:void 0;function Qe(v){var O=-1,U=v==null?0:v.length;for(this.clear();++O<U;){var Q=v[O];this.set(Q[0],Q[1])}}function Tt(){this.__data__=it?it(null):{},this.size=0}function At(v){var O=this.has(v)&&delete this.__data__[v];return this.size-=O?1:0,O}function To(v){var O=this.__data__;if(it){var U=O[v];return U===n?void 0:U}return Me.call(O,v)?O[v]:void 0}function Ao(v){var O=this.__data__;return it?O[v]!==void 0:Me.call(O,v)}function Co(v,O){var U=this.__data__;return this.size+=this.has(v)?0:1,U[v]=it&&O===void 0?n:O,this}Qe.prototype.clear=Tt,Qe.prototype.delete=At,Qe.prototype.get=To,Qe.prototype.has=Ao,Qe.prototype.set=Co;function vr(v){var O=-1,U=v==null?0:v.length;for(this.clear();++O<U;){var Q=v[O];this.set(Q[0],Q[1])}}function $o(){this.__data__=[],this.size=0}function No(v){var O=this.__data__,U=Oi(O,v);if(U<0)return!1;var Q=O.length-1;return U==Q?O.pop():Mr.call(O,U,1),--this.size,!0}function Do(v){var O=this.__data__,U=Oi(O,v);return U<0?void 0:O[U][1]}function Lo(v){return Oi(this.__data__,v)>-1}function jo(v,O){var U=this.__data__,Q=Oi(U,v);return Q<0?(++this.size,U.push([v,O])):U[Q][1]=O,this}vr.prototype.clear=$o,vr.prototype.delete=No,vr.prototype.get=Do,vr.prototype.has=Lo,vr.prototype.set=jo;function Fr(v){var O=-1,U=v==null?0:v.length;for(this.clear();++O<U;){var Q=v[O];this.set(Q[0],Q[1])}}function Fi(){this.size=0,this.__data__={hash:new Qe,map:new(rt||vr),string:new Qe}}function qo(v){var O=li(this,v).delete(v);return this.size-=O?1:0,O}function Gi(v){return li(this,v).get(v)}function Mo(v){return li(this,v).has(v)}function zo(v,O){var U=li(this,v),Q=U.size;return U.set(v,O),this.size+=U.size==Q?0:1,this}Fr.prototype.clear=Fi,Fr.prototype.delete=qo,Fr.prototype.get=Gi,Fr.prototype.has=Mo,Fr.prototype.set=zo;function Wi(v){var O=-1,U=v==null?0:v.length;for(this.__data__=new Fr;++O<U;)this.add(v[O])}function ns(v){return this.__data__.set(v,n),this}function ss(v){return this.__data__.has(v)}Wi.prototype.add=Wi.prototype.push=ns,Wi.prototype.has=ss;function Rr(v){var O=this.__data__=new vr(v);this.size=O.size}function Uo(){this.__data__=new vr,this.size=0}function Ho(v){var O=this.__data__,U=O.delete(v);return this.size=O.size,U}function ko(v){return this.__data__.get(v)}function Ko(v){return this.__data__.has(v)}function os(v,O){var U=this.__data__;if(U instanceof vr){var Q=U.__data__;if(!rt||Q.length<r-1)return Q.push([v,O]),this.size=++U.size,this;U=this.__data__=new Fr(Q)}return U.set(v,O),this.size=U.size,this}Rr.prototype.clear=Uo,Rr.prototype.delete=Ho,Rr.prototype.get=ko,Rr.prototype.has=Ko,Rr.prototype.set=os;function as(v,O){var U=Yi(v),Q=!U&&_s(v),Fe=!U&&!Q&&En(v),me=!U&&!Q&&!Fe&&Es(v),et=U||Q||Fe||me,Ct=et?xt(v.length,String):[],Te=Ct.length;for(var Ge in v)(O||Me.call(v,Ge))&&!(et&&(Ge=="length"||Fe&&(Ge=="offset"||Ge=="parent")||me&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||ds(Ge,Te)))&&Ct.push(Ge);return Ct}function Oi(v,O){for(var U=v.length;U--;)if(ms(v[U][0],O))return U;return-1}function wn(v,O,U){var Q=O(v);return Yi(v)?Q:De(Q,U(v))}function Ri(v){return v==null?v===void 0?ve:he:Qt&&Qt in Object(v)?fs(v):Fo(v)}function bn(v){return Ai(v)&&Ri(v)==d}function Ti(v,O,U,Q,Fe){return v===O?!0:v==null||O==null||!Ai(v)&&!Ai(O)?v!==v&&O!==O:cs(v,O,U,Q,Ti,Fe)}function cs(v,O,U,Q,Fe,me){var et=Yi(v),Ct=Yi(O),Te=et?_:zr(v),Ge=Ct?_:zr(O);Te=Te==d?le:Te,Ge=Ge==d?le:Ge;var wt=Te==le,ir=Ge==le,$t=Te==Ge;if($t&&En(v)){if(!En(O))return!1;et=!0,wt=!1}if($t&&!wt)return me||(me=new Rr),et||Es(v)?Ji(v,O,U,Q,Fe,me):Vo(v,O,Te,U,Q,Fe,me);if(!(U&s)){var tt=wt&&Me.call(v,"__wrapped__"),Yt=ir&&Me.call(O,"__wrapped__");if(tt||Yt){var Tr=tt?v.value():v,mr=Yt?O.value():O;return me||(me=new Rr),Fe(Tr,mr,U,Q,me)}}return $t?(me||(me=new Rr),ls(v,O,U,Q,Fe,me)):!1}function Bo(v){if(!bs(v)||ys(v))return!1;var O=Xi(v)?Ht:Ke;return O.test(Gr(v))}function us(v){return Ai(v)&&ws(v.length)&&!!Ie[Ri(v)]}function hs(v){if(!vs(v))return Si(v);var O=[];for(var U in Object(v))Me.call(v,U)&&U!="constructor"&&O.push(U);return O}function Ji(v,O,U,Q,Fe,me){var et=U&s,Ct=v.length,Te=O.length;if(Ct!=Te&&!(et&&Te>Ct))return!1;var Ge=me.get(v);if(Ge&&me.get(O))return Ge==O;var wt=-1,ir=!0,$t=U&c?new Wi:void 0;for(me.set(v,O),me.set(O,v);++wt<Ct;){var tt=v[wt],Yt=O[wt];if(Q)var Tr=et?Q(Yt,tt,wt,O,v,me):Q(tt,Yt,wt,v,O,me);if(Tr!==void 0){if(Tr)continue;ir=!1;break}if($t){if(!Se(O,function(mr,Ur){if(!ot($t,Ur)&&(tt===mr||Fe(tt,mr,U,Q,me)))return $t.push(Ur)})){ir=!1;break}}else if(!(tt===Yt||Fe(tt,Yt,U,Q,me))){ir=!1;break}}return me.delete(v),me.delete(O),ir}function Vo(v,O,U,Q,Fe,me,et){switch(U){case Ce:if(v.byteLength!=O.byteLength||v.byteOffset!=O.byteOffset)return!1;v=v.buffer,O=O.buffer;case ue:return!(v.byteLength!=O.byteLength||!me(new Jt(v),new Jt(O)));case b:case S:case re:return ms(+v,+O);case x:return v.name==O.name&&v.message==O.message;case de:case H:return v==O+"";case V:var Ct=Ye;case j:var Te=Q&s;if(Ct||(Ct=at),v.size!=O.size&&!Te)return!1;var Ge=et.get(v);if(Ge)return Ge==O;Q|=c,et.set(v,O);var wt=Ji(Ct(v),Ct(O),Q,Fe,me,et);return et.delete(v),wt;case W:if(yt)return yt.call(v)==yt.call(O)}return!1}function ls(v,O,U,Q,Fe,me){var et=U&s,Ct=Qi(v),Te=Ct.length,Ge=Qi(O),wt=Ge.length;if(Te!=wt&&!et)return!1;for(var ir=Te;ir--;){var $t=Ct[ir];if(!(et?$t in O:Me.call(O,$t)))return!1}var tt=me.get(v);if(tt&&me.get(O))return tt==O;var Yt=!0;me.set(v,O),me.set(O,v);for(var Tr=et;++ir<Te;){$t=Ct[ir];var mr=v[$t],Ur=O[$t];if(Q)var In=et?Q(Ur,mr,$t,O,v,me):Q(mr,Ur,$t,v,O,me);if(!(In===void 0?mr===Ur||Fe(mr,Ur,U,Q,me):In)){Yt=!1;break}Tr||(Tr=$t=="constructor")}if(Yt&&!Tr){var Ci=v.constructor,Mt=O.constructor;Ci!=Mt&&"constructor"in v&&"constructor"in O&&!(typeof Ci=="function"&&Ci instanceof Ci&&typeof Mt=="function"&&Mt instanceof Mt)&&(Yt=!1)}return me.delete(v),me.delete(O),Yt}function Qi(v){return wn(v,Jo,ps)}function li(v,O){var U=v.__data__;return gs(O)?U[typeof O=="string"?"string":"hash"]:U.map}function lr(v,O){var U=je(v,O);return Bo(U)?U:void 0}function fs(v){var O=Me.call(v,Qt),U=v[Qt];try{v[Qt]=void 0;var Q=!0}catch{}var Fe=Dt.call(v);return Q&&(O?v[Qt]=U:delete v[Qt]),Fe}var ps=Vr?function(v){return v==null?[]:(v=Object(v),$e(Vr(v),function(O){return rr.call(v,O)}))}:Ve,zr=Ri;(lt&&zr(new lt(new ArrayBuffer(1)))!=Ce||rt&&zr(new rt)!=V||ft&&zr(ft.resolve())!=fe||pt&&zr(new pt)!=j||ct&&zr(new ct)!=ie)&&(zr=function(v){var O=Ri(v),U=O==le?v.constructor:void 0,Q=U?Gr(U):"";if(Q)switch(Q){case St:return Ce;case Ot:return V;case dt:return fe;case Rt:return j;case gt:return ie}return O});function ds(v,O){return O=O??l,!!O&&(typeof v=="number"||qr.test(v))&&v>-1&&v%1==0&&v<O}function gs(v){var O=typeof v;return O=="string"||O=="number"||O=="symbol"||O=="boolean"?v!=="__proto__":v===null}function ys(v){return!!Pt&&Pt in v}function vs(v){var O=v&&v.constructor,U=typeof O=="function"&&O.prototype||Ne;return v===U}function Fo(v){return Dt.call(v)}function Gr(v){if(v!=null){try{return ht.call(v)}catch{}try{return v+""}catch{}}return""}function ms(v,O){return v===O||v!==v&&O!==O}var _s=bn(function(){return arguments}())?bn:function(v){return Ai(v)&&Me.call(v,"callee")&&!rr.call(v,"callee")},Yi=Array.isArray;function Go(v){return v!=null&&ws(v.length)&&!Xi(v)}var En=hi||ke;function Wo(v,O){return Ti(v,O)}function Xi(v){if(!bs(v))return!1;var O=Ri(v);return O==D||O==C||O==p||O==pe}function ws(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=l}function bs(v){var O=typeof v;return v!=null&&(O=="object"||O=="function")}function Ai(v){return v!=null&&typeof v=="object"}var Es=be?mt(be):us;function Jo(v){return Go(v)?as(v):hs(v)}function Ve(){return[]}function ke(){return!1}a.exports=Wo})(wo,wo.exports);var i1=wo.exports;const n1=jc(i1);function s1(a,t){return t=t||{},new Promise(function(r,n){var s=new XMLHttpRequest,c=[],l=[],d={},_=function(){return{ok:(s.status/100|0)==2,statusText:s.statusText,status:s.status,url:s.responseURL,text:function(){return Promise.resolve(s.responseText)},json:function(){return Promise.resolve(s.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([s.response]))},clone:_,headers:{keys:function(){return c},entries:function(){return l},get:function(b){return d[b.toLowerCase()]},has:function(b){return b.toLowerCase()in d}}}};for(var p in s.open(t.method||"get",a,!0),s.onload=function(){s.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(b,S,x){c.push(S=S.toLowerCase()),l.push([S,x]),d[S]=d[S]?d[S]+","+x:x}),r(_())},s.onerror=n,s.withCredentials=t.credentials=="include",t.headers)s.setRequestHeader(p,t.headers[p]);s.send(t.body||null)})}const o1=Object.freeze(Object.defineProperty({__proto__:null,default:s1},Symbol.toStringTag,{value:"Module"})),wl=es(o1);var a1=self.fetch||(self.fetch=wl.default||wl);const c1=jc(a1);var u1={};function h1(a,t){if(a.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<a.length;s++){var c=a.charAt(s),l=c.charCodeAt(0);if(r[l]!==255)throw new TypeError(c+" is ambiguous");r[l]=s}var d=a.length,_=a.charAt(0),p=Math.log(d)/Math.log(256),b=Math.log(256)/Math.log(d);function S(C){if(C instanceof Uint8Array||(ArrayBuffer.isView(C)?C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength):Array.isArray(C)&&(C=Uint8Array.from(C))),!(C instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(C.length===0)return"";for(var V=0,re=0,he=0,le=C.length;he!==le&&C[he]===0;)he++,V++;for(var fe=(le-he)*b+1>>>0,pe=new Uint8Array(fe);he!==le;){for(var de=C[he],j=0,H=fe-1;(de!==0||j<re)&&H!==-1;H--,j++)de+=256*pe[H]>>>0,pe[H]=de%d>>>0,de=de/d>>>0;if(de!==0)throw new Error("Non-zero carry");re=j,he++}for(var W=fe-re;W!==fe&&pe[W]===0;)W++;for(var ve=_.repeat(V);W<fe;++W)ve+=a.charAt(pe[W]);return ve}function x(C){if(typeof C!="string")throw new TypeError("Expected String");if(C.length===0)return new Uint8Array;var V=0;if(C[V]!==" "){for(var re=0,he=0;C[V]===_;)re++,V++;for(var le=(C.length-V)*p+1>>>0,fe=new Uint8Array(le);C[V];){var pe=r[C.charCodeAt(V)];if(pe===255)return;for(var de=0,j=le-1;(pe!==0||de<he)&&j!==-1;j--,de++)pe+=d*fe[j]>>>0,fe[j]=pe%256>>>0,pe=pe/256>>>0;if(pe!==0)throw new Error("Non-zero carry");he=de,V++}if(C[V]!==" "){for(var H=le-he;H!==le&&fe[H]===0;)H++;for(var W=new Uint8Array(re+(le-H)),ve=re;H!==le;)W[ve++]=fe[H++];return W}}}function D(C){var V=x(C);if(V)return V;throw new Error(`Non-${t} character`)}return{encode:S,decodeUnsafe:x,decode:D}}var l1=h1,f1=l1;const Tf=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},p1=a=>new TextEncoder().encode(a),d1=a=>new TextDecoder().decode(a);class g1{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class y1{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Af(this,t)}}class v1{constructor(t){this.decoders=t}or(t){return Af(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Af=(a,t)=>new v1({...a.decoders||{[a.prefix]:a},...t.decoders||{[t.prefix]:t}});class m1{constructor(t,r,n,s){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new g1(t,r,n),this.decoder=new y1(t,r,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Oo=({name:a,prefix:t,encode:r,decode:n})=>new m1(a,t,r,n),is=({prefix:a,name:t,alphabet:r})=>{const{encode:n,decode:s}=f1(r,t);return Oo({prefix:a,name:t,encode:n,decode:c=>Tf(s(c))})},_1=(a,t,r,n)=>{const s={};for(let b=0;b<t.length;++b)s[t[b]]=b;let c=a.length;for(;a[c-1]==="=";)--c;const l=new Uint8Array(c*r/8|0);let d=0,_=0,p=0;for(let b=0;b<c;++b){const S=s[a[b]];if(S===void 0)throw new SyntaxError(`Non-${n} character`);_=_<<r|S,d+=r,d>=8&&(d-=8,l[p++]=255&_>>d)}if(d>=r||255&_<<8-d)throw new SyntaxError("Unexpected end of data");return l},w1=(a,t,r)=>{const n=t[t.length-1]==="=",s=(1<<r)-1;let c="",l=0,d=0;for(let _=0;_<a.length;++_)for(d=d<<8|a[_],l+=8;l>r;)l-=r,c+=t[s&d>>l];if(l&&(c+=t[s&d<<r-l]),n)for(;c.length*r&7;)c+="=";return c},Bt=({name:a,prefix:t,bitsPerChar:r,alphabet:n})=>Oo({prefix:t,name:a,encode(s){return w1(s,n,r)},decode(s){return _1(s,n,r,a)}}),b1=Oo({prefix:"\0",name:"identity",encode:a=>d1(a),decode:a=>p1(a)});var E1=Object.freeze({__proto__:null,identity:b1});const I1=Bt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var x1=Object.freeze({__proto__:null,base2:I1});const P1=Bt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var S1=Object.freeze({__proto__:null,base8:P1});const O1=is({prefix:"9",name:"base10",alphabet:"0123456789"});var R1=Object.freeze({__proto__:null,base10:O1});const T1=Bt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),A1=Bt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var C1=Object.freeze({__proto__:null,base16:T1,base16upper:A1});const $1=Bt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),N1=Bt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),D1=Bt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),L1=Bt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),j1=Bt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),q1=Bt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),M1=Bt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),z1=Bt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),U1=Bt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var H1=Object.freeze({__proto__:null,base32:$1,base32upper:N1,base32pad:D1,base32padupper:L1,base32hex:j1,base32hexupper:q1,base32hexpad:M1,base32hexpadupper:z1,base32z:U1});const k1=is({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),K1=is({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var B1=Object.freeze({__proto__:null,base36:k1,base36upper:K1});const V1=is({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),F1=is({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var G1=Object.freeze({__proto__:null,base58btc:V1,base58flickr:F1});const W1=Bt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),J1=Bt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Q1=Bt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Y1=Bt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var X1=Object.freeze({__proto__:null,base64:W1,base64pad:J1,base64url:Q1,base64urlpad:Y1});const Cf=Array.from(""),Z1=Cf.reduce((a,t,r)=>(a[r]=t,a),[]),eE=Cf.reduce((a,t,r)=>(a[t.codePointAt(0)]=r,a),[]);function tE(a){return a.reduce((t,r)=>(t+=Z1[r],t),"")}function rE(a){const t=[];for(const r of a){const n=eE[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const iE=Oo({prefix:"",name:"base256emoji",encode:tE,decode:rE});var nE=Object.freeze({__proto__:null,base256emoji:iE}),sE=$f,bl=128,oE=127,aE=~oE,cE=Math.pow(2,31);function $f(a,t,r){t=t||[],r=r||0;for(var n=r;a>=cE;)t[r++]=a&255|bl,a/=128;for(;a&aE;)t[r++]=a&255|bl,a>>>=7;return t[r]=a|0,$f.bytes=r-n+1,t}var uE=Rc,hE=128,El=127;function Rc(a,n){var r=0,n=n||0,s=0,c=n,l,d=a.length;do{if(c>=d)throw Rc.bytes=0,new RangeError("Could not decode varint");l=a[c++],r+=s<28?(l&El)<<s:(l&El)*Math.pow(2,s),s+=7}while(l>=hE);return Rc.bytes=c-n,r}var lE=Math.pow(2,7),fE=Math.pow(2,14),pE=Math.pow(2,21),dE=Math.pow(2,28),gE=Math.pow(2,35),yE=Math.pow(2,42),vE=Math.pow(2,49),mE=Math.pow(2,56),_E=Math.pow(2,63),wE=function(a){return a<lE?1:a<fE?2:a<pE?3:a<dE?4:a<gE?5:a<yE?6:a<vE?7:a<mE?8:a<_E?9:10},bE={encode:sE,decode:uE,encodingLength:wE},Nf=bE;const Il=(a,t,r=0)=>(Nf.encode(a,t,r),t),xl=a=>Nf.encodingLength(a),Tc=(a,t)=>{const r=t.byteLength,n=xl(a),s=n+xl(r),c=new Uint8Array(s+r);return Il(a,c,0),Il(r,c,n),c.set(t,s),new EE(a,r,t,c)};class EE{constructor(t,r,n,s){this.code=t,this.size=r,this.digest=n,this.bytes=s}}const Df=({name:a,code:t,encode:r})=>new IE(a,t,r);class IE{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Tc(this.code,r):r.then(n=>Tc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Lf=a=>async t=>new Uint8Array(await crypto.subtle.digest(a,t)),xE=Df({name:"sha2-256",code:18,encode:Lf("SHA-256")}),PE=Df({name:"sha2-512",code:19,encode:Lf("SHA-512")});var SE=Object.freeze({__proto__:null,sha256:xE,sha512:PE});const jf=0,OE="identity",qf=Tf,RE=a=>Tc(jf,qf(a)),TE={code:jf,name:OE,encode:qf,digest:RE};var AE=Object.freeze({__proto__:null,identity:TE});new TextEncoder,new TextDecoder;const Pl={...E1,...x1,...S1,...R1,...C1,...H1,...B1,...G1,...X1,...nE};({...SE,...AE});function Mf(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function CE(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Mf(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function zf(a,t,r,n){return{name:a,prefix:t,encoder:{name:a,prefix:t,encode:r},decoder:{decode:n}}}const Sl=zf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),ac=zf("ascii","a",a=>{let t="a";for(let r=0;r<a.length;r++)t+=String.fromCharCode(a[r]);return t},a=>{a=a.substring(1);const t=CE(a.length);for(let r=0;r<a.length;r++)t[r]=a.charCodeAt(r);return t}),$E={utf8:Sl,"utf-8":Sl,hex:Pl.base16,latin1:ac,ascii:ac,binary:ac,...Pl};function NE(a,t="utf8"){const r=$E[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Mf(globalThis.Buffer.from(a,"utf-8")):r.decoder.decode(`${r.prefix}${a}`)}const Uf="wc",DE=2,kc="core",Ii=`${Uf}@2:${kc}:`,LE={name:kc,logger:"error"},jE={database:":memory:"},qE="crypto",Ol="client_ed25519_seed",ME=ne.ONE_DAY,zE="keychain",UE="0.3",HE="messages",kE="0.3",KE=ne.SIX_HOURS,BE="publisher",Hf="irn",VE="error",kf="wss://relay.walletconnect.com",Rl="wss://relay.walletconnect.org",FE="relayer",Wt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},GE="_subscription",si={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},WE=ne.ONE_SECOND,JE="2.11.0",QE=1e4,YE="0.3",XE="WALLETCONNECT_CLIENT_ID",Dr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ZE="subscription",eI="0.3",tI=ne.FIVE_SECONDS*1e3,rI="pairing",iI="0.3",Hn={wc_pairingDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:0},res:{ttl:ne.ONE_DAY,prompt:!1,tag:0}}},Gn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Br={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},nI="history",sI="0.3",oI="expirer",Sr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},aI="0.3",cc="verify-api",gn="https://verify.walletconnect.com",Ac="https://verify.walletconnect.org",cI=[gn,Ac],uI="echo",hI="https://echo.walletconnect.com";class lI{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=zE,this.version=UE,this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()},this.get=n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:c}=Y("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(c)}return s},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,af(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?cf(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class fI{constructor(t,r,n){this.core=t,this.logger=r,this.name=qE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=s=>(this.isInitialized(),this.keychain.has(s)),this.getClientId=async()=>{this.isInitialized();const s=await this.getClientSeed(),c=fl(s);return wf(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const s=C_();return this.setPrivateKey(s.publicKey,s.privateKey)},this.signJWT=async s=>{this.isInitialized();const c=await this.getClientSeed(),l=fl(c),d=yc();return await db(d,s,ME,l)},this.generateSharedKey=(s,c,l)=>{this.isInitialized();const d=this.getPrivateKey(s),_=$_(d,c);return this.setSymKey(_,l)},this.setSymKey=async(s,c)=>{this.isInitialized();const l=c||N_(s);return await this.keychain.set(l,s),l},this.deleteKeyPair=async s=>{this.isInitialized(),await this.keychain.del(s)},this.deleteSymKey=async s=>{this.isInitialized(),await this.keychain.del(s)},this.encode=async(s,c,l)=>{this.isInitialized();const d=D_(l),_=ki(c);if(Fh(d)){const x=d.senderPublicKey,D=d.receiverPublicKey;s=await this.generateSharedKey(x,D)}const p=this.getSymKey(s),{type:b,senderPublicKey:S}=d;return L_({type:b,symKey:p,message:_,senderPublicKey:S})},this.decode=async(s,c,l)=>{this.isInitialized();const d=j_(c,l);if(Fh(d)){const _=d.receiverPublicKey,p=d.senderPublicKey;s=await this.generateSharedKey(_,p)}try{const _=this.getSymKey(s),p=q_({symKey:_,encoded:c});return rs(p)}catch(_){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(_)}},this.getPayloadType=s=>{const c=Gh(s);return M_(c.type)},this.getPayloadSenderPublicKey=s=>{const c=Gh(s);return c.senderPublicKey?Eo(c.senderPublicKey,z_):void 0},this.core=t,this.logger=Re.generateChildLogger(r,this.name),this.keychain=n||new lI(this.core,this.logger)}get context(){return Re.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Ol)}catch{t=yc(),await this.keychain.set(Ol,t)}return NE(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class pI extends V0{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=HE,this.version=kE,this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,s)=>{this.isInitialized();const c=yn(s);let l=this.messages.get(n);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=s,this.messages.set(n,l),await this.persist()),c},this.get=n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s},this.has=(n,s)=>{this.isInitialized();const c=this.get(n),l=yn(s);return typeof c[l]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Re.generateChildLogger(t,this.name),this.core=r}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,af(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?cf(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class dI extends F0{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Or.EventEmitter,this.name=BE,this.queue=new Map,this.publishTimeout=ne.toMiliseconds(ne.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,s,c)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:c}});try{const d=(c==null?void 0:c.ttl)||KE,_=vc(c),p=(c==null?void 0:c.prompt)||!1,b=(c==null?void 0:c.tag)||0,S=(c==null?void 0:c.id)||Sf().toString(),x={topic:n,message:s,opts:{ttl:d,relay:_,prompt:p,tag:b,id:S}},D=setTimeout(()=>this.queue.set(S,x),this.publishTimeout);try{await await Qn(this.rpcPublish(n,s,d,_,p,b,S),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(S),this.relayer.events.emit(Wt.publish,x)}catch(C){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=c==null?void 0:c.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(S),C;return}finally{clearTimeout(D)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:c}})}catch(d){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(d),d}},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.relayer=t,this.logger=Re.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Re.getLoggerContext(this.logger)}rpcPublish(t,r,n,s,c,l,d){var _,p,b,S;const x={method:go(s.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:c,tag:l},id:d};return Ei((_=x.params)==null?void 0:_.prompt)&&((p=x.params)==null||delete p.prompt),Ei((b=x.params)==null?void 0:b.tag)&&((S=x.params)==null||delete S.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:x}),this.relayer.request(x)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:s}=t;await this.publish(r,n,s)})}registerEventListeners(){this.relayer.core.heartbeat.on(_n.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Wt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Wt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class gI{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const s=n.filter(c=>c!==r);if(!s.length){this.map.delete(t);return}this.map.set(t,s)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var yI=Object.defineProperty,vI=Object.defineProperties,mI=Object.getOwnPropertyDescriptors,Tl=Object.getOwnPropertySymbols,_I=Object.prototype.hasOwnProperty,wI=Object.prototype.propertyIsEnumerable,Al=(a,t,r)=>t in a?yI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,kn=(a,t)=>{for(var r in t||(t={}))_I.call(t,r)&&Al(a,r,t[r]);if(Tl)for(var r of Tl(t))wI.call(t,r)&&Al(a,r,t[r]);return a},uc=(a,t)=>vI(a,mI(t));class bI extends J0{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new gI,this.events=new Or.EventEmitter,this.name=ZE,this.version=eI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ii,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,s)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const c=vc(s),l={topic:n,relay:c};this.pending.set(n,l);const d=await this.rpcSubscribe(n,c);return this.onSubscribe(d,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}}),d}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(n,s)=>{await this.restartToComplete(),this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((s,c)=>{const l=new ne.Watch;l.start(this.pendingSubscriptionWatchLabel);const d=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(d),l.stop(this.pendingSubscriptionWatchLabel),s(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=tI&&(clearInterval(d),l.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Re.generateChildLogger(r,this.name),this.clientId=""}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async s=>await this.unsubscribeById(t,s,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const s=vc(n);await this.rpcUnsubscribe(t,r,s);const c=Gt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(t,r){const n={method:go(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Qn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Wt.connection_stalled)}return yn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,n={method:go(r.protocol).batchSubscribe,params:{topics:t.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Qn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Wt.connection_stalled)}}rpcUnsubscribe(t,r,n){const s={method:go(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(t,r){this.setSubscription(t,uc(kn({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,kn({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,kn({},r)),this.topicMap.set(r.topic,t),this.events.emit(Dr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(Dr.deleted,uc(kn({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Dr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Dr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);mn(r)&&this.onBatchSubscribe(r.map((n,s)=>uc(kn({},t[s]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(_n.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Wt.connect,async()=>{await this.onConnect()}),this.relayer.on(Wt.disconnect,()=>{this.onDisconnect()}),this.events.on(Dr.created,async t=>{const r=Dr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(Dr.deleted,async t=>{const r=Dr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var EI=Object.defineProperty,Cl=Object.getOwnPropertySymbols,II=Object.prototype.hasOwnProperty,xI=Object.prototype.propertyIsEnumerable,$l=(a,t,r)=>t in a?EI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,PI=(a,t)=>{for(var r in t||(t={}))II.call(t,r)&&$l(a,r,t[r]);if(Cl)for(var r of Cl(t))xI.call(t,r)&&$l(a,r,t[r]);return a};class SI extends G0{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Or.EventEmitter,this.name=FE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Wt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Wt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(si.payload,this.onPayloadHandler),this.provider.on(si.connect,this.onConnectHandler),this.provider.on(si.disconnect,this.onDisconnectHandler),this.provider.on(si.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Re.generateChildLogger(t.logger,this.name):Re.pino(Re.getDefaultLoggerOptions({level:t.logger||VE})),this.messages=new pI(this.logger,t.core),this.subscriber=new bI(this,this.logger),this.publisher=new dI(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||kf,this.projectId=t.projectId,this.bundleId=U_(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Rl}...`),await this.restartTransport(Rl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},QE)}get context(){return Re.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var n;this.isInitialized();let s=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"";if(s)return s;let c;const l=d=>{d.topic===t&&(this.subscriber.off(Dr.created,l),c())};return await Promise.all([new Promise(d=>{c=d,this.subscriber.on(Dr.created,l)}),new Promise(async d=>{s=await this.subscriber.subscribe(t,r),d()})]),s}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Qn(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Dr.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await Qn(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(s){n(s);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(si.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Wh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new ci(new r1(H_({sdkVersion:JE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const s=this.messages.has(r,n);return s&&this.logger.debug(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Hc(t)){if(!t.method.endsWith(GE))return;const r=t.params,{topic:n,message:s,publishedAt:c}=r.data,l={topic:n,message:s,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(PI({type:"event",event:r.id},l)),this.events.emit(r.id,l),await this.acknowledgePayload(t),await this.onMessageEvent(l)}else So(t)&&this.events.emit(Wt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Wt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=xo(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(si.payload,this.onPayloadHandler),this.provider.off(si.connect,this.onConnectHandler),this.provider.off(si.disconnect,this.onDisconnectHandler),this.provider.off(si.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Wt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await Wh();k_(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Wt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},ne.toMiliseconds(WE)))}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var OI=Object.defineProperty,Nl=Object.getOwnPropertySymbols,RI=Object.prototype.hasOwnProperty,TI=Object.prototype.propertyIsEnumerable,Dl=(a,t,r)=>t in a?OI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Ll=(a,t)=>{for(var r in t||(t={}))RI.call(t,r)&&Dl(a,r,t[r]);if(Nl)for(var r of Nl(t))TI.call(t,r)&&Dl(a,r,t[r]);return a};class Ro extends W0{constructor(t,r,n,s=Ii,c=void 0){super(t,r,n,s),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=YE,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!Ei(l)?this.map.set(this.getKey(l),l):T_(l)?this.map.set(l.id,l):A_(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,d)=>{this.isInitialized(),this.map.has(l)?await this.update(l,d):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:d}),this.map.set(l,d),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(d=>Object.keys(l).every(_=>n1(d[_],l[_]))):this.values),this.update=async(l,d)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:d});const _=Ll(Ll({},this.getData(l)),d);this.map.set(l,_),await this.persist()},this.delete=async(l,d)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:d}),this.map.delete(l),await this.persist())},this.logger=Re.generateChildLogger(r,this.name),this.storagePrefix=s,this.getKey=c}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class AI{constructor(t,r){this.core=t,this.logger=r,this.name=rI,this.version=iI,this.events=new qc,this.initialized=!1,this.storagePrefix=Ii,this.ignoredPayloadTypes=[nf],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=yc(),s=await this.core.crypto.setSymKey(n),c=Lr(ne.FIVE_MINUTES),l={protocol:Hf},d={topic:s,expiry:c,relay:l,active:!1},_=K_({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:n,relay:l});return await this.pairings.set(s,d),await this.core.relayer.subscribe(s),this.core.expirer.set(s,c),{topic:s,uri:_}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:s,symKey:c,relay:l}=Jh(n.uri);let d;if(this.pairings.keys.includes(s)&&(d=this.pairings.get(s),d.active))throw new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);const _=Lr(ne.FIVE_MINUTES),p={topic:s,relay:l,expiry:_,active:!1};return await this.pairings.set(s,p),this.core.expirer.set(s,_),n.activatePairing&&await this.activate({topic:s}),this.events.emit(Gn.create,p),this.core.crypto.keychain.has(s)||(await this.core.crypto.setSymKey(c,s),await this.core.relayer.subscribe(s,{relay:l})),p},this.activate=async({topic:n})=>{this.isInitialized();const s=Lr(ne.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:s}),this.core.expirer.set(n,s)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:s}=n;if(this.pairings.keys.includes(s)){const c=await this.sendRequest(s,"wc_pairingPing",{}),{done:l,resolve:d,reject:_}=pn();this.events.once(Nt("pairing_ping",c),({error:p})=>{p?_(p):d()}),await l()}},this.updateExpiry=async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})},this.updateMetadata=async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",Gt("USER_DISCONNECTED")),await this.deletePairing(s))},this.sendRequest=async(n,s,c)=>{const l=vn(s,c),d=await this.core.crypto.encode(n,l),_=Hn[s].req;return this.core.history.set(n,l),this.core.relayer.publish(n,d,_),l.id},this.sendResult=async(n,s,c)=>{const l=xo(n,c),d=await this.core.crypto.encode(s,l),_=await this.core.history.get(s,n),p=Hn[_.request.method].res;await this.core.relayer.publish(s,d,p),await this.core.history.resolve(l)},this.sendError=async(n,s,c)=>{const l=Po(n,c),d=await this.core.crypto.encode(s,l),_=await this.core.history.get(s,n),p=Hn[_.request.method]?Hn[_.request.method].res:Hn.unregistered_method.res;await this.core.relayer.publish(s,d,p),await this.core.history.resolve(l)},this.deletePairing=async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Gt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(s=>bi(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))},this.onRelayEventRequest=n=>{const{topic:s,payload:c}=n;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(s,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(s,c);default:return this.onUnknownRpcMethodRequest(s,c)}},this.onRelayEventResponse=async n=>{const{topic:s,payload:c}=n,l=(await this.core.history.get(s,c.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(s,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(n,s)=>{const{id:c}=s;try{this.isValidPing({topic:n}),await this.sendResult(c,n,!0),this.events.emit(Gn.ping,{id:c,topic:n})}catch(l){await this.sendError(c,n,l),this.logger.error(l)}},this.onPairingPingResponse=(n,s)=>{const{id:c}=s;setTimeout(()=>{ai(s)?this.events.emit(Nt("pairing_ping",c),{}):jr(s)&&this.events.emit(Nt("pairing_ping",c),{error:s.error})},500)},this.onPairingDeleteRequest=async(n,s)=>{const{id:c}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Gn.delete,{id:c,topic:n})}catch(l){await this.sendError(c,n,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(n,s)=>{const{id:c,method:l}=s;try{if(this.registeredMethods.includes(l))return;const d=Gt("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,n,d),this.logger.error(d)}catch(d){await this.sendError(c,n,d),this.logger.error(d)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Gt("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var s;if(!hr(n)){const{message:l}=Y("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(l)}if(!B_(n.uri)){const{message:l}=Y("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(l)}const c=Jh(n.uri);if(!((s=c==null?void 0:c.relay)!=null&&s.protocol)){const{message:l}=Y("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(l)}if(!(c!=null&&c.symKey)){const{message:l}=Y("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(l)}},this.isValidPing=async n=>{if(!hr(n)){const{message:c}=Y("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(c)}const{topic:s}=n;await this.isValidPairingTopic(s)},this.isValidDisconnect=async n=>{if(!hr(n)){const{message:c}=Y("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(c)}const{topic:s}=n;await this.isValidPairingTopic(s)},this.isValidPairingTopic=async n=>{if(!dn(n,!1)){const{message:s}=Y("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=Y("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(bi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=Y("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}},this.core=t,this.logger=Re.generateChildLogger(r,this.name),this.pairings=new Ro(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Re.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Wt.message,async t=>{const{topic:r,message:n}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const s=await this.core.crypto.decode(r,n);try{Hc(s)?(this.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):So(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.core.history.delete(r,s.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Sr.expired,async t=>{const{topic:r}=sf(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Gn.expire,{topic:r}))})}}class CI extends B0{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Or.EventEmitter,this.name=nI,this.version=sI,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,s,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:c}),this.records.has(s.id))return;const l={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:c,expiry:Lr(ne.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(Br.created,l)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=jr(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.events.emit(Br.updated,s))},this.get=async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s)),this.delete=(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(c=>{if(c.topic===n){if(typeof s<"u"&&c.id!==s)return;this.records.delete(c.id),this.events.emit(Br.deleted,c)}})},this.exists=async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1),this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:vn(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Br.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Br.created,t=>{const r=Br.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Br.updated,t=>{const r=Br.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Br.deleted,t=>{const r=Br.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(_n.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{ne.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class $I extends Q0{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Or.EventEmitter,this.name=oI,this.version=aI,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}},this.set=(n,s)=>{this.isInitialized();const c=this.formatTarget(n),l={target:c,expiry:s};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(Sr.created,{target:c,expiration:l})},this.get=n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)},this.del=n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),c=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Sr.deleted,{target:s,expiration:c})}},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return V_(t);if(typeof t=="number")return F_(t);const{message:r}=Y("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Sr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;ne.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Sr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(_n.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Sr.created,t=>{const r=Sr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Sr.expired,t=>{const r=Sr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Sr.deleted,t=>{const r=Sr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class NI extends Y0{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=cc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||G_()||!of())return;const s=this.getVerifyUrl(n==null?void 0:n.verifyUrl);this.verifyUrl!==s&&this.removeIframe(),this.verifyUrl=s;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Ac;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const s=this.getVerifyUrl(n==null?void 0:n.verifyUrl);let c;try{c=await this.fetchAttestation(n.attestationId,s)}catch(l){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${s}`),this.logger.info(l),c=await this.fetchAttestation(n.attestationId,Ac)}return c},this.fetchAttestation=async(n,s)=>{this.logger.info(`resolving attestation: ${n} from url: ${s}`);const c=this.startAbortTimer(ne.ONE_SECOND*2),l=await fetch(`${s}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(c),l.status===200?await l.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var s;try{if(!this.iframe)return;(s=this.iframe.contentWindow)==null||s.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const s=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",s),n())};await Promise.race([new Promise(c=>{if(document.getElementById(cc))return c();window.addEventListener("message",s);const l=document.createElement("iframe");l.id=cc,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,n=c}),new Promise((c,l)=>setTimeout(()=>{window.removeEventListener("message",s),l("verify iframe load timeout")},ne.toMiliseconds(ne.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let s=n||gn;return cI.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${gn}`),s=gn),s},this.logger=Re.generateChildLogger(r,this.name),this.verifyUrl=gn,this.abortController=new AbortController,this.isDevEnv=W_()&&u1.IS_VITEST}get context(){return Re.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ne.toMiliseconds(t))}}class DI extends X0{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.context=uI,this.registerDeviceToken=async n=>{const{clientId:s,token:c,notificationType:l,enableEncrypted:d=!1}=n,_=`${hI}/${this.projectId}/clients`;await c1(_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:l,token:c,always_raw:d})})},this.logger=Re.generateChildLogger(r,this.context)}}var LI=Object.defineProperty,jl=Object.getOwnPropertySymbols,jI=Object.prototype.hasOwnProperty,qI=Object.prototype.propertyIsEnumerable,ql=(a,t,r)=>t in a?LI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Ml=(a,t)=>{for(var r in t||(t={}))jI.call(t,r)&&ql(a,r,t[r]);if(jl)for(var r of jl(t))qI.call(t,r)&&ql(a,r,t[r]);return a};class Kc extends K0{constructor(t){super(t),this.protocol=Uf,this.version=DE,this.name=kc,this.events=new Or.EventEmitter,this.initialized=!1,this.on=(n,s)=>this.events.on(n,s),this.once=(n,s)=>this.events.once(n,s),this.off=(n,s)=>this.events.off(n,s),this.removeListener=(n,s)=>this.events.removeListener(n,s),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||kf,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||LE.logger}));this.logger=Re.generateChildLogger(r,this.name),this.heartbeat=new _n.HeartBeat,this.crypto=new fI(this,this.logger,t==null?void 0:t.keychain),this.history=new CI(this,this.logger),this.expirer=new $I(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Gw(Ml(Ml({},jE),t==null?void 0:t.storageOptions)),this.relayer=new SI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new AI(this,this.logger),this.verify=new NI(this.projectId||"",this.logger),this.echoClient=new DI(this.projectId||"",this.logger)}static async init(t){const r=new Kc(t);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(XE,n),r}get context(){return Re.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const MI=Kc,Kf="wc",Bf=2,Vf="client",Bc=`${Kf}@${Bf}:${Vf}:`,hc={name:Vf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},zl="WALLETCONNECT_DEEPLINK_CHOICE",zI="proposal",Ff="Proposal expired",UI="session",lo=ne.SEVEN_DAYS,HI="engine",Kn={wc_sessionPropose:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1115}}},lc={min:ne.FIVE_MINUTES,max:ne.SEVEN_DAYS},oi={idle:"IDLE",active:"ACTIVE"},kI="request",KI=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var BI=Object.defineProperty,VI=Object.defineProperties,FI=Object.getOwnPropertyDescriptors,Ul=Object.getOwnPropertySymbols,GI=Object.prototype.hasOwnProperty,WI=Object.prototype.propertyIsEnumerable,Hl=(a,t,r)=>t in a?BI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,cr=(a,t)=>{for(var r in t||(t={}))GI.call(t,r)&&Hl(a,r,t[r]);if(Ul)for(var r of Ul(t))WI.call(t,r)&&Hl(a,r,t[r]);return a},Bn=(a,t)=>VI(a,FI(t));class JI extends eb{constructor(t){super(t),this.name=HI,this.events=new qc,this.initialized=!1,this.ignoredPayloadTypes=[nf],this.requestQueue={state:oi.idle,queue:[]},this.sessionRequestQueue={state:oi.idle,queue:[]},this.requestQueueDelay=ne.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Kn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ne.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=Bn(cr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:s,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:d,relays:_}=n;let p=s,b,S=!1;if(p&&(S=this.client.core.pairing.pairings.get(p).active),!p||!S){const{topic:fe,uri:pe}=await this.client.core.pairing.create();p=fe,b=pe}const x=await this.client.core.crypto.generateKeyPair(),D=cr({requiredNamespaces:c,optionalNamespaces:l,relays:_??[{protocol:Hf}],proposer:{publicKey:x,metadata:this.client.metadata}},d&&{sessionProperties:d}),{reject:C,resolve:V,done:re}=pn(ne.FIVE_MINUTES,Ff);if(this.events.once(Nt("session_connect"),async({error:fe,session:pe})=>{if(fe)C(fe);else if(pe){pe.self.publicKey=x;const de=Bn(cr({},pe),{requiredNamespaces:pe.requiredNamespaces,optionalNamespaces:pe.optionalNamespaces});await this.client.session.set(pe.topic,de),await this.setExpiry(pe.topic,pe.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:pe.peer.metadata}),V(de)}}),!p){const{message:fe}=Y("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(fe)}const he=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:D}),le=Lr(ne.FIVE_MINUTES);return await this.setProposal(he,cr({id:he,expiry:le},D)),{uri:b,approval:re}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:s,namespaces:c,sessionProperties:l}=r,d=this.client.proposal.get(n);let{pairingTopic:_,proposer:p,requiredNamespaces:b,optionalNamespaces:S}=d;_=_||"",yo(b)||(b=Q_(c,"approve()"));const x=await this.client.core.crypto.generateKeyPair(),D=p.publicKey,C=await this.client.core.crypto.generateSharedKey(x,D);_&&n&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:p.metadata}),await this.sendResult({id:n,topic:_,result:{relay:{protocol:s??"irn"},responderPublicKey:x}}),await this.client.proposal.delete(n,Gt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const V=cr({relay:{protocol:s??"irn"},namespaces:c,requiredNamespaces:b,optionalNamespaces:S,pairingTopic:_,controller:{publicKey:x,metadata:this.client.metadata},expiry:Lr(lo)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(C),await this.sendRequest({topic:C,method:"wc_sessionSettle",params:V,throwOnFailedPublish:!0});const re=Bn(cr({},V),{topic:C,pairingTopic:_,acknowledged:!1,self:V.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:x});return await this.client.session.set(C,re),await this.setExpiry(C,Lr(lo)),{topic:C,acknowledged:()=>new Promise(he=>setTimeout(()=>he(this.client.session.get(C)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:s}=r,{pairingTopic:c}=this.client.proposal.get(n);c&&(await this.sendError(n,c,s),await this.client.proposal.delete(n,Gt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:s}=r,c=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s}}),{done:l,resolve:d,reject:_}=pn();return this.events.once(Nt("session_update",c),({error:p})=>{p?_(p):d()}),await this.client.session.update(n,{namespaces:s}),{acknowledged:l}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,s=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:c,resolve:l,reject:d}=pn();return this.events.once(Nt("session_extend",s),({error:_})=>{_?d(_):l()}),await this.setExpiry(n,Lr(lo)),{acknowledged:c}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:s,topic:c,expiry:l}=r,d=Uc(),{done:_,resolve:p,reject:b}=pn(l,"Request expired. Please try again.");return this.events.once(Nt("session_request",d),({error:S,result:x})=>{S?b(S):p(x)}),await Promise.all([new Promise(async S=>{await this.sendRequest({clientRpcId:d,topic:c,method:"wc_sessionRequest",params:{request:s,chainId:n},expiry:l,throwOnFailedPublish:!0}).catch(x=>b(x)),this.client.events.emit("session_request_sent",{topic:c,request:s,chainId:n,id:d}),S()}),new Promise(async S=>{const x=await Y_(this.client.core.storage,zl);X_({id:d,topic:c,wcDeepLink:x}),S()}),_()]).then(S=>S[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:s}=r,{id:c}=s;ai(s)?await this.sendResult({id:c,topic:n,result:s.result,throwOnFailedPublish:!0}):jr(s)&&await this.sendError(c,n,s.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const s=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:c,resolve:l,reject:d}=pn();this.events.once(Nt("session_ping",s),({error:_})=>{_?d(_):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:s,chainId:c}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:c}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:Gt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>Z_(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(c=>{var l,d;return((l=c.peerMetadata)==null?void 0:l.url)&&((d=c.peerMetadata)==null?void 0:d.url)===r.peer.metadata.url&&c.topic&&c.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:s}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Gt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(s.publicKey)&&await this.client.core.crypto.deleteKeyPair(s.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(zl).catch(c=>this.client.logger.warn(c)),this.getPendingSessionRequests().forEach(c=>{c.topic===r&&this.deletePendingSessionRequest(c.id,Gt("USER_DISCONNECTED"))})},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,Gt("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),s?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==r),s&&(this.sessionRequestQueue.state=oi.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=Kn.wc_sessionRequest.req.ttl,{id:s,topic:c,params:l,verifyContext:d}=r;await this.client.pendingRequest.set(s,{id:s,topic:c,params:l,verifyContext:d}),n&&this.client.core.expirer.set(s,Lr(n))},this.sendRequest=async r=>{const{topic:n,method:s,params:c,expiry:l,relayRpcId:d,clientRpcId:_,throwOnFailedPublish:p}=r,b=vn(s,c,_);if(of()&&KI.includes(s)){const D=yn(JSON.stringify(b));this.client.core.verify.register({attestationId:D})}const S=await this.client.core.crypto.encode(n,b),x=Kn[s].req;return l&&(x.ttl=l),d&&(x.id=d),this.client.core.history.set(n,b),p?(x.internal=Bn(cr({},x.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,S,x)):this.client.core.relayer.publish(n,S,x).catch(D=>this.client.logger.error(D)),b.id},this.sendResult=async r=>{const{id:n,topic:s,result:c,throwOnFailedPublish:l}=r,d=xo(n,c),_=await this.client.core.crypto.encode(s,d),p=await this.client.core.history.get(s,n),b=Kn[p.request.method].res;l?(b.internal=Bn(cr({},b.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,_,b)):this.client.core.relayer.publish(s,_,b).catch(S=>this.client.logger.error(S)),await this.client.core.history.resolve(d)},this.sendError=async(r,n,s)=>{const c=Po(r,s),l=await this.client.core.crypto.encode(n,c),d=await this.client.core.history.get(n,r),_=Kn[d.request.method].res;this.client.core.relayer.publish(n,l,_),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(s=>{bi(s.expiry)&&r.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{bi(s.expiry)&&n.push(s.id)}),await Promise.all([...r.map(s=>this.deleteSession(s)),...n.map(s=>this.deleteProposal(s))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===oi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=oi.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=oi.idle},this.processRequest=r=>{const{topic:n,payload:s}=r,c=s.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(n,s);case"wc_sessionSettle":return this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return this.onSessionExtendRequest(n,s);case"wc_sessionPing":return this.onSessionPingRequest(n,s);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return this.onSessionRequest(n,s);case"wc_sessionEvent":return this.onSessionEventRequest(n,s);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:s}=r,c=(await this.client.core.history.get(n,s.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:s}=Y("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)},this.onSessionProposeRequest=async(r,n)=>{const{params:s,id:c}=n;try{this.isValidConnect(cr({},n.params));const l=Lr(ne.FIVE_MINUTES),d=cr({id:c,pairingTopic:r,expiry:l},s);await this.setProposal(c,d);const _=yn(JSON.stringify(n)),p=await this.getVerifyContext(_,d.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:p})}catch(l){await this.sendError(c,r,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(r,n)=>{const{id:s}=n;if(ai(n)){const{result:c}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const d=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const _=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const p=await this.client.core.crypto.generateSharedKey(d,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const b=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:b}),await this.client.core.pairing.activate({topic:r})}else jr(n)&&(await this.client.proposal.delete(s,Gt("USER_DISCONNECTED")),this.events.emit(Nt("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:s,params:c}=n;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:d,expiry:_,namespaces:p,requiredNamespaces:b,optionalNamespaces:S,sessionProperties:x,pairingTopic:D}=n.params,C=cr({topic:r,relay:l,expiry:_,namespaces:p,acknowledged:!0,pairingTopic:D,requiredNamespaces:b,optionalNamespaces:S,controller:d.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:d.publicKey,metadata:d.metadata}},x&&{sessionProperties:x});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit(Nt("session_connect"),{session:C}),this.cleanupDuplicatePairings(C)}catch(l){await this.sendError(s,r,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(r,n)=>{const{id:s}=n;ai(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Nt("session_approve",s),{})):jr(n)&&(await this.client.session.delete(r,Gt("USER_DISCONNECTED")),this.events.emit(Nt("session_approve",s),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:s,id:c}=n;try{const l=`${r}_session_update`,d=co.get(l);if(d&&this.isRequestOutOfSync(d,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(cr({topic:r},s)),await this.client.session.update(r,{namespaces:s.namespaces}),await this.sendResult({id:c,topic:r,result:!0}),this.client.events.emit("session_update",{id:c,topic:r,params:s}),co.set(l,c)}catch(l){await this.sendError(c,r,l),this.client.logger.error(l)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:s}=n;ai(n)?this.events.emit(Nt("session_update",s),{}):jr(n)&&this.events.emit(Nt("session_update",s),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:s}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Lr(lo)),await this.sendResult({id:s,topic:r,result:!0}),this.client.events.emit("session_extend",{id:s,topic:r})}catch(c){await this.sendError(s,r,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(r,n)=>{const{id:s}=n;ai(n)?this.events.emit(Nt("session_extend",s),{}):jr(n)&&this.events.emit(Nt("session_extend",s),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:s}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:s,topic:r,result:!0}),this.client.events.emit("session_ping",{id:s,topic:r})}catch(c){await this.sendError(s,r,c),this.client.logger.error(c)}},this.onSessionPingResponse=(r,n)=>{const{id:s}=n;setTimeout(()=>{ai(n)?this.events.emit(Nt("session_ping",s),{}):jr(n)&&this.events.emit(Nt("session_ping",s),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Wt.publish,async()=>{c(await this.deleteSession(r))})}),this.sendResult({id:s,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:s,topic:r})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(r,n)=>{const{id:s,params:c}=n;try{this.isValidRequest(cr({topic:r},c));const l=yn(JSON.stringify(vn("wc_sessionRequest",c,s))),d=this.client.session.get(r),_=await this.getVerifyContext(l,d.peer.metadata),p={id:s,topic:r,params:c,verifyContext:_};await this.setPendingSessionRequest(p),this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue()}catch(l){await this.sendError(s,r,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(r,n)=>{const{id:s}=n;ai(n)?this.events.emit(Nt("session_request",s),{result:n.result}):jr(n)&&this.events.emit(Nt("session_request",s),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:s,params:c}=n;try{const l=`${r}_session_event_${c.event.name}`,d=co.get(l);if(d&&this.isRequestOutOfSync(d,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(cr({topic:r},c)),this.client.events.emit("session_event",{id:s,topic:r,params:c}),co.set(l,s)}catch(l){await this.sendError(s,r,l),this.client.logger.error(l)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=oi.idle,this.processSessionRequestQueue()},ne.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===oi.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=oi.active,this.client.events.emit("session_request",r)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=r=>{if(r.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,vn("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id))},this.isValidConnect=async r=>{if(!hr(r)){const{message:_}=Y("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(_)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:c,sessionProperties:l,relays:d}=r;if(Ei(n)||await this.isValidPairingTopic(n),!ew(d,!0)){const{message:_}=Y("MISSING_OR_INVALID",`connect() relays: ${d}`);throw new Error(_)}!Ei(s)&&yo(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!Ei(c)&&yo(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),Ei(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(r,n)=>{const s=tw(r,"connect()",n);if(s)throw new Error(s.message)},this.isValidApprove=async r=>{if(!hr(r))throw new Error(Y("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:s,relayProtocol:c,sessionProperties:l}=r;await this.isValidProposalId(n);const d=this.client.proposal.get(n),_=Za(s,"approve()");if(_)throw new Error(_.message);const p=Qh(d.requiredNamespaces,s,"approve()");if(p)throw new Error(p.message);if(!dn(c,!0)){const{message:b}=Y("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(b)}Ei(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async r=>{if(!hr(r)){const{message:c}=Y("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(c)}const{id:n,reason:s}=r;if(await this.isValidProposalId(n),!rw(s)){const{message:c}=Y("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(c)}},this.isValidSessionSettleRequest=r=>{if(!hr(r)){const{message:p}=Y("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(p)}const{relay:n,controller:s,namespaces:c,expiry:l}=r;if(!iw(n)){const{message:p}=Y("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const d=nw(s,"onSessionSettleRequest()");if(d)throw new Error(d.message);const _=Za(c,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(bi(l)){const{message:p}=Y("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async r=>{if(!hr(r)){const{message:_}=Y("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(_)}const{topic:n,namespaces:s}=r;await this.isValidSessionTopic(n);const c=this.client.session.get(n),l=Za(s,"update()");if(l)throw new Error(l.message);const d=Qh(c.requiredNamespaces,s,"update()");if(d)throw new Error(d.message)},this.isValidExtend=async r=>{if(!hr(r)){const{message:s}=Y("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!hr(r)){const{message:_}=Y("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(_)}const{topic:n,request:s,chainId:c,expiry:l}=r;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!Yh(d,c)){const{message:_}=Y("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(_)}if(!sw(s)){const{message:_}=Y("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(_)}if(!ow(d,c,s.method)){const{message:_}=Y("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(_)}if(l&&!aw(l,lc)){const{message:_}=Y("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${lc.min} and ${lc.max}`);throw new Error(_)}},this.isValidRespond=async r=>{var n;if(!hr(r)){const{message:l}=Y("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:s,response:c}=r;try{await this.isValidSessionTopic(s)}catch(l){throw(n=r==null?void 0:r.response)!=null&&n.id&&this.cleanupAfterResponse(r),l}if(!cw(c)){const{message:l}=Y("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!hr(r)){const{message:s}=Y("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!hr(r)){const{message:d}=Y("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(d)}const{topic:n,event:s,chainId:c}=r;await this.isValidSessionTopic(n);const{namespaces:l}=this.client.session.get(n);if(!Yh(l,c)){const{message:d}=Y("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(d)}if(!uw(s)){const{message:d}=Y("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(d)}if(!hw(l,c,s.name)){const{message:d}=Y("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(d)}},this.isValidDisconnect=async r=>{if(!hr(r)){const{message:s}=Y("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const s={verified:{verifyUrl:n.verifyUrl||gn,validation:"UNKNOWN",origin:n.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});c&&(s.verified.origin=c.origin,s.verified.isScam=c.isScam,s.verified.validation=c.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(s)}`),s},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(s=>{if(!dn(s,!1)){const{message:c}=Y("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(s)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Wt.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const s=await this.client.core.crypto.decode(r,n);try{Hc(s)?(this.client.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):So(s)?(await this.client.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.client.core.history.delete(r,s.id)):this.onRelayEventUnknownPayload({topic:r,payload:s})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Sr.expired,async t=>{const{topic:r,id:n}=sf(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Y("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Gn.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!dn(t,!1)){const{message:r}=Y("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=Y("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(bi(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=Y("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!dn(t,!1)){const{message:r}=Y("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=Y("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(bi(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=Y("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(dn(t,!1)){const{message:r}=Y("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=Y("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!lw(t)){const{message:r}=Y("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=Y("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(bi(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=Y("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class QI extends Ro{constructor(t,r){super(t,r,zI,Bc),this.core=t,this.logger=r}}class YI extends Ro{constructor(t,r){super(t,r,UI,Bc),this.core=t,this.logger=r}}class XI extends Ro{constructor(t,r){super(t,r,kI,Bc,n=>n.id),this.core=t,this.logger=r}}let ZI=class Gf extends Z0{constructor(t){super(t),this.protocol=Kf,this.version=Bf,this.name=hc.name,this.events=new Or.EventEmitter,this.on=(n,s)=>this.events.on(n,s),this.once=(n,s)=>this.events.once(n,s),this.off=(n,s)=>this.events.off(n,s),this.removeListener=(n,s)=>this.events.removeListener(n,s),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}},this.update=async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}},this.request=async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}},this.find=n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(t==null?void 0:t.name)||hc.name,this.metadata=(t==null?void 0:t.metadata)||J_();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||hc.logger}));this.core=(t==null?void 0:t.core)||new MI(t),this.logger=Re.generateChildLogger(r,this.name),this.session=new YI(this.core,this.logger),this.proposal=new QI(this.core,this.logger),this.pendingRequest=new XI(this.core,this.logger),this.engine=new JI(this)}static async init(t){const r=new Gf(t);return await r.initialize(),r}get context(){return Re.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var Cc={exports:{}};(function(a,t){var r=typeof self<"u"?self:fw,n=function(){function c(){this.fetch=!1,this.DOMException=r.DOMException}return c.prototype=r,new c}();(function(c){(function(l){var d={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function _(m){return m&&DataView.prototype.isPrototypeOf(m)}if(d.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=ArrayBuffer.isView||function(m){return m&&p.indexOf(Object.prototype.toString.call(m))>-1};function S(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(m))throw new TypeError("Invalid character in header field name");return m.toLowerCase()}function x(m){return typeof m!="string"&&(m=String(m)),m}function D(m){var P={next:function(){var X=m.shift();return{done:X===void 0,value:X}}};return d.iterable&&(P[Symbol.iterator]=function(){return P}),P}function C(m){this.map={},m instanceof C?m.forEach(function(P,X){this.append(X,P)},this):Array.isArray(m)?m.forEach(function(P){this.append(P[0],P[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(P){this.append(P,m[P])},this)}C.prototype.append=function(m,P){m=S(m),P=x(P);var X=this.map[m];this.map[m]=X?X+", "+P:P},C.prototype.delete=function(m){delete this.map[S(m)]},C.prototype.get=function(m){return m=S(m),this.has(m)?this.map[m]:null},C.prototype.has=function(m){return this.map.hasOwnProperty(S(m))},C.prototype.set=function(m,P){this.map[S(m)]=x(P)},C.prototype.forEach=function(m,P){for(var X in this.map)this.map.hasOwnProperty(X)&&m.call(P,this.map[X],X,this)},C.prototype.keys=function(){var m=[];return this.forEach(function(P,X){m.push(X)}),D(m)},C.prototype.values=function(){var m=[];return this.forEach(function(P){m.push(P)}),D(m)},C.prototype.entries=function(){var m=[];return this.forEach(function(P,X){m.push([X,P])}),D(m)},d.iterable&&(C.prototype[Symbol.iterator]=C.prototype.entries);function V(m){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}function re(m){return new Promise(function(P,X){m.onload=function(){P(m.result)},m.onerror=function(){X(m.error)}})}function he(m){var P=new FileReader,X=re(P);return P.readAsArrayBuffer(m),X}function le(m){var P=new FileReader,X=re(P);return P.readAsText(m),X}function fe(m){for(var P=new Uint8Array(m),X=new Array(P.length),ce=0;ce<P.length;ce++)X[ce]=String.fromCharCode(P[ce]);return X.join("")}function pe(m){if(m.slice)return m.slice(0);var P=new Uint8Array(m.byteLength);return P.set(new Uint8Array(m)),P.buffer}function de(){return this.bodyUsed=!1,this._initBody=function(m){this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:d.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:d.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:d.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():d.arrayBuffer&&d.blob&&_(m)?(this._bodyArrayBuffer=pe(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):d.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||b(m))?this._bodyArrayBuffer=pe(m):this._bodyText=m=Object.prototype.toString.call(m):this._bodyText="",this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):d.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d.blob&&(this.blob=function(){var m=V(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?V(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(he)}),this.text=function(){var m=V(this);if(m)return m;if(this._bodyBlob)return le(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(fe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},d.formData&&(this.formData=function(){return this.text().then(ve)}),this.json=function(){return this.text().then(JSON.parse)},this}var j=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function H(m){var P=m.toUpperCase();return j.indexOf(P)>-1?P:m}function W(m,P){P=P||{};var X=P.body;if(m instanceof W){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,P.headers||(this.headers=new C(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!X&&m._bodyInit!=null&&(X=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=P.credentials||this.credentials||"same-origin",(P.headers||!this.headers)&&(this.headers=new C(P.headers)),this.method=H(P.method||this.method||"GET"),this.mode=P.mode||this.mode||null,this.signal=P.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}W.prototype.clone=function(){return new W(this,{body:this._bodyInit})};function ve(m){var P=new FormData;return m.trim().split("&").forEach(function(X){if(X){var ce=X.split("="),F=ce.shift().replace(/\+/g," "),k=ce.join("=").replace(/\+/g," ");P.append(decodeURIComponent(F),decodeURIComponent(k))}}),P}function ie(m){var P=new C,X=m.replace(/\r?\n[\t ]+/g," ");return X.split(/\r?\n/).forEach(function(ce){var F=ce.split(":"),k=F.shift().trim();if(k){var B=F.join(":").trim();P.append(k,B)}}),P}de.call(W.prototype);function ue(m,P){P||(P={}),this.type="default",this.status=P.status===void 0?200:P.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in P?P.statusText:"OK",this.headers=new C(P.headers),this.url=P.url||"",this._initBody(m)}de.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new C(this.headers),url:this.url})},ue.error=function(){var m=new ue(null,{status:0,statusText:""});return m.type="error",m};var Ce=[301,302,303,307,308];ue.redirect=function(m,P){if(Ce.indexOf(P)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:P,headers:{location:m}})},l.DOMException=c.DOMException;try{new l.DOMException}catch{l.DOMException=function(P,X){this.message=P,this.name=X;var ce=Error(P);this.stack=ce.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function Ue(m,P){return new Promise(function(X,ce){var F=new W(m,P);if(F.signal&&F.signal.aborted)return ce(new l.DOMException("Aborted","AbortError"));var k=new XMLHttpRequest;function B(){k.abort()}k.onload=function(){var G={status:k.status,statusText:k.statusText,headers:ie(k.getAllResponseHeaders()||"")};G.url="responseURL"in k?k.responseURL:G.headers.get("X-Request-URL");var Je="response"in k?k.response:k.responseText;X(new ue(Je,G))},k.onerror=function(){ce(new TypeError("Network request failed"))},k.ontimeout=function(){ce(new TypeError("Network request failed"))},k.onabort=function(){ce(new l.DOMException("Aborted","AbortError"))},k.open(F.method,F.url,!0),F.credentials==="include"?k.withCredentials=!0:F.credentials==="omit"&&(k.withCredentials=!1),"responseType"in k&&d.blob&&(k.responseType="blob"),F.headers.forEach(function(G,Je){k.setRequestHeader(Je,G)}),F.signal&&(F.signal.addEventListener("abort",B),k.onreadystatechange=function(){k.readyState===4&&F.signal.removeEventListener("abort",B)}),k.send(typeof F._bodyInit>"u"?null:F._bodyInit)})}return Ue.polyfill=!0,c.fetch||(c.fetch=Ue,c.Headers=C,c.Request=W,c.Response=ue),l.Headers=C,l.Request=W,l.Response=ue,l.fetch=Ue,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=n;t=s.fetch,t.default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,a.exports=t})(Cc,Cc.exports);var ex=Cc.exports;const kl=jc(ex),tx={Accept:"application/json","Content-Type":"application/json"},rx="POST",Kl={headers:tx,method:rx},Bl=10;class Pi{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new Or.EventEmitter,this.isAvailable=!1,this.registering=!1,!yl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const n=ki(t),c=await(await kl(this.url,Object.assign(Object.assign({},Kl),{body:n}))).json();this.onPayload({data:c})}catch(n){this.onError(t.id,n)}}async register(t=this.url){if(!yl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,s)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),s(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=ki({id:1,jsonrpc:"2.0",method:"test",params:[]});await kl(t,Object.assign(Object.assign({},Kl),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?rs(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),s=n.message||n.toString(),c=Po(t,s);this.events.emit("payload",c)}parseError(t,r=this.url){return If(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Bl&&this.events.setMaxListeners(Bl)}}const Vl="error",ix="wss://relay.walletconnect.com",nx="wc",sx="universal_provider",Fl=`${nx}@2:${sx}:`,ox="https://rpc.walletconnect.com/v1/",ui={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Vn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},$c={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,t){(function(){var r,n="4.17.21",s=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",d="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",p=500,b="__lodash_placeholder__",S=1,x=2,D=4,C=1,V=2,re=1,he=2,le=4,fe=8,pe=16,de=32,j=64,H=128,W=256,ve=512,ie=30,ue="...",Ce=800,Ue=16,m=1,P=2,X=3,ce=1/0,F=9007199254740991,k=17976931348623157e292,B=NaN,G=4294967295,Je=G-1,Ke=G>>>1,qr=[["ary",H],["bind",re],["bindKey",he],["curry",fe],["curryRight",pe],["flip",ve],["partial",de],["partialRight",j],["rearg",W]],Ie="[object Arguments]",It="[object Array]",L="[object AsyncFunction]",N="[object Boolean]",A="[object Date]",h="[object DOMException]",I="[object Error]",ee="[object Function]",ge="[object GeneratorFunction]",be="[object Map]",$e="[object Number]",De="[object Null]",Se="[object Object]",xt="[object Promise]",mt="[object Proxy]",ot="[object RegExp]",je="[object Set]",Ye="[object String]",Xe="[object Symbol]",at="[object Undefined]",He="[object WeakMap]",Ze="[object WeakSet]",Ne="[object ArrayBuffer]",Be="[object DataView]",ht="[object Float32Array]",Me="[object Float64Array]",Pt="[object Int8Array]",Dt="[object Int16Array]",Ht="[object Int32Array]",kt="[object Uint8Array]",qt="[object Uint8ClampedArray]",Jt="[object Uint16Array]",rr="[object Uint32Array]",Mr=/\b__p \+= '';/g,Qt=/\b(__p \+=) '' \+/g,Vr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,hi=/&(?:amp|lt|gt|quot|#39);/g,Si=/[&<>"']/g,lt=RegExp(hi.source),rt=RegExp(Si.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ct=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,St=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,Rt=RegExp(dt.source),gt=/^\s+/,_t=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qe=/\{\n\/\* \[wrapped with (.+)\] \*/,Tt=/,? & /,At=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,To=/[()=,{}\[\]\/\s]/,Ao=/\\(\\)?/g,Co=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,vr=/\w*$/,$o=/^[-+]0x[0-9a-f]+$/i,No=/^0b[01]+$/i,Do=/^\[object .+?Constructor\]$/,Lo=/^0o[0-7]+$/i,jo=/^(?:0|[1-9]\d*)$/,Fr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Fi=/($^)/,qo=/['\n\r\u2028\u2029\\]/g,Gi="\\ud800-\\udfff",Mo="\\u0300-\\u036f",zo="\\ufe20-\\ufe2f",Wi="\\u20d0-\\u20ff",ns=Mo+zo+Wi,ss="\\u2700-\\u27bf",Rr="a-z\\xdf-\\xf6\\xf8-\\xff",Uo="\\xac\\xb1\\xd7\\xf7",Ho="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ko="\\u2000-\\u206f",Ko=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",os="A-Z\\xc0-\\xd6\\xd8-\\xde",as="\\ufe0e\\ufe0f",Oi=Uo+Ho+ko+Ko,wn="[']",Ri="["+Gi+"]",bn="["+Oi+"]",Ti="["+ns+"]",cs="\\d+",Bo="["+ss+"]",us="["+Rr+"]",hs="[^"+Gi+Oi+cs+ss+Rr+os+"]",Ji="\\ud83c[\\udffb-\\udfff]",Vo="(?:"+Ti+"|"+Ji+")",ls="[^"+Gi+"]",Qi="(?:\\ud83c[\\udde6-\\uddff]){2}",li="[\\ud800-\\udbff][\\udc00-\\udfff]",lr="["+os+"]",fs="\\u200d",ps="(?:"+us+"|"+hs+")",zr="(?:"+lr+"|"+hs+")",ds="(?:"+wn+"(?:d|ll|m|re|s|t|ve))?",gs="(?:"+wn+"(?:D|LL|M|RE|S|T|VE))?",ys=Vo+"?",vs="["+as+"]?",Fo="(?:"+fs+"(?:"+[ls,Qi,li].join("|")+")"+vs+ys+")*",Gr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ms="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",_s=vs+ys+Fo,Yi="(?:"+[Bo,Qi,li].join("|")+")"+_s,Go="(?:"+[ls+Ti+"?",Ti,Qi,li,Ri].join("|")+")",En=RegExp(wn,"g"),Wo=RegExp(Ti,"g"),Xi=RegExp(Ji+"(?="+Ji+")|"+Go+_s,"g"),ws=RegExp([lr+"?"+us+"+"+ds+"(?="+[bn,lr,"$"].join("|")+")",zr+"+"+gs+"(?="+[bn,lr+ps,"$"].join("|")+")",lr+"?"+ps+"+"+ds,lr+"+"+gs,ms,Gr,cs,Yi].join("|"),"g"),bs=RegExp("["+fs+Gi+ns+as+"]"),Ai=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Es=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Jo=-1,Ve={};Ve[ht]=Ve[Me]=Ve[Pt]=Ve[Dt]=Ve[Ht]=Ve[kt]=Ve[qt]=Ve[Jt]=Ve[rr]=!0,Ve[Ie]=Ve[It]=Ve[Ne]=Ve[N]=Ve[Be]=Ve[A]=Ve[I]=Ve[ee]=Ve[be]=Ve[$e]=Ve[Se]=Ve[ot]=Ve[je]=Ve[Ye]=Ve[He]=!1;var ke={};ke[Ie]=ke[It]=ke[Ne]=ke[Be]=ke[N]=ke[A]=ke[ht]=ke[Me]=ke[Pt]=ke[Dt]=ke[Ht]=ke[be]=ke[$e]=ke[Se]=ke[ot]=ke[je]=ke[Ye]=ke[Xe]=ke[kt]=ke[qt]=ke[Jt]=ke[rr]=!0,ke[I]=ke[ee]=ke[He]=!1;var v={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},U={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Q={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Fe=parseFloat,me=parseInt,et=typeof Vn=="object"&&Vn&&Vn.Object===Object&&Vn,Ct=typeof self=="object"&&self&&self.Object===Object&&self,Te=et||Ct||Function("return this")(),Ge=t&&!t.nodeType&&t,wt=Ge&&!0&&a&&!a.nodeType&&a,ir=wt&&wt.exports===Ge,$t=ir&&et.process,tt=function(){try{var R=wt&&wt.require&&wt.require("util").types;return R||$t&&$t.binding&&$t.binding("util")}catch{}}(),Yt=tt&&tt.isArrayBuffer,Tr=tt&&tt.isDate,mr=tt&&tt.isMap,Ur=tt&&tt.isRegExp,In=tt&&tt.isSet,Ci=tt&&tt.isTypedArray;function Mt(R,q,$){switch($.length){case 0:return R.call(q);case 1:return R.call(q,$[0]);case 2:return R.call(q,$[0],$[1]);case 3:return R.call(q,$[0],$[1],$[2])}return R.apply(q,$)}function Qf(R,q,$,Z){for(var ye=-1,Le=R==null?0:R.length;++ye<Le;){var Lt=R[ye];q(Z,Lt,$(Lt),R)}return Z}function _r(R,q){for(var $=-1,Z=R==null?0:R.length;++$<Z&&q(R[$],$,R)!==!1;);return R}function Yf(R,q){for(var $=R==null?0:R.length;$--&&q(R[$],$,R)!==!1;);return R}function Gc(R,q){for(var $=-1,Z=R==null?0:R.length;++$<Z;)if(!q(R[$],$,R))return!1;return!0}function fi(R,q){for(var $=-1,Z=R==null?0:R.length,ye=0,Le=[];++$<Z;){var Lt=R[$];q(Lt,$,R)&&(Le[ye++]=Lt)}return Le}function Is(R,q){var $=R==null?0:R.length;return!!$&&Zi(R,q,0)>-1}function Qo(R,q,$){for(var Z=-1,ye=R==null?0:R.length;++Z<ye;)if($(q,R[Z]))return!0;return!1}function nt(R,q){for(var $=-1,Z=R==null?0:R.length,ye=Array(Z);++$<Z;)ye[$]=q(R[$],$,R);return ye}function pi(R,q){for(var $=-1,Z=q.length,ye=R.length;++$<Z;)R[ye+$]=q[$];return R}function Yo(R,q,$,Z){var ye=-1,Le=R==null?0:R.length;for(Z&&Le&&($=R[++ye]);++ye<Le;)$=q($,R[ye],ye,R);return $}function Xf(R,q,$,Z){var ye=R==null?0:R.length;for(Z&&ye&&($=R[--ye]);ye--;)$=q($,R[ye],ye,R);return $}function Xo(R,q){for(var $=-1,Z=R==null?0:R.length;++$<Z;)if(q(R[$],$,R))return!0;return!1}var Zf=Zo("length");function ep(R){return R.split("")}function tp(R){return R.match(At)||[]}function Wc(R,q,$){var Z;return $(R,function(ye,Le,Lt){if(q(ye,Le,Lt))return Z=Le,!1}),Z}function xs(R,q,$,Z){for(var ye=R.length,Le=$+(Z?1:-1);Z?Le--:++Le<ye;)if(q(R[Le],Le,R))return Le;return-1}function Zi(R,q,$){return q===q?pp(R,q,$):xs(R,Jc,$)}function rp(R,q,$,Z){for(var ye=$-1,Le=R.length;++ye<Le;)if(Z(R[ye],q))return ye;return-1}function Jc(R){return R!==R}function Qc(R,q){var $=R==null?0:R.length;return $?ta(R,q)/$:B}function Zo(R){return function(q){return q==null?r:q[R]}}function ea(R){return function(q){return R==null?r:R[q]}}function Yc(R,q,$,Z,ye){return ye(R,function(Le,Lt,We){$=Z?(Z=!1,Le):q($,Le,Lt,We)}),$}function ip(R,q){var $=R.length;for(R.sort(q);$--;)R[$]=R[$].value;return R}function ta(R,q){for(var $,Z=-1,ye=R.length;++Z<ye;){var Le=q(R[Z]);Le!==r&&($=$===r?Le:$+Le)}return $}function ra(R,q){for(var $=-1,Z=Array(R);++$<R;)Z[$]=q($);return Z}function np(R,q){return nt(q,function($){return[$,R[$]]})}function Xc(R){return R&&R.slice(0,ru(R)+1).replace(gt,"")}function fr(R){return function(q){return R(q)}}function ia(R,q){return nt(q,function($){return R[$]})}function xn(R,q){return R.has(q)}function Zc(R,q){for(var $=-1,Z=R.length;++$<Z&&Zi(q,R[$],0)>-1;);return $}function eu(R,q){for(var $=R.length;$--&&Zi(q,R[$],0)>-1;);return $}function sp(R,q){for(var $=R.length,Z=0;$--;)R[$]===q&&++Z;return Z}var op=ea(v),ap=ea(O);function cp(R){return"\\"+Q[R]}function up(R,q){return R==null?r:R[q]}function en(R){return bs.test(R)}function hp(R){return Ai.test(R)}function lp(R){for(var q,$=[];!(q=R.next()).done;)$.push(q.value);return $}function na(R){var q=-1,$=Array(R.size);return R.forEach(function(Z,ye){$[++q]=[ye,Z]}),$}function tu(R,q){return function($){return R(q($))}}function di(R,q){for(var $=-1,Z=R.length,ye=0,Le=[];++$<Z;){var Lt=R[$];(Lt===q||Lt===b)&&(R[$]=b,Le[ye++]=$)}return Le}function Ps(R){var q=-1,$=Array(R.size);return R.forEach(function(Z){$[++q]=Z}),$}function fp(R){var q=-1,$=Array(R.size);return R.forEach(function(Z){$[++q]=[Z,Z]}),$}function pp(R,q,$){for(var Z=$-1,ye=R.length;++Z<ye;)if(R[Z]===q)return Z;return-1}function dp(R,q,$){for(var Z=$+1;Z--;)if(R[Z]===q)return Z;return Z}function tn(R){return en(R)?yp(R):Zf(R)}function Ar(R){return en(R)?vp(R):ep(R)}function ru(R){for(var q=R.length;q--&&_t.test(R.charAt(q)););return q}var gp=ea(U);function yp(R){for(var q=Xi.lastIndex=0;Xi.test(R);)++q;return q}function vp(R){return R.match(Xi)||[]}function mp(R){return R.match(ws)||[]}var _p=function R(q){q=q==null?Te:rn.defaults(Te.Object(),q,rn.pick(Te,Es));var $=q.Array,Z=q.Date,ye=q.Error,Le=q.Function,Lt=q.Math,We=q.Object,sa=q.RegExp,wp=q.String,wr=q.TypeError,Ss=$.prototype,bp=Le.prototype,nn=We.prototype,Os=q["__core-js_shared__"],Rs=bp.toString,ze=nn.hasOwnProperty,Ep=0,iu=function(){var e=/[^.]+$/.exec(Os&&Os.keys&&Os.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ts=nn.toString,Ip=Rs.call(We),xp=Te._,Pp=sa("^"+Rs.call(ze).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),As=ir?q.Buffer:r,gi=q.Symbol,Cs=q.Uint8Array,nu=As?As.allocUnsafe:r,$s=tu(We.getPrototypeOf,We),su=We.create,ou=nn.propertyIsEnumerable,Ns=Ss.splice,au=gi?gi.isConcatSpreadable:r,Pn=gi?gi.iterator:r,$i=gi?gi.toStringTag:r,Ds=function(){try{var e=qi(We,"defineProperty");return e({},"",{}),e}catch{}}(),Sp=q.clearTimeout!==Te.clearTimeout&&q.clearTimeout,Op=Z&&Z.now!==Te.Date.now&&Z.now,Rp=q.setTimeout!==Te.setTimeout&&q.setTimeout,Ls=Lt.ceil,js=Lt.floor,oa=We.getOwnPropertySymbols,Tp=As?As.isBuffer:r,cu=q.isFinite,Ap=Ss.join,Cp=tu(We.keys,We),jt=Lt.max,Vt=Lt.min,$p=Z.now,Np=q.parseInt,uu=Lt.random,Dp=Ss.reverse,aa=qi(q,"DataView"),Sn=qi(q,"Map"),ca=qi(q,"Promise"),sn=qi(q,"Set"),On=qi(q,"WeakMap"),Rn=qi(We,"create"),qs=On&&new On,on={},Lp=Mi(aa),jp=Mi(Sn),qp=Mi(ca),Mp=Mi(sn),zp=Mi(On),Ms=gi?gi.prototype:r,Tn=Ms?Ms.valueOf:r,hu=Ms?Ms.toString:r;function g(e){if(vt(e)&&!_e(e)&&!(e instanceof Oe)){if(e instanceof br)return e;if(ze.call(e,"__wrapped__"))return lh(e)}return new br(e)}var an=function(){function e(){}return function(i){if(!ut(i))return{};if(su)return su(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function zs(){}function br(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}g.templateSettings={escape:ft,evaluate:pt,interpolate:ct,variable:"",imports:{_:g}},g.prototype=zs.prototype,g.prototype.constructor=g,br.prototype=an(zs.prototype),br.prototype.constructor=br;function Oe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=G,this.__views__=[]}function Up(){var e=new Oe(this.__wrapped__);return e.__actions__=nr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=nr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=nr(this.__views__),e}function Hp(){if(this.__filtered__){var e=new Oe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function kp(){var e=this.__wrapped__.value(),i=this.__dir__,o=_e(e),u=i<0,f=o?e.length:0,y=eg(0,f,this.__views__),w=y.start,E=y.end,T=E-w,M=u?E:w-1,z=this.__iteratees__,K=z.length,J=0,te=Vt(T,this.__takeCount__);if(!o||!u&&f==T&&te==T)return Du(e,this.__actions__);var oe=[];e:for(;T--&&J<te;){M+=i;for(var Ee=-1,ae=e[M];++Ee<K;){var Pe=z[Ee],Ae=Pe.iteratee,gr=Pe.type,er=Ae(ae);if(gr==P)ae=er;else if(!er){if(gr==m)continue e;break e}}oe[J++]=ae}return oe}Oe.prototype=an(zs.prototype),Oe.prototype.constructor=Oe;function Ni(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function Kp(){this.__data__=Rn?Rn(null):{},this.size=0}function Bp(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function Vp(e){var i=this.__data__;if(Rn){var o=i[e];return o===_?r:o}return ze.call(i,e)?i[e]:r}function Fp(e){var i=this.__data__;return Rn?i[e]!==r:ze.call(i,e)}function Gp(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Rn&&i===r?_:i,this}Ni.prototype.clear=Kp,Ni.prototype.delete=Bp,Ni.prototype.get=Vp,Ni.prototype.has=Fp,Ni.prototype.set=Gp;function Wr(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function Wp(){this.__data__=[],this.size=0}function Jp(e){var i=this.__data__,o=Us(i,e);if(o<0)return!1;var u=i.length-1;return o==u?i.pop():Ns.call(i,o,1),--this.size,!0}function Qp(e){var i=this.__data__,o=Us(i,e);return o<0?r:i[o][1]}function Yp(e){return Us(this.__data__,e)>-1}function Xp(e,i){var o=this.__data__,u=Us(o,e);return u<0?(++this.size,o.push([e,i])):o[u][1]=i,this}Wr.prototype.clear=Wp,Wr.prototype.delete=Jp,Wr.prototype.get=Qp,Wr.prototype.has=Yp,Wr.prototype.set=Xp;function Jr(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function Zp(){this.size=0,this.__data__={hash:new Ni,map:new(Sn||Wr),string:new Ni}}function ed(e){var i=Xs(this,e).delete(e);return this.size-=i?1:0,i}function td(e){return Xs(this,e).get(e)}function rd(e){return Xs(this,e).has(e)}function id(e,i){var o=Xs(this,e),u=o.size;return o.set(e,i),this.size+=o.size==u?0:1,this}Jr.prototype.clear=Zp,Jr.prototype.delete=ed,Jr.prototype.get=td,Jr.prototype.has=rd,Jr.prototype.set=id;function Di(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new Jr;++i<o;)this.add(e[i])}function nd(e){return this.__data__.set(e,_),this}function sd(e){return this.__data__.has(e)}Di.prototype.add=Di.prototype.push=nd,Di.prototype.has=sd;function Cr(e){var i=this.__data__=new Wr(e);this.size=i.size}function od(){this.__data__=new Wr,this.size=0}function ad(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function cd(e){return this.__data__.get(e)}function ud(e){return this.__data__.has(e)}function hd(e,i){var o=this.__data__;if(o instanceof Wr){var u=o.__data__;if(!Sn||u.length<s-1)return u.push([e,i]),this.size=++o.size,this;o=this.__data__=new Jr(u)}return o.set(e,i),this.size=o.size,this}Cr.prototype.clear=od,Cr.prototype.delete=ad,Cr.prototype.get=cd,Cr.prototype.has=ud,Cr.prototype.set=hd;function lu(e,i){var o=_e(e),u=!o&&zi(e),f=!o&&!u&&wi(e),y=!o&&!u&&!f&&ln(e),w=o||u||f||y,E=w?ra(e.length,wp):[],T=E.length;for(var M in e)(i||ze.call(e,M))&&!(w&&(M=="length"||f&&(M=="offset"||M=="parent")||y&&(M=="buffer"||M=="byteLength"||M=="byteOffset")||Zr(M,T)))&&E.push(M);return E}function fu(e){var i=e.length;return i?e[_a(0,i-1)]:r}function ld(e,i){return Zs(nr(e),Li(i,0,e.length))}function fd(e){return Zs(nr(e))}function ua(e,i,o){(o!==r&&!$r(e[i],o)||o===r&&!(i in e))&&Qr(e,i,o)}function An(e,i,o){var u=e[i];(!(ze.call(e,i)&&$r(u,o))||o===r&&!(i in e))&&Qr(e,i,o)}function Us(e,i){for(var o=e.length;o--;)if($r(e[o][0],i))return o;return-1}function pd(e,i,o,u){return yi(e,function(f,y,w){i(u,f,o(f),w)}),u}function pu(e,i){return e&&kr(i,zt(i),e)}function dd(e,i){return e&&kr(i,or(i),e)}function Qr(e,i,o){i=="__proto__"&&Ds?Ds(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function ha(e,i){for(var o=-1,u=i.length,f=$(u),y=e==null;++o<u;)f[o]=y?r:Ba(e,i[o]);return f}function Li(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function Er(e,i,o,u,f,y){var w,E=i&S,T=i&x,M=i&D;if(o&&(w=f?o(e,u,f,y):o(e)),w!==r)return w;if(!ut(e))return e;var z=_e(e);if(z){if(w=rg(e),!E)return nr(e,w)}else{var K=Ft(e),J=K==ee||K==ge;if(wi(e))return qu(e,E);if(K==Se||K==Ie||J&&!f){if(w=T||J?{}:rh(e),!E)return T?Vd(e,dd(w,e)):Bd(e,pu(w,e))}else{if(!ke[K])return f?e:{};w=ig(e,K,E)}}y||(y=new Cr);var te=y.get(e);if(te)return te;y.set(e,w),Ch(e)?e.forEach(function(ae){w.add(Er(ae,i,o,ae,e,y))}):Th(e)&&e.forEach(function(ae,Pe){w.set(Pe,Er(ae,i,o,Pe,e,y))});var oe=M?T?Aa:Ta:T?or:zt,Ee=z?r:oe(e);return _r(Ee||e,function(ae,Pe){Ee&&(Pe=ae,ae=e[Pe]),An(w,Pe,Er(ae,i,o,Pe,e,y))}),w}function gd(e){var i=zt(e);return function(o){return du(o,e,i)}}function du(e,i,o){var u=o.length;if(e==null)return!u;for(e=We(e);u--;){var f=o[u],y=i[f],w=e[f];if(w===r&&!(f in e)||!y(w))return!1}return!0}function gu(e,i,o){if(typeof e!="function")throw new wr(l);return qn(function(){e.apply(r,o)},i)}function Cn(e,i,o,u){var f=-1,y=Is,w=!0,E=e.length,T=[],M=i.length;if(!E)return T;o&&(i=nt(i,fr(o))),u?(y=Qo,w=!1):i.length>=s&&(y=xn,w=!1,i=new Di(i));e:for(;++f<E;){var z=e[f],K=o==null?z:o(z);if(z=u||z!==0?z:0,w&&K===K){for(var J=M;J--;)if(i[J]===K)continue e;T.push(z)}else y(i,K,u)||T.push(z)}return T}var yi=ku(Hr),yu=ku(fa,!0);function yd(e,i){var o=!0;return yi(e,function(u,f,y){return o=!!i(u,f,y),o}),o}function Hs(e,i,o){for(var u=-1,f=e.length;++u<f;){var y=e[u],w=i(y);if(w!=null&&(E===r?w===w&&!dr(w):o(w,E)))var E=w,T=y}return T}function vd(e,i,o,u){var f=e.length;for(o=we(o),o<0&&(o=-o>f?0:f+o),u=u===r||u>f?f:we(u),u<0&&(u+=f),u=o>u?0:Nh(u);o<u;)e[o++]=i;return e}function vu(e,i){var o=[];return yi(e,function(u,f,y){i(u,f,y)&&o.push(u)}),o}function Kt(e,i,o,u,f){var y=-1,w=e.length;for(o||(o=sg),f||(f=[]);++y<w;){var E=e[y];i>0&&o(E)?i>1?Kt(E,i-1,o,u,f):pi(f,E):u||(f[f.length]=E)}return f}var la=Ku(),mu=Ku(!0);function Hr(e,i){return e&&la(e,i,zt)}function fa(e,i){return e&&mu(e,i,zt)}function ks(e,i){return fi(i,function(o){return ei(e[o])})}function ji(e,i){i=mi(i,e);for(var o=0,u=i.length;e!=null&&o<u;)e=e[Kr(i[o++])];return o&&o==u?e:r}function _u(e,i,o){var u=i(e);return _e(e)?u:pi(u,o(e))}function Xt(e){return e==null?e===r?at:De:$i&&$i in We(e)?Zd(e):fg(e)}function pa(e,i){return e>i}function md(e,i){return e!=null&&ze.call(e,i)}function _d(e,i){return e!=null&&i in We(e)}function wd(e,i,o){return e>=Vt(i,o)&&e<jt(i,o)}function da(e,i,o){for(var u=o?Qo:Is,f=e[0].length,y=e.length,w=y,E=$(y),T=1/0,M=[];w--;){var z=e[w];w&&i&&(z=nt(z,fr(i))),T=Vt(z.length,T),E[w]=!o&&(i||f>=120&&z.length>=120)?new Di(w&&z):r}z=e[0];var K=-1,J=E[0];e:for(;++K<f&&M.length<T;){var te=z[K],oe=i?i(te):te;if(te=o||te!==0?te:0,!(J?xn(J,oe):u(M,oe,o))){for(w=y;--w;){var Ee=E[w];if(!(Ee?xn(Ee,oe):u(e[w],oe,o)))continue e}J&&J.push(oe),M.push(te)}}return M}function bd(e,i,o,u){return Hr(e,function(f,y,w){i(u,o(f),y,w)}),u}function $n(e,i,o){i=mi(i,e),e=oh(e,i);var u=e==null?e:e[Kr(xr(i))];return u==null?r:Mt(u,e,o)}function wu(e){return vt(e)&&Xt(e)==Ie}function Ed(e){return vt(e)&&Xt(e)==Ne}function Id(e){return vt(e)&&Xt(e)==A}function Nn(e,i,o,u,f){return e===i?!0:e==null||i==null||!vt(e)&&!vt(i)?e!==e&&i!==i:xd(e,i,o,u,Nn,f)}function xd(e,i,o,u,f,y){var w=_e(e),E=_e(i),T=w?It:Ft(e),M=E?It:Ft(i);T=T==Ie?Se:T,M=M==Ie?Se:M;var z=T==Se,K=M==Se,J=T==M;if(J&&wi(e)){if(!wi(i))return!1;w=!0,z=!1}if(J&&!z)return y||(y=new Cr),w||ln(e)?Zu(e,i,o,u,f,y):Yd(e,i,T,o,u,f,y);if(!(o&C)){var te=z&&ze.call(e,"__wrapped__"),oe=K&&ze.call(i,"__wrapped__");if(te||oe){var Ee=te?e.value():e,ae=oe?i.value():i;return y||(y=new Cr),f(Ee,ae,o,u,y)}}return J?(y||(y=new Cr),Xd(e,i,o,u,f,y)):!1}function Pd(e){return vt(e)&&Ft(e)==be}function ga(e,i,o,u){var f=o.length,y=f,w=!u;if(e==null)return!y;for(e=We(e);f--;){var E=o[f];if(w&&E[2]?E[1]!==e[E[0]]:!(E[0]in e))return!1}for(;++f<y;){E=o[f];var T=E[0],M=e[T],z=E[1];if(w&&E[2]){if(M===r&&!(T in e))return!1}else{var K=new Cr;if(u)var J=u(M,z,T,e,i,K);if(!(J===r?Nn(z,M,C|V,u,K):J))return!1}}return!0}function bu(e){if(!ut(e)||ag(e))return!1;var i=ei(e)?Pp:Do;return i.test(Mi(e))}function Sd(e){return vt(e)&&Xt(e)==ot}function Od(e){return vt(e)&&Ft(e)==je}function Rd(e){return vt(e)&&so(e.length)&&!!Ve[Xt(e)]}function Eu(e){return typeof e=="function"?e:e==null?ar:typeof e=="object"?_e(e)?Pu(e[0],e[1]):xu(e):Bh(e)}function ya(e){if(!jn(e))return Cp(e);var i=[];for(var o in We(e))ze.call(e,o)&&o!="constructor"&&i.push(o);return i}function Td(e){if(!ut(e))return lg(e);var i=jn(e),o=[];for(var u in e)u=="constructor"&&(i||!ze.call(e,u))||o.push(u);return o}function va(e,i){return e<i}function Iu(e,i){var o=-1,u=sr(e)?$(e.length):[];return yi(e,function(f,y,w){u[++o]=i(f,y,w)}),u}function xu(e){var i=$a(e);return i.length==1&&i[0][2]?nh(i[0][0],i[0][1]):function(o){return o===e||ga(o,e,i)}}function Pu(e,i){return Da(e)&&ih(i)?nh(Kr(e),i):function(o){var u=Ba(o,e);return u===r&&u===i?Va(o,e):Nn(i,u,C|V)}}function Ks(e,i,o,u,f){e!==i&&la(i,function(y,w){if(f||(f=new Cr),ut(y))Ad(e,i,w,o,Ks,u,f);else{var E=u?u(ja(e,w),y,w+"",e,i,f):r;E===r&&(E=y),ua(e,w,E)}},or)}function Ad(e,i,o,u,f,y,w){var E=ja(e,o),T=ja(i,o),M=w.get(T);if(M){ua(e,o,M);return}var z=y?y(E,T,o+"",e,i,w):r,K=z===r;if(K){var J=_e(T),te=!J&&wi(T),oe=!J&&!te&&ln(T);z=T,J||te||oe?_e(E)?z=E:bt(E)?z=nr(E):te?(K=!1,z=qu(T,!0)):oe?(K=!1,z=Mu(T,!0)):z=[]:Mn(T)||zi(T)?(z=E,zi(E)?z=Dh(E):(!ut(E)||ei(E))&&(z=rh(T))):K=!1}K&&(w.set(T,z),f(z,T,u,y,w),w.delete(T)),ua(e,o,z)}function Su(e,i){var o=e.length;if(o)return i+=i<0?o:0,Zr(i,o)?e[i]:r}function Ou(e,i,o){i.length?i=nt(i,function(y){return _e(y)?function(w){return ji(w,y.length===1?y[0]:y)}:y}):i=[ar];var u=-1;i=nt(i,fr(se()));var f=Iu(e,function(y,w,E){var T=nt(i,function(M){return M(y)});return{criteria:T,index:++u,value:y}});return ip(f,function(y,w){return Kd(y,w,o)})}function Cd(e,i){return Ru(e,i,function(o,u){return Va(e,u)})}function Ru(e,i,o){for(var u=-1,f=i.length,y={};++u<f;){var w=i[u],E=ji(e,w);o(E,w)&&Dn(y,mi(w,e),E)}return y}function $d(e){return function(i){return ji(i,e)}}function ma(e,i,o,u){var f=u?rp:Zi,y=-1,w=i.length,E=e;for(e===i&&(i=nr(i)),o&&(E=nt(e,fr(o)));++y<w;)for(var T=0,M=i[y],z=o?o(M):M;(T=f(E,z,T,u))>-1;)E!==e&&Ns.call(E,T,1),Ns.call(e,T,1);return e}function Tu(e,i){for(var o=e?i.length:0,u=o-1;o--;){var f=i[o];if(o==u||f!==y){var y=f;Zr(f)?Ns.call(e,f,1):Ea(e,f)}}return e}function _a(e,i){return e+js(uu()*(i-e+1))}function Nd(e,i,o,u){for(var f=-1,y=jt(Ls((i-e)/(o||1)),0),w=$(y);y--;)w[u?y:++f]=e,e+=o;return w}function wa(e,i){var o="";if(!e||i<1||i>F)return o;do i%2&&(o+=e),i=js(i/2),i&&(e+=e);while(i);return o}function xe(e,i){return qa(sh(e,i,ar),e+"")}function Dd(e){return fu(fn(e))}function Ld(e,i){var o=fn(e);return Zs(o,Li(i,0,o.length))}function Dn(e,i,o,u){if(!ut(e))return e;i=mi(i,e);for(var f=-1,y=i.length,w=y-1,E=e;E!=null&&++f<y;){var T=Kr(i[f]),M=o;if(T==="__proto__"||T==="constructor"||T==="prototype")return e;if(f!=w){var z=E[T];M=u?u(z,T,E):r,M===r&&(M=ut(z)?z:Zr(i[f+1])?[]:{})}An(E,T,M),E=E[T]}return e}var Au=qs?function(e,i){return qs.set(e,i),e}:ar,jd=Ds?function(e,i){return Ds(e,"toString",{configurable:!0,enumerable:!1,value:Ga(i),writable:!0})}:ar;function qd(e){return Zs(fn(e))}function Ir(e,i,o){var u=-1,f=e.length;i<0&&(i=-i>f?0:f+i),o=o>f?f:o,o<0&&(o+=f),f=i>o?0:o-i>>>0,i>>>=0;for(var y=$(f);++u<f;)y[u]=e[u+i];return y}function Md(e,i){var o;return yi(e,function(u,f,y){return o=i(u,f,y),!o}),!!o}function Bs(e,i,o){var u=0,f=e==null?u:e.length;if(typeof i=="number"&&i===i&&f<=Ke){for(;u<f;){var y=u+f>>>1,w=e[y];w!==null&&!dr(w)&&(o?w<=i:w<i)?u=y+1:f=y}return f}return ba(e,i,ar,o)}function ba(e,i,o,u){var f=0,y=e==null?0:e.length;if(y===0)return 0;i=o(i);for(var w=i!==i,E=i===null,T=dr(i),M=i===r;f<y;){var z=js((f+y)/2),K=o(e[z]),J=K!==r,te=K===null,oe=K===K,Ee=dr(K);if(w)var ae=u||oe;else M?ae=oe&&(u||J):E?ae=oe&&J&&(u||!te):T?ae=oe&&J&&!te&&(u||!Ee):te||Ee?ae=!1:ae=u?K<=i:K<i;ae?f=z+1:y=z}return Vt(y,Je)}function Cu(e,i){for(var o=-1,u=e.length,f=0,y=[];++o<u;){var w=e[o],E=i?i(w):w;if(!o||!$r(E,T)){var T=E;y[f++]=w===0?0:w}}return y}function $u(e){return typeof e=="number"?e:dr(e)?B:+e}function pr(e){if(typeof e=="string")return e;if(_e(e))return nt(e,pr)+"";if(dr(e))return hu?hu.call(e):"";var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function vi(e,i,o){var u=-1,f=Is,y=e.length,w=!0,E=[],T=E;if(o)w=!1,f=Qo;else if(y>=s){var M=i?null:Jd(e);if(M)return Ps(M);w=!1,f=xn,T=new Di}else T=i?[]:E;e:for(;++u<y;){var z=e[u],K=i?i(z):z;if(z=o||z!==0?z:0,w&&K===K){for(var J=T.length;J--;)if(T[J]===K)continue e;i&&T.push(K),E.push(z)}else f(T,K,o)||(T!==E&&T.push(K),E.push(z))}return E}function Ea(e,i){return i=mi(i,e),e=oh(e,i),e==null||delete e[Kr(xr(i))]}function Nu(e,i,o,u){return Dn(e,i,o(ji(e,i)),u)}function Vs(e,i,o,u){for(var f=e.length,y=u?f:-1;(u?y--:++y<f)&&i(e[y],y,e););return o?Ir(e,u?0:y,u?y+1:f):Ir(e,u?y+1:0,u?f:y)}function Du(e,i){var o=e;return o instanceof Oe&&(o=o.value()),Yo(i,function(u,f){return f.func.apply(f.thisArg,pi([u],f.args))},o)}function Ia(e,i,o){var u=e.length;if(u<2)return u?vi(e[0]):[];for(var f=-1,y=$(u);++f<u;)for(var w=e[f],E=-1;++E<u;)E!=f&&(y[f]=Cn(y[f]||w,e[E],i,o));return vi(Kt(y,1),i,o)}function Lu(e,i,o){for(var u=-1,f=e.length,y=i.length,w={};++u<f;){var E=u<y?i[u]:r;o(w,e[u],E)}return w}function xa(e){return bt(e)?e:[]}function Pa(e){return typeof e=="function"?e:ar}function mi(e,i){return _e(e)?e:Da(e,i)?[e]:hh(qe(e))}var zd=xe;function _i(e,i,o){var u=e.length;return o=o===r?u:o,!i&&o>=u?e:Ir(e,i,o)}var ju=Sp||function(e){return Te.clearTimeout(e)};function qu(e,i){if(i)return e.slice();var o=e.length,u=nu?nu(o):new e.constructor(o);return e.copy(u),u}function Sa(e){var i=new e.constructor(e.byteLength);return new Cs(i).set(new Cs(e)),i}function Ud(e,i){var o=i?Sa(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function Hd(e){var i=new e.constructor(e.source,vr.exec(e));return i.lastIndex=e.lastIndex,i}function kd(e){return Tn?We(Tn.call(e)):{}}function Mu(e,i){var o=i?Sa(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function zu(e,i){if(e!==i){var o=e!==r,u=e===null,f=e===e,y=dr(e),w=i!==r,E=i===null,T=i===i,M=dr(i);if(!E&&!M&&!y&&e>i||y&&w&&T&&!E&&!M||u&&w&&T||!o&&T||!f)return 1;if(!u&&!y&&!M&&e<i||M&&o&&f&&!u&&!y||E&&o&&f||!w&&f||!T)return-1}return 0}function Kd(e,i,o){for(var u=-1,f=e.criteria,y=i.criteria,w=f.length,E=o.length;++u<w;){var T=zu(f[u],y[u]);if(T){if(u>=E)return T;var M=o[u];return T*(M=="desc"?-1:1)}}return e.index-i.index}function Uu(e,i,o,u){for(var f=-1,y=e.length,w=o.length,E=-1,T=i.length,M=jt(y-w,0),z=$(T+M),K=!u;++E<T;)z[E]=i[E];for(;++f<w;)(K||f<y)&&(z[o[f]]=e[f]);for(;M--;)z[E++]=e[f++];return z}function Hu(e,i,o,u){for(var f=-1,y=e.length,w=-1,E=o.length,T=-1,M=i.length,z=jt(y-E,0),K=$(z+M),J=!u;++f<z;)K[f]=e[f];for(var te=f;++T<M;)K[te+T]=i[T];for(;++w<E;)(J||f<y)&&(K[te+o[w]]=e[f++]);return K}function nr(e,i){var o=-1,u=e.length;for(i||(i=$(u));++o<u;)i[o]=e[o];return i}function kr(e,i,o,u){var f=!o;o||(o={});for(var y=-1,w=i.length;++y<w;){var E=i[y],T=u?u(o[E],e[E],E,o,e):r;T===r&&(T=e[E]),f?Qr(o,E,T):An(o,E,T)}return o}function Bd(e,i){return kr(e,Na(e),i)}function Vd(e,i){return kr(e,eh(e),i)}function Fs(e,i){return function(o,u){var f=_e(o)?Qf:pd,y=i?i():{};return f(o,e,se(u,2),y)}}function cn(e){return xe(function(i,o){var u=-1,f=o.length,y=f>1?o[f-1]:r,w=f>2?o[2]:r;for(y=e.length>3&&typeof y=="function"?(f--,y):r,w&&Zt(o[0],o[1],w)&&(y=f<3?r:y,f=1),i=We(i);++u<f;){var E=o[u];E&&e(i,E,u,y)}return i})}function ku(e,i){return function(o,u){if(o==null)return o;if(!sr(o))return e(o,u);for(var f=o.length,y=i?f:-1,w=We(o);(i?y--:++y<f)&&u(w[y],y,w)!==!1;);return o}}function Ku(e){return function(i,o,u){for(var f=-1,y=We(i),w=u(i),E=w.length;E--;){var T=w[e?E:++f];if(o(y[T],T,y)===!1)break}return i}}function Fd(e,i,o){var u=i&re,f=Ln(e);function y(){var w=this&&this!==Te&&this instanceof y?f:e;return w.apply(u?o:this,arguments)}return y}function Bu(e){return function(i){i=qe(i);var o=en(i)?Ar(i):r,u=o?o[0]:i.charAt(0),f=o?_i(o,1).join(""):i.slice(1);return u[e]()+f}}function un(e){return function(i){return Yo(kh(Hh(i).replace(En,"")),e,"")}}function Ln(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=an(e.prototype),u=e.apply(o,i);return ut(u)?u:o}}function Gd(e,i,o){var u=Ln(e);function f(){for(var y=arguments.length,w=$(y),E=y,T=hn(f);E--;)w[E]=arguments[E];var M=y<3&&w[0]!==T&&w[y-1]!==T?[]:di(w,T);if(y-=M.length,y<o)return Ju(e,i,Gs,f.placeholder,r,w,M,r,r,o-y);var z=this&&this!==Te&&this instanceof f?u:e;return Mt(z,this,w)}return f}function Vu(e){return function(i,o,u){var f=We(i);if(!sr(i)){var y=se(o,3);i=zt(i),o=function(E){return y(f[E],E,f)}}var w=e(i,o,u);return w>-1?f[y?i[w]:w]:r}}function Fu(e){return Xr(function(i){var o=i.length,u=o,f=br.prototype.thru;for(e&&i.reverse();u--;){var y=i[u];if(typeof y!="function")throw new wr(l);if(f&&!w&&Ys(y)=="wrapper")var w=new br([],!0)}for(u=w?u:o;++u<o;){y=i[u];var E=Ys(y),T=E=="wrapper"?Ca(y):r;T&&La(T[0])&&T[1]==(H|fe|de|W)&&!T[4].length&&T[9]==1?w=w[Ys(T[0])].apply(w,T[3]):w=y.length==1&&La(y)?w[E]():w.thru(y)}return function(){var M=arguments,z=M[0];if(w&&M.length==1&&_e(z))return w.plant(z).value();for(var K=0,J=o?i[K].apply(this,M):z;++K<o;)J=i[K].call(this,J);return J}})}function Gs(e,i,o,u,f,y,w,E,T,M){var z=i&H,K=i&re,J=i&he,te=i&(fe|pe),oe=i&ve,Ee=J?r:Ln(e);function ae(){for(var Pe=arguments.length,Ae=$(Pe),gr=Pe;gr--;)Ae[gr]=arguments[gr];if(te)var er=hn(ae),yr=sp(Ae,er);if(u&&(Ae=Uu(Ae,u,f,te)),y&&(Ae=Hu(Ae,y,w,te)),Pe-=yr,te&&Pe<M){var Et=di(Ae,er);return Ju(e,i,Gs,ae.placeholder,o,Ae,Et,E,T,M-Pe)}var Nr=K?o:this,ri=J?Nr[e]:e;return Pe=Ae.length,E?Ae=pg(Ae,E):oe&&Pe>1&&Ae.reverse(),z&&T<Pe&&(Ae.length=T),this&&this!==Te&&this instanceof ae&&(ri=Ee||Ln(ri)),ri.apply(Nr,Ae)}return ae}function Gu(e,i){return function(o,u){return bd(o,e,i(u),{})}}function Ws(e,i){return function(o,u){var f;if(o===r&&u===r)return i;if(o!==r&&(f=o),u!==r){if(f===r)return u;typeof o=="string"||typeof u=="string"?(o=pr(o),u=pr(u)):(o=$u(o),u=$u(u)),f=e(o,u)}return f}}function Oa(e){return Xr(function(i){return i=nt(i,fr(se())),xe(function(o){var u=this;return e(i,function(f){return Mt(f,u,o)})})})}function Js(e,i){i=i===r?" ":pr(i);var o=i.length;if(o<2)return o?wa(i,e):i;var u=wa(i,Ls(e/tn(i)));return en(i)?_i(Ar(u),0,e).join(""):u.slice(0,e)}function Wd(e,i,o,u){var f=i&re,y=Ln(e);function w(){for(var E=-1,T=arguments.length,M=-1,z=u.length,K=$(z+T),J=this&&this!==Te&&this instanceof w?y:e;++M<z;)K[M]=u[M];for(;T--;)K[M++]=arguments[++E];return Mt(J,f?o:this,K)}return w}function Wu(e){return function(i,o,u){return u&&typeof u!="number"&&Zt(i,o,u)&&(o=u=r),i=ti(i),o===r?(o=i,i=0):o=ti(o),u=u===r?i<o?1:-1:ti(u),Nd(i,o,u,e)}}function Qs(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Pr(i),o=Pr(o)),e(i,o)}}function Ju(e,i,o,u,f,y,w,E,T,M){var z=i&fe,K=z?w:r,J=z?r:w,te=z?y:r,oe=z?r:y;i|=z?de:j,i&=~(z?j:de),i&le||(i&=~(re|he));var Ee=[e,i,f,te,K,oe,J,E,T,M],ae=o.apply(r,Ee);return La(e)&&ah(ae,Ee),ae.placeholder=u,ch(ae,e,i)}function Ra(e){var i=Lt[e];return function(o,u){if(o=Pr(o),u=u==null?0:Vt(we(u),292),u&&cu(o)){var f=(qe(o)+"e").split("e"),y=i(f[0]+"e"+(+f[1]+u));return f=(qe(y)+"e").split("e"),+(f[0]+"e"+(+f[1]-u))}return i(o)}}var Jd=sn&&1/Ps(new sn([,-0]))[1]==ce?function(e){return new sn(e)}:Qa;function Qu(e){return function(i){var o=Ft(i);return o==be?na(i):o==je?fp(i):np(i,e(i))}}function Yr(e,i,o,u,f,y,w,E){var T=i&he;if(!T&&typeof e!="function")throw new wr(l);var M=u?u.length:0;if(M||(i&=~(de|j),u=f=r),w=w===r?w:jt(we(w),0),E=E===r?E:we(E),M-=f?f.length:0,i&j){var z=u,K=f;u=f=r}var J=T?r:Ca(e),te=[e,i,o,u,f,z,K,y,w,E];if(J&&hg(te,J),e=te[0],i=te[1],o=te[2],u=te[3],f=te[4],E=te[9]=te[9]===r?T?0:e.length:jt(te[9]-M,0),!E&&i&(fe|pe)&&(i&=~(fe|pe)),!i||i==re)var oe=Fd(e,i,o);else i==fe||i==pe?oe=Gd(e,i,E):(i==de||i==(re|de))&&!f.length?oe=Wd(e,i,o,u):oe=Gs.apply(r,te);var Ee=J?Au:ah;return ch(Ee(oe,te),e,i)}function Yu(e,i,o,u){return e===r||$r(e,nn[o])&&!ze.call(u,o)?i:e}function Xu(e,i,o,u,f,y){return ut(e)&&ut(i)&&(y.set(i,e),Ks(e,i,r,Xu,y),y.delete(i)),e}function Qd(e){return Mn(e)?r:e}function Zu(e,i,o,u,f,y){var w=o&C,E=e.length,T=i.length;if(E!=T&&!(w&&T>E))return!1;var M=y.get(e),z=y.get(i);if(M&&z)return M==i&&z==e;var K=-1,J=!0,te=o&V?new Di:r;for(y.set(e,i),y.set(i,e);++K<E;){var oe=e[K],Ee=i[K];if(u)var ae=w?u(Ee,oe,K,i,e,y):u(oe,Ee,K,e,i,y);if(ae!==r){if(ae)continue;J=!1;break}if(te){if(!Xo(i,function(Pe,Ae){if(!xn(te,Ae)&&(oe===Pe||f(oe,Pe,o,u,y)))return te.push(Ae)})){J=!1;break}}else if(!(oe===Ee||f(oe,Ee,o,u,y))){J=!1;break}}return y.delete(e),y.delete(i),J}function Yd(e,i,o,u,f,y,w){switch(o){case Be:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Ne:return!(e.byteLength!=i.byteLength||!y(new Cs(e),new Cs(i)));case N:case A:case $e:return $r(+e,+i);case I:return e.name==i.name&&e.message==i.message;case ot:case Ye:return e==i+"";case be:var E=na;case je:var T=u&C;if(E||(E=Ps),e.size!=i.size&&!T)return!1;var M=w.get(e);if(M)return M==i;u|=V,w.set(e,i);var z=Zu(E(e),E(i),u,f,y,w);return w.delete(e),z;case Xe:if(Tn)return Tn.call(e)==Tn.call(i)}return!1}function Xd(e,i,o,u,f,y){var w=o&C,E=Ta(e),T=E.length,M=Ta(i),z=M.length;if(T!=z&&!w)return!1;for(var K=T;K--;){var J=E[K];if(!(w?J in i:ze.call(i,J)))return!1}var te=y.get(e),oe=y.get(i);if(te&&oe)return te==i&&oe==e;var Ee=!0;y.set(e,i),y.set(i,e);for(var ae=w;++K<T;){J=E[K];var Pe=e[J],Ae=i[J];if(u)var gr=w?u(Ae,Pe,J,i,e,y):u(Pe,Ae,J,e,i,y);if(!(gr===r?Pe===Ae||f(Pe,Ae,o,u,y):gr)){Ee=!1;break}ae||(ae=J=="constructor")}if(Ee&&!ae){var er=e.constructor,yr=i.constructor;er!=yr&&"constructor"in e&&"constructor"in i&&!(typeof er=="function"&&er instanceof er&&typeof yr=="function"&&yr instanceof yr)&&(Ee=!1)}return y.delete(e),y.delete(i),Ee}function Xr(e){return qa(sh(e,r,dh),e+"")}function Ta(e){return _u(e,zt,Na)}function Aa(e){return _u(e,or,eh)}var Ca=qs?function(e){return qs.get(e)}:Qa;function Ys(e){for(var i=e.name+"",o=on[i],u=ze.call(on,i)?o.length:0;u--;){var f=o[u],y=f.func;if(y==null||y==e)return f.name}return i}function hn(e){var i=ze.call(g,"placeholder")?g:e;return i.placeholder}function se(){var e=g.iteratee||Wa;return e=e===Wa?Eu:e,arguments.length?e(arguments[0],arguments[1]):e}function Xs(e,i){var o=e.__data__;return og(i)?o[typeof i=="string"?"string":"hash"]:o.map}function $a(e){for(var i=zt(e),o=i.length;o--;){var u=i[o],f=e[u];i[o]=[u,f,ih(f)]}return i}function qi(e,i){var o=up(e,i);return bu(o)?o:r}function Zd(e){var i=ze.call(e,$i),o=e[$i];try{e[$i]=r;var u=!0}catch{}var f=Ts.call(e);return u&&(i?e[$i]=o:delete e[$i]),f}var Na=oa?function(e){return e==null?[]:(e=We(e),fi(oa(e),function(i){return ou.call(e,i)}))}:Ya,eh=oa?function(e){for(var i=[];e;)pi(i,Na(e)),e=$s(e);return i}:Ya,Ft=Xt;(aa&&Ft(new aa(new ArrayBuffer(1)))!=Be||Sn&&Ft(new Sn)!=be||ca&&Ft(ca.resolve())!=xt||sn&&Ft(new sn)!=je||On&&Ft(new On)!=He)&&(Ft=function(e){var i=Xt(e),o=i==Se?e.constructor:r,u=o?Mi(o):"";if(u)switch(u){case Lp:return Be;case jp:return be;case qp:return xt;case Mp:return je;case zp:return He}return i});function eg(e,i,o){for(var u=-1,f=o.length;++u<f;){var y=o[u],w=y.size;switch(y.type){case"drop":e+=w;break;case"dropRight":i-=w;break;case"take":i=Vt(i,e+w);break;case"takeRight":e=jt(e,i-w);break}}return{start:e,end:i}}function tg(e){var i=e.match(Qe);return i?i[1].split(Tt):[]}function th(e,i,o){i=mi(i,e);for(var u=-1,f=i.length,y=!1;++u<f;){var w=Kr(i[u]);if(!(y=e!=null&&o(e,w)))break;e=e[w]}return y||++u!=f?y:(f=e==null?0:e.length,!!f&&so(f)&&Zr(w,f)&&(_e(e)||zi(e)))}function rg(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&ze.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function rh(e){return typeof e.constructor=="function"&&!jn(e)?an($s(e)):{}}function ig(e,i,o){var u=e.constructor;switch(i){case Ne:return Sa(e);case N:case A:return new u(+e);case Be:return Ud(e,o);case ht:case Me:case Pt:case Dt:case Ht:case kt:case qt:case Jt:case rr:return Mu(e,o);case be:return new u;case $e:case Ye:return new u(e);case ot:return Hd(e);case je:return new u;case Xe:return kd(e)}}function ng(e,i){var o=i.length;if(!o)return e;var u=o-1;return i[u]=(o>1?"& ":"")+i[u],i=i.join(o>2?", ":" "),e.replace(yt,`{
/* [wrapped with `+i+`] */
`)}function sg(e){return _e(e)||zi(e)||!!(au&&e&&e[au])}function Zr(e,i){var o=typeof e;return i=i??F,!!i&&(o=="number"||o!="symbol"&&jo.test(e))&&e>-1&&e%1==0&&e<i}function Zt(e,i,o){if(!ut(o))return!1;var u=typeof i;return(u=="number"?sr(o)&&Zr(i,o.length):u=="string"&&i in o)?$r(o[i],e):!1}function Da(e,i){if(_e(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||dr(e)?!0:St.test(e)||!it.test(e)||i!=null&&e in We(i)}function og(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function La(e){var i=Ys(e),o=g[i];if(typeof o!="function"||!(i in Oe.prototype))return!1;if(e===o)return!0;var u=Ca(o);return!!u&&e===u[0]}function ag(e){return!!iu&&iu in e}var cg=Os?ei:Xa;function jn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||nn;return e===o}function ih(e){return e===e&&!ut(e)}function nh(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in We(o))}}function ug(e){var i=io(e,function(u){return o.size===p&&o.clear(),u}),o=i.cache;return i}function hg(e,i){var o=e[1],u=i[1],f=o|u,y=f<(re|he|H),w=u==H&&o==fe||u==H&&o==W&&e[7].length<=i[8]||u==(H|W)&&i[7].length<=i[8]&&o==fe;if(!(y||w))return e;u&re&&(e[2]=i[2],f|=o&re?0:le);var E=i[3];if(E){var T=e[3];e[3]=T?Uu(T,E,i[4]):E,e[4]=T?di(e[3],b):i[4]}return E=i[5],E&&(T=e[5],e[5]=T?Hu(T,E,i[6]):E,e[6]=T?di(e[5],b):i[6]),E=i[7],E&&(e[7]=E),u&H&&(e[8]=e[8]==null?i[8]:Vt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=f,e}function lg(e){var i=[];if(e!=null)for(var o in We(e))i.push(o);return i}function fg(e){return Ts.call(e)}function sh(e,i,o){return i=jt(i===r?e.length-1:i,0),function(){for(var u=arguments,f=-1,y=jt(u.length-i,0),w=$(y);++f<y;)w[f]=u[i+f];f=-1;for(var E=$(i+1);++f<i;)E[f]=u[f];return E[i]=o(w),Mt(e,this,E)}}function oh(e,i){return i.length<2?e:ji(e,Ir(i,0,-1))}function pg(e,i){for(var o=e.length,u=Vt(i.length,o),f=nr(e);u--;){var y=i[u];e[u]=Zr(y,o)?f[y]:r}return e}function ja(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var ah=uh(Au),qn=Rp||function(e,i){return Te.setTimeout(e,i)},qa=uh(jd);function ch(e,i,o){var u=i+"";return qa(e,ng(u,dg(tg(u),o)))}function uh(e){var i=0,o=0;return function(){var u=$p(),f=Ue-(u-o);if(o=u,f>0){if(++i>=Ce)return arguments[0]}else i=0;return e.apply(r,arguments)}}function Zs(e,i){var o=-1,u=e.length,f=u-1;for(i=i===r?u:i;++o<i;){var y=_a(o,f),w=e[y];e[y]=e[o],e[o]=w}return e.length=i,e}var hh=ug(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Ot,function(o,u,f,y){i.push(f?y.replace(Ao,"$1"):u||o)}),i});function Kr(e){if(typeof e=="string"||dr(e))return e;var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function Mi(e){if(e!=null){try{return Rs.call(e)}catch{}try{return e+""}catch{}}return""}function dg(e,i){return _r(qr,function(o){var u="_."+o[0];i&o[1]&&!Is(e,u)&&e.push(u)}),e.sort()}function lh(e){if(e instanceof Oe)return e.clone();var i=new br(e.__wrapped__,e.__chain__);return i.__actions__=nr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function gg(e,i,o){(o?Zt(e,i,o):i===r)?i=1:i=jt(we(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var f=0,y=0,w=$(Ls(u/i));f<u;)w[y++]=Ir(e,f,f+=i);return w}function yg(e){for(var i=-1,o=e==null?0:e.length,u=0,f=[];++i<o;){var y=e[i];y&&(f[u++]=y)}return f}function vg(){var e=arguments.length;if(!e)return[];for(var i=$(e-1),o=arguments[0],u=e;u--;)i[u-1]=arguments[u];return pi(_e(o)?nr(o):[o],Kt(i,1))}var mg=xe(function(e,i){return bt(e)?Cn(e,Kt(i,1,bt,!0)):[]}),_g=xe(function(e,i){var o=xr(i);return bt(o)&&(o=r),bt(e)?Cn(e,Kt(i,1,bt,!0),se(o,2)):[]}),wg=xe(function(e,i){var o=xr(i);return bt(o)&&(o=r),bt(e)?Cn(e,Kt(i,1,bt,!0),r,o):[]});function bg(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:we(i),Ir(e,i<0?0:i,u)):[]}function Eg(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:we(i),i=u-i,Ir(e,0,i<0?0:i)):[]}function Ig(e,i){return e&&e.length?Vs(e,se(i,3),!0,!0):[]}function xg(e,i){return e&&e.length?Vs(e,se(i,3),!0):[]}function Pg(e,i,o,u){var f=e==null?0:e.length;return f?(o&&typeof o!="number"&&Zt(e,i,o)&&(o=0,u=f),vd(e,i,o,u)):[]}function fh(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=o==null?0:we(o);return f<0&&(f=jt(u+f,0)),xs(e,se(i,3),f)}function ph(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=u-1;return o!==r&&(f=we(o),f=o<0?jt(u+f,0):Vt(f,u-1)),xs(e,se(i,3),f,!0)}function dh(e){var i=e==null?0:e.length;return i?Kt(e,1):[]}function Sg(e){var i=e==null?0:e.length;return i?Kt(e,ce):[]}function Og(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:we(i),Kt(e,i)):[]}function Rg(e){for(var i=-1,o=e==null?0:e.length,u={};++i<o;){var f=e[i];u[f[0]]=f[1]}return u}function gh(e){return e&&e.length?e[0]:r}function Tg(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=o==null?0:we(o);return f<0&&(f=jt(u+f,0)),Zi(e,i,f)}function Ag(e){var i=e==null?0:e.length;return i?Ir(e,0,-1):[]}var Cg=xe(function(e){var i=nt(e,xa);return i.length&&i[0]===e[0]?da(i):[]}),$g=xe(function(e){var i=xr(e),o=nt(e,xa);return i===xr(o)?i=r:o.pop(),o.length&&o[0]===e[0]?da(o,se(i,2)):[]}),Ng=xe(function(e){var i=xr(e),o=nt(e,xa);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?da(o,r,i):[]});function Dg(e,i){return e==null?"":Ap.call(e,i)}function xr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function Lg(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=u;return o!==r&&(f=we(o),f=f<0?jt(u+f,0):Vt(f,u-1)),i===i?dp(e,i,f):xs(e,Jc,f,!0)}function jg(e,i){return e&&e.length?Su(e,we(i)):r}var qg=xe(yh);function yh(e,i){return e&&e.length&&i&&i.length?ma(e,i):e}function Mg(e,i,o){return e&&e.length&&i&&i.length?ma(e,i,se(o,2)):e}function zg(e,i,o){return e&&e.length&&i&&i.length?ma(e,i,r,o):e}var Ug=Xr(function(e,i){var o=e==null?0:e.length,u=ha(e,i);return Tu(e,nt(i,function(f){return Zr(f,o)?+f:f}).sort(zu)),u});function Hg(e,i){var o=[];if(!(e&&e.length))return o;var u=-1,f=[],y=e.length;for(i=se(i,3);++u<y;){var w=e[u];i(w,u,e)&&(o.push(w),f.push(u))}return Tu(e,f),o}function Ma(e){return e==null?e:Dp.call(e)}function kg(e,i,o){var u=e==null?0:e.length;return u?(o&&typeof o!="number"&&Zt(e,i,o)?(i=0,o=u):(i=i==null?0:we(i),o=o===r?u:we(o)),Ir(e,i,o)):[]}function Kg(e,i){return Bs(e,i)}function Bg(e,i,o){return ba(e,i,se(o,2))}function Vg(e,i){var o=e==null?0:e.length;if(o){var u=Bs(e,i);if(u<o&&$r(e[u],i))return u}return-1}function Fg(e,i){return Bs(e,i,!0)}function Gg(e,i,o){return ba(e,i,se(o,2),!0)}function Wg(e,i){var o=e==null?0:e.length;if(o){var u=Bs(e,i,!0)-1;if($r(e[u],i))return u}return-1}function Jg(e){return e&&e.length?Cu(e):[]}function Qg(e,i){return e&&e.length?Cu(e,se(i,2)):[]}function Yg(e){var i=e==null?0:e.length;return i?Ir(e,1,i):[]}function Xg(e,i,o){return e&&e.length?(i=o||i===r?1:we(i),Ir(e,0,i<0?0:i)):[]}function Zg(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:we(i),i=u-i,Ir(e,i<0?0:i,u)):[]}function ey(e,i){return e&&e.length?Vs(e,se(i,3),!1,!0):[]}function ty(e,i){return e&&e.length?Vs(e,se(i,3)):[]}var ry=xe(function(e){return vi(Kt(e,1,bt,!0))}),iy=xe(function(e){var i=xr(e);return bt(i)&&(i=r),vi(Kt(e,1,bt,!0),se(i,2))}),ny=xe(function(e){var i=xr(e);return i=typeof i=="function"?i:r,vi(Kt(e,1,bt,!0),r,i)});function sy(e){return e&&e.length?vi(e):[]}function oy(e,i){return e&&e.length?vi(e,se(i,2)):[]}function ay(e,i){return i=typeof i=="function"?i:r,e&&e.length?vi(e,r,i):[]}function za(e){if(!(e&&e.length))return[];var i=0;return e=fi(e,function(o){if(bt(o))return i=jt(o.length,i),!0}),ra(i,function(o){return nt(e,Zo(o))})}function vh(e,i){if(!(e&&e.length))return[];var o=za(e);return i==null?o:nt(o,function(u){return Mt(i,r,u)})}var cy=xe(function(e,i){return bt(e)?Cn(e,i):[]}),uy=xe(function(e){return Ia(fi(e,bt))}),hy=xe(function(e){var i=xr(e);return bt(i)&&(i=r),Ia(fi(e,bt),se(i,2))}),ly=xe(function(e){var i=xr(e);return i=typeof i=="function"?i:r,Ia(fi(e,bt),r,i)}),fy=xe(za);function py(e,i){return Lu(e||[],i||[],An)}function dy(e,i){return Lu(e||[],i||[],Dn)}var gy=xe(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,vh(e,o)});function mh(e){var i=g(e);return i.__chain__=!0,i}function yy(e,i){return i(e),e}function eo(e,i){return i(e)}var vy=Xr(function(e){var i=e.length,o=i?e[0]:0,u=this.__wrapped__,f=function(y){return ha(y,e)};return i>1||this.__actions__.length||!(u instanceof Oe)||!Zr(o)?this.thru(f):(u=u.slice(o,+o+(i?1:0)),u.__actions__.push({func:eo,args:[f],thisArg:r}),new br(u,this.__chain__).thru(function(y){return i&&!y.length&&y.push(r),y}))});function my(){return mh(this)}function _y(){return new br(this.value(),this.__chain__)}function wy(){this.__values__===r&&(this.__values__=$h(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function by(){return this}function Ey(e){for(var i,o=this;o instanceof zs;){var u=lh(o);u.__index__=0,u.__values__=r,i?f.__wrapped__=u:i=u;var f=u;o=o.__wrapped__}return f.__wrapped__=e,i}function Iy(){var e=this.__wrapped__;if(e instanceof Oe){var i=e;return this.__actions__.length&&(i=new Oe(this)),i=i.reverse(),i.__actions__.push({func:eo,args:[Ma],thisArg:r}),new br(i,this.__chain__)}return this.thru(Ma)}function xy(){return Du(this.__wrapped__,this.__actions__)}var Py=Fs(function(e,i,o){ze.call(e,o)?++e[o]:Qr(e,o,1)});function Sy(e,i,o){var u=_e(e)?Gc:yd;return o&&Zt(e,i,o)&&(i=r),u(e,se(i,3))}function Oy(e,i){var o=_e(e)?fi:vu;return o(e,se(i,3))}var Ry=Vu(fh),Ty=Vu(ph);function Ay(e,i){return Kt(to(e,i),1)}function Cy(e,i){return Kt(to(e,i),ce)}function $y(e,i,o){return o=o===r?1:we(o),Kt(to(e,i),o)}function _h(e,i){var o=_e(e)?_r:yi;return o(e,se(i,3))}function wh(e,i){var o=_e(e)?Yf:yu;return o(e,se(i,3))}var Ny=Fs(function(e,i,o){ze.call(e,o)?e[o].push(i):Qr(e,o,[i])});function Dy(e,i,o,u){e=sr(e)?e:fn(e),o=o&&!u?we(o):0;var f=e.length;return o<0&&(o=jt(f+o,0)),oo(e)?o<=f&&e.indexOf(i,o)>-1:!!f&&Zi(e,i,o)>-1}var Ly=xe(function(e,i,o){var u=-1,f=typeof i=="function",y=sr(e)?$(e.length):[];return yi(e,function(w){y[++u]=f?Mt(i,w,o):$n(w,i,o)}),y}),jy=Fs(function(e,i,o){Qr(e,o,i)});function to(e,i){var o=_e(e)?nt:Iu;return o(e,se(i,3))}function qy(e,i,o,u){return e==null?[]:(_e(i)||(i=i==null?[]:[i]),o=u?r:o,_e(o)||(o=o==null?[]:[o]),Ou(e,i,o))}var My=Fs(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function zy(e,i,o){var u=_e(e)?Yo:Yc,f=arguments.length<3;return u(e,se(i,4),o,f,yi)}function Uy(e,i,o){var u=_e(e)?Xf:Yc,f=arguments.length<3;return u(e,se(i,4),o,f,yu)}function Hy(e,i){var o=_e(e)?fi:vu;return o(e,no(se(i,3)))}function ky(e){var i=_e(e)?fu:Dd;return i(e)}function Ky(e,i,o){(o?Zt(e,i,o):i===r)?i=1:i=we(i);var u=_e(e)?ld:Ld;return u(e,i)}function By(e){var i=_e(e)?fd:qd;return i(e)}function Vy(e){if(e==null)return 0;if(sr(e))return oo(e)?tn(e):e.length;var i=Ft(e);return i==be||i==je?e.size:ya(e).length}function Fy(e,i,o){var u=_e(e)?Xo:Md;return o&&Zt(e,i,o)&&(i=r),u(e,se(i,3))}var Gy=xe(function(e,i){if(e==null)return[];var o=i.length;return o>1&&Zt(e,i[0],i[1])?i=[]:o>2&&Zt(i[0],i[1],i[2])&&(i=[i[0]]),Ou(e,Kt(i,1),[])}),ro=Op||function(){return Te.Date.now()};function Wy(e,i){if(typeof i!="function")throw new wr(l);return e=we(e),function(){if(--e<1)return i.apply(this,arguments)}}function bh(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,Yr(e,H,r,r,r,r,i)}function Eh(e,i){var o;if(typeof i!="function")throw new wr(l);return e=we(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var Ua=xe(function(e,i,o){var u=re;if(o.length){var f=di(o,hn(Ua));u|=de}return Yr(e,u,i,o,f)}),Ih=xe(function(e,i,o){var u=re|he;if(o.length){var f=di(o,hn(Ih));u|=de}return Yr(i,u,e,o,f)});function xh(e,i,o){i=o?r:i;var u=Yr(e,fe,r,r,r,r,r,i);return u.placeholder=xh.placeholder,u}function Ph(e,i,o){i=o?r:i;var u=Yr(e,pe,r,r,r,r,r,i);return u.placeholder=Ph.placeholder,u}function Sh(e,i,o){var u,f,y,w,E,T,M=0,z=!1,K=!1,J=!0;if(typeof e!="function")throw new wr(l);i=Pr(i)||0,ut(o)&&(z=!!o.leading,K="maxWait"in o,y=K?jt(Pr(o.maxWait)||0,i):y,J="trailing"in o?!!o.trailing:J);function te(Et){var Nr=u,ri=f;return u=f=r,M=Et,w=e.apply(ri,Nr),w}function oe(Et){return M=Et,E=qn(Pe,i),z?te(Et):w}function Ee(Et){var Nr=Et-T,ri=Et-M,Vh=i-Nr;return K?Vt(Vh,y-ri):Vh}function ae(Et){var Nr=Et-T,ri=Et-M;return T===r||Nr>=i||Nr<0||K&&ri>=y}function Pe(){var Et=ro();if(ae(Et))return Ae(Et);E=qn(Pe,Ee(Et))}function Ae(Et){return E=r,J&&u?te(Et):(u=f=r,w)}function gr(){E!==r&&ju(E),M=0,u=T=f=E=r}function er(){return E===r?w:Ae(ro())}function yr(){var Et=ro(),Nr=ae(Et);if(u=arguments,f=this,T=Et,Nr){if(E===r)return oe(T);if(K)return ju(E),E=qn(Pe,i),te(T)}return E===r&&(E=qn(Pe,i)),w}return yr.cancel=gr,yr.flush=er,yr}var Jy=xe(function(e,i){return gu(e,1,i)}),Qy=xe(function(e,i,o){return gu(e,Pr(i)||0,o)});function Yy(e){return Yr(e,ve)}function io(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new wr(l);var o=function(){var u=arguments,f=i?i.apply(this,u):u[0],y=o.cache;if(y.has(f))return y.get(f);var w=e.apply(this,u);return o.cache=y.set(f,w)||y,w};return o.cache=new(io.Cache||Jr),o}io.Cache=Jr;function no(e){if(typeof e!="function")throw new wr(l);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Xy(e){return Eh(2,e)}var Zy=zd(function(e,i){i=i.length==1&&_e(i[0])?nt(i[0],fr(se())):nt(Kt(i,1),fr(se()));var o=i.length;return xe(function(u){for(var f=-1,y=Vt(u.length,o);++f<y;)u[f]=i[f].call(this,u[f]);return Mt(e,this,u)})}),Ha=xe(function(e,i){var o=di(i,hn(Ha));return Yr(e,de,r,i,o)}),Oh=xe(function(e,i){var o=di(i,hn(Oh));return Yr(e,j,r,i,o)}),ev=Xr(function(e,i){return Yr(e,W,r,r,r,i)});function tv(e,i){if(typeof e!="function")throw new wr(l);return i=i===r?i:we(i),xe(e,i)}function rv(e,i){if(typeof e!="function")throw new wr(l);return i=i==null?0:jt(we(i),0),xe(function(o){var u=o[i],f=_i(o,0,i);return u&&pi(f,u),Mt(e,this,f)})}function iv(e,i,o){var u=!0,f=!0;if(typeof e!="function")throw new wr(l);return ut(o)&&(u="leading"in o?!!o.leading:u,f="trailing"in o?!!o.trailing:f),Sh(e,i,{leading:u,maxWait:i,trailing:f})}function nv(e){return bh(e,1)}function sv(e,i){return Ha(Pa(i),e)}function ov(){if(!arguments.length)return[];var e=arguments[0];return _e(e)?e:[e]}function av(e){return Er(e,D)}function cv(e,i){return i=typeof i=="function"?i:r,Er(e,D,i)}function uv(e){return Er(e,S|D)}function hv(e,i){return i=typeof i=="function"?i:r,Er(e,S|D,i)}function lv(e,i){return i==null||du(e,i,zt(i))}function $r(e,i){return e===i||e!==e&&i!==i}var fv=Qs(pa),pv=Qs(function(e,i){return e>=i}),zi=wu(function(){return arguments}())?wu:function(e){return vt(e)&&ze.call(e,"callee")&&!ou.call(e,"callee")},_e=$.isArray,dv=Yt?fr(Yt):Ed;function sr(e){return e!=null&&so(e.length)&&!ei(e)}function bt(e){return vt(e)&&sr(e)}function gv(e){return e===!0||e===!1||vt(e)&&Xt(e)==N}var wi=Tp||Xa,yv=Tr?fr(Tr):Id;function vv(e){return vt(e)&&e.nodeType===1&&!Mn(e)}function mv(e){if(e==null)return!0;if(sr(e)&&(_e(e)||typeof e=="string"||typeof e.splice=="function"||wi(e)||ln(e)||zi(e)))return!e.length;var i=Ft(e);if(i==be||i==je)return!e.size;if(jn(e))return!ya(e).length;for(var o in e)if(ze.call(e,o))return!1;return!0}function _v(e,i){return Nn(e,i)}function wv(e,i,o){o=typeof o=="function"?o:r;var u=o?o(e,i):r;return u===r?Nn(e,i,r,o):!!u}function ka(e){if(!vt(e))return!1;var i=Xt(e);return i==I||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Mn(e)}function bv(e){return typeof e=="number"&&cu(e)}function ei(e){if(!ut(e))return!1;var i=Xt(e);return i==ee||i==ge||i==L||i==mt}function Rh(e){return typeof e=="number"&&e==we(e)}function so(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=F}function ut(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function vt(e){return e!=null&&typeof e=="object"}var Th=mr?fr(mr):Pd;function Ev(e,i){return e===i||ga(e,i,$a(i))}function Iv(e,i,o){return o=typeof o=="function"?o:r,ga(e,i,$a(i),o)}function xv(e){return Ah(e)&&e!=+e}function Pv(e){if(cg(e))throw new ye(c);return bu(e)}function Sv(e){return e===null}function Ov(e){return e==null}function Ah(e){return typeof e=="number"||vt(e)&&Xt(e)==$e}function Mn(e){if(!vt(e)||Xt(e)!=Se)return!1;var i=$s(e);if(i===null)return!0;var o=ze.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Rs.call(o)==Ip}var Ka=Ur?fr(Ur):Sd;function Rv(e){return Rh(e)&&e>=-F&&e<=F}var Ch=In?fr(In):Od;function oo(e){return typeof e=="string"||!_e(e)&&vt(e)&&Xt(e)==Ye}function dr(e){return typeof e=="symbol"||vt(e)&&Xt(e)==Xe}var ln=Ci?fr(Ci):Rd;function Tv(e){return e===r}function Av(e){return vt(e)&&Ft(e)==He}function Cv(e){return vt(e)&&Xt(e)==Ze}var $v=Qs(va),Nv=Qs(function(e,i){return e<=i});function $h(e){if(!e)return[];if(sr(e))return oo(e)?Ar(e):nr(e);if(Pn&&e[Pn])return lp(e[Pn]());var i=Ft(e),o=i==be?na:i==je?Ps:fn;return o(e)}function ti(e){if(!e)return e===0?e:0;if(e=Pr(e),e===ce||e===-ce){var i=e<0?-1:1;return i*k}return e===e?e:0}function we(e){var i=ti(e),o=i%1;return i===i?o?i-o:i:0}function Nh(e){return e?Li(we(e),0,G):0}function Pr(e){if(typeof e=="number")return e;if(dr(e))return B;if(ut(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ut(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Xc(e);var o=No.test(e);return o||Lo.test(e)?me(e.slice(2),o?2:8):$o.test(e)?B:+e}function Dh(e){return kr(e,or(e))}function Dv(e){return e?Li(we(e),-F,F):e===0?e:0}function qe(e){return e==null?"":pr(e)}var Lv=cn(function(e,i){if(jn(i)||sr(i)){kr(i,zt(i),e);return}for(var o in i)ze.call(i,o)&&An(e,o,i[o])}),Lh=cn(function(e,i){kr(i,or(i),e)}),ao=cn(function(e,i,o,u){kr(i,or(i),e,u)}),jv=cn(function(e,i,o,u){kr(i,zt(i),e,u)}),qv=Xr(ha);function Mv(e,i){var o=an(e);return i==null?o:pu(o,i)}var zv=xe(function(e,i){e=We(e);var o=-1,u=i.length,f=u>2?i[2]:r;for(f&&Zt(i[0],i[1],f)&&(u=1);++o<u;)for(var y=i[o],w=or(y),E=-1,T=w.length;++E<T;){var M=w[E],z=e[M];(z===r||$r(z,nn[M])&&!ze.call(e,M))&&(e[M]=y[M])}return e}),Uv=xe(function(e){return e.push(r,Xu),Mt(jh,r,e)});function Hv(e,i){return Wc(e,se(i,3),Hr)}function kv(e,i){return Wc(e,se(i,3),fa)}function Kv(e,i){return e==null?e:la(e,se(i,3),or)}function Bv(e,i){return e==null?e:mu(e,se(i,3),or)}function Vv(e,i){return e&&Hr(e,se(i,3))}function Fv(e,i){return e&&fa(e,se(i,3))}function Gv(e){return e==null?[]:ks(e,zt(e))}function Wv(e){return e==null?[]:ks(e,or(e))}function Ba(e,i,o){var u=e==null?r:ji(e,i);return u===r?o:u}function Jv(e,i){return e!=null&&th(e,i,md)}function Va(e,i){return e!=null&&th(e,i,_d)}var Qv=Gu(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Ts.call(i)),e[i]=o},Ga(ar)),Yv=Gu(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Ts.call(i)),ze.call(e,i)?e[i].push(o):e[i]=[o]},se),Xv=xe($n);function zt(e){return sr(e)?lu(e):ya(e)}function or(e){return sr(e)?lu(e,!0):Td(e)}function Zv(e,i){var o={};return i=se(i,3),Hr(e,function(u,f,y){Qr(o,i(u,f,y),u)}),o}function em(e,i){var o={};return i=se(i,3),Hr(e,function(u,f,y){Qr(o,f,i(u,f,y))}),o}var tm=cn(function(e,i,o){Ks(e,i,o)}),jh=cn(function(e,i,o,u){Ks(e,i,o,u)}),rm=Xr(function(e,i){var o={};if(e==null)return o;var u=!1;i=nt(i,function(y){return y=mi(y,e),u||(u=y.length>1),y}),kr(e,Aa(e),o),u&&(o=Er(o,S|x|D,Qd));for(var f=i.length;f--;)Ea(o,i[f]);return o});function im(e,i){return qh(e,no(se(i)))}var nm=Xr(function(e,i){return e==null?{}:Cd(e,i)});function qh(e,i){if(e==null)return{};var o=nt(Aa(e),function(u){return[u]});return i=se(i),Ru(e,o,function(u,f){return i(u,f[0])})}function sm(e,i,o){i=mi(i,e);var u=-1,f=i.length;for(f||(f=1,e=r);++u<f;){var y=e==null?r:e[Kr(i[u])];y===r&&(u=f,y=o),e=ei(y)?y.call(e):y}return e}function om(e,i,o){return e==null?e:Dn(e,i,o)}function am(e,i,o,u){return u=typeof u=="function"?u:r,e==null?e:Dn(e,i,o,u)}var Mh=Qu(zt),zh=Qu(or);function cm(e,i,o){var u=_e(e),f=u||wi(e)||ln(e);if(i=se(i,4),o==null){var y=e&&e.constructor;f?o=u?new y:[]:ut(e)?o=ei(y)?an($s(e)):{}:o={}}return(f?_r:Hr)(e,function(w,E,T){return i(o,w,E,T)}),o}function um(e,i){return e==null?!0:Ea(e,i)}function hm(e,i,o){return e==null?e:Nu(e,i,Pa(o))}function lm(e,i,o,u){return u=typeof u=="function"?u:r,e==null?e:Nu(e,i,Pa(o),u)}function fn(e){return e==null?[]:ia(e,zt(e))}function fm(e){return e==null?[]:ia(e,or(e))}function pm(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Pr(o),o=o===o?o:0),i!==r&&(i=Pr(i),i=i===i?i:0),Li(Pr(e),i,o)}function dm(e,i,o){return i=ti(i),o===r?(o=i,i=0):o=ti(o),e=Pr(e),wd(e,i,o)}function gm(e,i,o){if(o&&typeof o!="boolean"&&Zt(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=ti(e),i===r?(i=e,e=0):i=ti(i)),e>i){var u=e;e=i,i=u}if(o||e%1||i%1){var f=uu();return Vt(e+f*(i-e+Fe("1e-"+((f+"").length-1))),i)}return _a(e,i)}var ym=un(function(e,i,o){return i=i.toLowerCase(),e+(o?Uh(i):i)});function Uh(e){return Fa(qe(e).toLowerCase())}function Hh(e){return e=qe(e),e&&e.replace(Fr,op).replace(Wo,"")}function vm(e,i,o){e=qe(e),i=pr(i);var u=e.length;o=o===r?u:Li(we(o),0,u);var f=o;return o-=i.length,o>=0&&e.slice(o,f)==i}function mm(e){return e=qe(e),e&&rt.test(e)?e.replace(Si,ap):e}function _m(e){return e=qe(e),e&&Rt.test(e)?e.replace(dt,"\\$&"):e}var wm=un(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),bm=un(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),Em=Bu("toLowerCase");function Im(e,i,o){e=qe(e),i=we(i);var u=i?tn(e):0;if(!i||u>=i)return e;var f=(i-u)/2;return Js(js(f),o)+e+Js(Ls(f),o)}function xm(e,i,o){e=qe(e),i=we(i);var u=i?tn(e):0;return i&&u<i?e+Js(i-u,o):e}function Pm(e,i,o){e=qe(e),i=we(i);var u=i?tn(e):0;return i&&u<i?Js(i-u,o)+e:e}function Sm(e,i,o){return o||i==null?i=0:i&&(i=+i),Np(qe(e).replace(gt,""),i||0)}function Om(e,i,o){return(o?Zt(e,i,o):i===r)?i=1:i=we(i),wa(qe(e),i)}function Rm(){var e=arguments,i=qe(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Tm=un(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function Am(e,i,o){return o&&typeof o!="number"&&Zt(e,i,o)&&(i=o=r),o=o===r?G:o>>>0,o?(e=qe(e),e&&(typeof i=="string"||i!=null&&!Ka(i))&&(i=pr(i),!i&&en(e))?_i(Ar(e),0,o):e.split(i,o)):[]}var Cm=un(function(e,i,o){return e+(o?" ":"")+Fa(i)});function $m(e,i,o){return e=qe(e),o=o==null?0:Li(we(o),0,e.length),i=pr(i),e.slice(o,o+i.length)==i}function Nm(e,i,o){var u=g.templateSettings;o&&Zt(e,i,o)&&(i=r),e=qe(e),i=ao({},i,u,Yu);var f=ao({},i.imports,u.imports,Yu),y=zt(f),w=ia(f,y),E,T,M=0,z=i.interpolate||Fi,K="__p += '",J=sa((i.escape||Fi).source+"|"+z.source+"|"+(z===ct?Co:Fi).source+"|"+(i.evaluate||Fi).source+"|$","g"),te="//# sourceURL="+(ze.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Jo+"]")+`
`;e.replace(J,function(ae,Pe,Ae,gr,er,yr){return Ae||(Ae=gr),K+=e.slice(M,yr).replace(qo,cp),Pe&&(E=!0,K+=`' +
__e(`+Pe+`) +
'`),er&&(T=!0,K+=`';
`+er+`;
__p += '`),Ae&&(K+=`' +
((__t = (`+Ae+`)) == null ? '' : __t) +
'`),M=yr+ae.length,ae}),K+=`';
`;var oe=ze.call(i,"variable")&&i.variable;if(!oe)K=`with (obj) {
`+K+`
}
`;else if(To.test(oe))throw new ye(d);K=(T?K.replace(Mr,""):K).replace(Qt,"$1").replace(Vr,"$1;"),K="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(E?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+K+`return __p
}`;var Ee=Kh(function(){return Le(y,te+"return "+K).apply(r,w)});if(Ee.source=K,ka(Ee))throw Ee;return Ee}function Dm(e){return qe(e).toLowerCase()}function Lm(e){return qe(e).toUpperCase()}function jm(e,i,o){if(e=qe(e),e&&(o||i===r))return Xc(e);if(!e||!(i=pr(i)))return e;var u=Ar(e),f=Ar(i),y=Zc(u,f),w=eu(u,f)+1;return _i(u,y,w).join("")}function qm(e,i,o){if(e=qe(e),e&&(o||i===r))return e.slice(0,ru(e)+1);if(!e||!(i=pr(i)))return e;var u=Ar(e),f=eu(u,Ar(i))+1;return _i(u,0,f).join("")}function Mm(e,i,o){if(e=qe(e),e&&(o||i===r))return e.replace(gt,"");if(!e||!(i=pr(i)))return e;var u=Ar(e),f=Zc(u,Ar(i));return _i(u,f).join("")}function zm(e,i){var o=ie,u=ue;if(ut(i)){var f="separator"in i?i.separator:f;o="length"in i?we(i.length):o,u="omission"in i?pr(i.omission):u}e=qe(e);var y=e.length;if(en(e)){var w=Ar(e);y=w.length}if(o>=y)return e;var E=o-tn(u);if(E<1)return u;var T=w?_i(w,0,E).join(""):e.slice(0,E);if(f===r)return T+u;if(w&&(E+=T.length-E),Ka(f)){if(e.slice(E).search(f)){var M,z=T;for(f.global||(f=sa(f.source,qe(vr.exec(f))+"g")),f.lastIndex=0;M=f.exec(z);)var K=M.index;T=T.slice(0,K===r?E:K)}}else if(e.indexOf(pr(f),E)!=E){var J=T.lastIndexOf(f);J>-1&&(T=T.slice(0,J))}return T+u}function Um(e){return e=qe(e),e&&lt.test(e)?e.replace(hi,gp):e}var Hm=un(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),Fa=Bu("toUpperCase");function kh(e,i,o){return e=qe(e),i=o?r:i,i===r?hp(e)?mp(e):tp(e):e.match(i)||[]}var Kh=xe(function(e,i){try{return Mt(e,r,i)}catch(o){return ka(o)?o:new ye(o)}}),km=Xr(function(e,i){return _r(i,function(o){o=Kr(o),Qr(e,o,Ua(e[o],e))}),e});function Km(e){var i=e==null?0:e.length,o=se();return e=i?nt(e,function(u){if(typeof u[1]!="function")throw new wr(l);return[o(u[0]),u[1]]}):[],xe(function(u){for(var f=-1;++f<i;){var y=e[f];if(Mt(y[0],this,u))return Mt(y[1],this,u)}})}function Bm(e){return gd(Er(e,S))}function Ga(e){return function(){return e}}function Vm(e,i){return e==null||e!==e?i:e}var Fm=Fu(),Gm=Fu(!0);function ar(e){return e}function Wa(e){return Eu(typeof e=="function"?e:Er(e,S))}function Wm(e){return xu(Er(e,S))}function Jm(e,i){return Pu(e,Er(i,S))}var Qm=xe(function(e,i){return function(o){return $n(o,e,i)}}),Ym=xe(function(e,i){return function(o){return $n(e,o,i)}});function Ja(e,i,o){var u=zt(i),f=ks(i,u);o==null&&!(ut(i)&&(f.length||!u.length))&&(o=i,i=e,e=this,f=ks(i,zt(i)));var y=!(ut(o)&&"chain"in o)||!!o.chain,w=ei(e);return _r(f,function(E){var T=i[E];e[E]=T,w&&(e.prototype[E]=function(){var M=this.__chain__;if(y||M){var z=e(this.__wrapped__),K=z.__actions__=nr(this.__actions__);return K.push({func:T,args:arguments,thisArg:e}),z.__chain__=M,z}return T.apply(e,pi([this.value()],arguments))})}),e}function Xm(){return Te._===this&&(Te._=xp),this}function Qa(){}function Zm(e){return e=we(e),xe(function(i){return Su(i,e)})}var e_=Oa(nt),t_=Oa(Gc),r_=Oa(Xo);function Bh(e){return Da(e)?Zo(Kr(e)):$d(e)}function i_(e){return function(i){return e==null?r:ji(e,i)}}var n_=Wu(),s_=Wu(!0);function Ya(){return[]}function Xa(){return!1}function o_(){return{}}function a_(){return""}function c_(){return!0}function u_(e,i){if(e=we(e),e<1||e>F)return[];var o=G,u=Vt(e,G);i=se(i),e-=G;for(var f=ra(u,i);++o<e;)i(o);return f}function h_(e){return _e(e)?nt(e,Kr):dr(e)?[e]:nr(hh(qe(e)))}function l_(e){var i=++Ep;return qe(e)+i}var f_=Ws(function(e,i){return e+i},0),p_=Ra("ceil"),d_=Ws(function(e,i){return e/i},1),g_=Ra("floor");function y_(e){return e&&e.length?Hs(e,ar,pa):r}function v_(e,i){return e&&e.length?Hs(e,se(i,2),pa):r}function m_(e){return Qc(e,ar)}function __(e,i){return Qc(e,se(i,2))}function w_(e){return e&&e.length?Hs(e,ar,va):r}function b_(e,i){return e&&e.length?Hs(e,se(i,2),va):r}var E_=Ws(function(e,i){return e*i},1),I_=Ra("round"),x_=Ws(function(e,i){return e-i},0);function P_(e){return e&&e.length?ta(e,ar):0}function S_(e,i){return e&&e.length?ta(e,se(i,2)):0}return g.after=Wy,g.ary=bh,g.assign=Lv,g.assignIn=Lh,g.assignInWith=ao,g.assignWith=jv,g.at=qv,g.before=Eh,g.bind=Ua,g.bindAll=km,g.bindKey=Ih,g.castArray=ov,g.chain=mh,g.chunk=gg,g.compact=yg,g.concat=vg,g.cond=Km,g.conforms=Bm,g.constant=Ga,g.countBy=Py,g.create=Mv,g.curry=xh,g.curryRight=Ph,g.debounce=Sh,g.defaults=zv,g.defaultsDeep=Uv,g.defer=Jy,g.delay=Qy,g.difference=mg,g.differenceBy=_g,g.differenceWith=wg,g.drop=bg,g.dropRight=Eg,g.dropRightWhile=Ig,g.dropWhile=xg,g.fill=Pg,g.filter=Oy,g.flatMap=Ay,g.flatMapDeep=Cy,g.flatMapDepth=$y,g.flatten=dh,g.flattenDeep=Sg,g.flattenDepth=Og,g.flip=Yy,g.flow=Fm,g.flowRight=Gm,g.fromPairs=Rg,g.functions=Gv,g.functionsIn=Wv,g.groupBy=Ny,g.initial=Ag,g.intersection=Cg,g.intersectionBy=$g,g.intersectionWith=Ng,g.invert=Qv,g.invertBy=Yv,g.invokeMap=Ly,g.iteratee=Wa,g.keyBy=jy,g.keys=zt,g.keysIn=or,g.map=to,g.mapKeys=Zv,g.mapValues=em,g.matches=Wm,g.matchesProperty=Jm,g.memoize=io,g.merge=tm,g.mergeWith=jh,g.method=Qm,g.methodOf=Ym,g.mixin=Ja,g.negate=no,g.nthArg=Zm,g.omit=rm,g.omitBy=im,g.once=Xy,g.orderBy=qy,g.over=e_,g.overArgs=Zy,g.overEvery=t_,g.overSome=r_,g.partial=Ha,g.partialRight=Oh,g.partition=My,g.pick=nm,g.pickBy=qh,g.property=Bh,g.propertyOf=i_,g.pull=qg,g.pullAll=yh,g.pullAllBy=Mg,g.pullAllWith=zg,g.pullAt=Ug,g.range=n_,g.rangeRight=s_,g.rearg=ev,g.reject=Hy,g.remove=Hg,g.rest=tv,g.reverse=Ma,g.sampleSize=Ky,g.set=om,g.setWith=am,g.shuffle=By,g.slice=kg,g.sortBy=Gy,g.sortedUniq=Jg,g.sortedUniqBy=Qg,g.split=Am,g.spread=rv,g.tail=Yg,g.take=Xg,g.takeRight=Zg,g.takeRightWhile=ey,g.takeWhile=ty,g.tap=yy,g.throttle=iv,g.thru=eo,g.toArray=$h,g.toPairs=Mh,g.toPairsIn=zh,g.toPath=h_,g.toPlainObject=Dh,g.transform=cm,g.unary=nv,g.union=ry,g.unionBy=iy,g.unionWith=ny,g.uniq=sy,g.uniqBy=oy,g.uniqWith=ay,g.unset=um,g.unzip=za,g.unzipWith=vh,g.update=hm,g.updateWith=lm,g.values=fn,g.valuesIn=fm,g.without=cy,g.words=kh,g.wrap=sv,g.xor=uy,g.xorBy=hy,g.xorWith=ly,g.zip=fy,g.zipObject=py,g.zipObjectDeep=dy,g.zipWith=gy,g.entries=Mh,g.entriesIn=zh,g.extend=Lh,g.extendWith=ao,Ja(g,g),g.add=f_,g.attempt=Kh,g.camelCase=ym,g.capitalize=Uh,g.ceil=p_,g.clamp=pm,g.clone=av,g.cloneDeep=uv,g.cloneDeepWith=hv,g.cloneWith=cv,g.conformsTo=lv,g.deburr=Hh,g.defaultTo=Vm,g.divide=d_,g.endsWith=vm,g.eq=$r,g.escape=mm,g.escapeRegExp=_m,g.every=Sy,g.find=Ry,g.findIndex=fh,g.findKey=Hv,g.findLast=Ty,g.findLastIndex=ph,g.findLastKey=kv,g.floor=g_,g.forEach=_h,g.forEachRight=wh,g.forIn=Kv,g.forInRight=Bv,g.forOwn=Vv,g.forOwnRight=Fv,g.get=Ba,g.gt=fv,g.gte=pv,g.has=Jv,g.hasIn=Va,g.head=gh,g.identity=ar,g.includes=Dy,g.indexOf=Tg,g.inRange=dm,g.invoke=Xv,g.isArguments=zi,g.isArray=_e,g.isArrayBuffer=dv,g.isArrayLike=sr,g.isArrayLikeObject=bt,g.isBoolean=gv,g.isBuffer=wi,g.isDate=yv,g.isElement=vv,g.isEmpty=mv,g.isEqual=_v,g.isEqualWith=wv,g.isError=ka,g.isFinite=bv,g.isFunction=ei,g.isInteger=Rh,g.isLength=so,g.isMap=Th,g.isMatch=Ev,g.isMatchWith=Iv,g.isNaN=xv,g.isNative=Pv,g.isNil=Ov,g.isNull=Sv,g.isNumber=Ah,g.isObject=ut,g.isObjectLike=vt,g.isPlainObject=Mn,g.isRegExp=Ka,g.isSafeInteger=Rv,g.isSet=Ch,g.isString=oo,g.isSymbol=dr,g.isTypedArray=ln,g.isUndefined=Tv,g.isWeakMap=Av,g.isWeakSet=Cv,g.join=Dg,g.kebabCase=wm,g.last=xr,g.lastIndexOf=Lg,g.lowerCase=bm,g.lowerFirst=Em,g.lt=$v,g.lte=Nv,g.max=y_,g.maxBy=v_,g.mean=m_,g.meanBy=__,g.min=w_,g.minBy=b_,g.stubArray=Ya,g.stubFalse=Xa,g.stubObject=o_,g.stubString=a_,g.stubTrue=c_,g.multiply=E_,g.nth=jg,g.noConflict=Xm,g.noop=Qa,g.now=ro,g.pad=Im,g.padEnd=xm,g.padStart=Pm,g.parseInt=Sm,g.random=gm,g.reduce=zy,g.reduceRight=Uy,g.repeat=Om,g.replace=Rm,g.result=sm,g.round=I_,g.runInContext=R,g.sample=ky,g.size=Vy,g.snakeCase=Tm,g.some=Fy,g.sortedIndex=Kg,g.sortedIndexBy=Bg,g.sortedIndexOf=Vg,g.sortedLastIndex=Fg,g.sortedLastIndexBy=Gg,g.sortedLastIndexOf=Wg,g.startCase=Cm,g.startsWith=$m,g.subtract=x_,g.sum=P_,g.sumBy=S_,g.template=Nm,g.times=u_,g.toFinite=ti,g.toInteger=we,g.toLength=Nh,g.toLower=Dm,g.toNumber=Pr,g.toSafeInteger=Dv,g.toString=qe,g.toUpper=Lm,g.trim=jm,g.trimEnd=qm,g.trimStart=Mm,g.truncate=zm,g.unescape=Um,g.uniqueId=l_,g.upperCase=Hm,g.upperFirst=Fa,g.each=_h,g.eachRight=wh,g.first=gh,Ja(g,function(){var e={};return Hr(g,function(i,o){ze.call(g.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),g.VERSION=n,_r(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){g[e].placeholder=g}),_r(["drop","take"],function(e,i){Oe.prototype[e]=function(o){o=o===r?1:jt(we(o),0);var u=this.__filtered__&&!i?new Oe(this):this.clone();return u.__filtered__?u.__takeCount__=Vt(o,u.__takeCount__):u.__views__.push({size:Vt(o,G),type:e+(u.__dir__<0?"Right":"")}),u},Oe.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),_r(["filter","map","takeWhile"],function(e,i){var o=i+1,u=o==m||o==X;Oe.prototype[e]=function(f){var y=this.clone();return y.__iteratees__.push({iteratee:se(f,3),type:o}),y.__filtered__=y.__filtered__||u,y}}),_r(["head","last"],function(e,i){var o="take"+(i?"Right":"");Oe.prototype[e]=function(){return this[o](1).value()[0]}}),_r(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Oe.prototype[e]=function(){return this.__filtered__?new Oe(this):this[o](1)}}),Oe.prototype.compact=function(){return this.filter(ar)},Oe.prototype.find=function(e){return this.filter(e).head()},Oe.prototype.findLast=function(e){return this.reverse().find(e)},Oe.prototype.invokeMap=xe(function(e,i){return typeof e=="function"?new Oe(this):this.map(function(o){return $n(o,e,i)})}),Oe.prototype.reject=function(e){return this.filter(no(se(e)))},Oe.prototype.slice=function(e,i){e=we(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Oe(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=we(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Oe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Oe.prototype.toArray=function(){return this.take(G)},Hr(Oe.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),f=g[u?"take"+(i=="last"?"Right":""):i],y=u||/^find/.test(i);f&&(g.prototype[i]=function(){var w=this.__wrapped__,E=u?[1]:arguments,T=w instanceof Oe,M=E[0],z=T||_e(w),K=function(Pe){var Ae=f.apply(g,pi([Pe],E));return u&&J?Ae[0]:Ae};z&&o&&typeof M=="function"&&M.length!=1&&(T=z=!1);var J=this.__chain__,te=!!this.__actions__.length,oe=y&&!J,Ee=T&&!te;if(!y&&z){w=Ee?w:new Oe(this);var ae=e.apply(w,E);return ae.__actions__.push({func:eo,args:[K],thisArg:r}),new br(ae,J)}return oe&&Ee?e.apply(this,E):(ae=this.thru(K),oe?u?ae.value()[0]:ae.value():ae)})}),_r(["pop","push","shift","sort","splice","unshift"],function(e){var i=Ss[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);g.prototype[e]=function(){var f=arguments;if(u&&!this.__chain__){var y=this.value();return i.apply(_e(y)?y:[],f)}return this[o](function(w){return i.apply(_e(w)?w:[],f)})}}),Hr(Oe.prototype,function(e,i){var o=g[i];if(o){var u=o.name+"";ze.call(on,u)||(on[u]=[]),on[u].push({name:i,func:o})}}),on[Gs(r,he).name]=[{name:"wrapper",func:r}],Oe.prototype.clone=Up,Oe.prototype.reverse=Hp,Oe.prototype.value=kp,g.prototype.at=vy,g.prototype.chain=my,g.prototype.commit=_y,g.prototype.next=wy,g.prototype.plant=Ey,g.prototype.reverse=Iy,g.prototype.toJSON=g.prototype.valueOf=g.prototype.value=xy,g.prototype.first=g.prototype.head,Pn&&(g.prototype[Pn]=by),g},rn=_p();wt?((wt.exports=rn)._=rn,Ge._=rn):Te._=rn}).call(Vn)})($c,$c.exports);var ax=Object.defineProperty,cx=Object.defineProperties,ux=Object.getOwnPropertyDescriptors,Gl=Object.getOwnPropertySymbols,hx=Object.prototype.hasOwnProperty,lx=Object.prototype.propertyIsEnumerable,Wl=(a,t,r)=>t in a?ax(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,fo=(a,t)=>{for(var r in t||(t={}))hx.call(t,r)&&Wl(a,r,t[r]);if(Gl)for(var r of Gl(t))lx.call(t,r)&&Wl(a,r,t[r]);return a},fx=(a,t)=>cx(a,ux(t));function xi(a,t,r){var n;const s=pw(a);return((n=t.rpcMap)==null?void 0:n[s.reference])||`${ox}?chainId=${s.namespace}:${s.reference}&projectId=${r}`}function Vi(a){return a.includes(":")?a.split(":")[1]:a}function Wf(a){return a.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function px(a,t){const r=Object.keys(t.namespaces).filter(s=>s.includes(a));if(!r.length)return[];const n=[];return r.forEach(s=>{const c=t.namespaces[s].accounts;n.push(...c)}),n}function dx(a={},t={}){const r=Jl(a),n=Jl(t);return $c.exports.merge(r,n)}function Jl(a){var t,r,n,s;const c={};if(!yo(a))return c;for(const[l,d]of Object.entries(a)){const _=uf(l)?[l]:d.chains,p=d.methods||[],b=d.events||[],S=d.rpcMap||{},x=Fn(l);c[x]=fx(fo(fo({},c[x]),d),{chains:ec(_,(t=c[x])==null?void 0:t.chains),methods:ec(p,(r=c[x])==null?void 0:r.methods),events:ec(b,(n=c[x])==null?void 0:n.events),rpcMap:fo(fo({},S),(s=c[x])==null?void 0:s.rpcMap)})}return c}function gx(a){return a.includes(":")?a.split(":")[2]:a}function yx(a){const t={};for(const[r,n]of Object.entries(a)){const s=n.methods||[],c=n.events||[],l=n.accounts||[],d=uf(r)?[r]:n.chains?n.chains:Wf(n.accounts);t[r]={chains:d,methods:s,events:c,accounts:l}}return t}function fc(a){return typeof a=="number"?a:a.includes("0x")?parseInt(a,16):a.includes(":")?Number(a.split(":")[1]):Number(a)}const Jf={},st=a=>Jf[a],pc=(a,t)=>{Jf[a]=t};class vx{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Vi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ci(new Pi(n,st("disableProviderPing")))}}class mx{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const n=r||xi(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ci(new Pi(n,st("disableProviderPing")))}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=parseInt(Vi(r));t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,n;let s=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const c=parseInt(s,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class _x{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Vi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ci(new Pi(n,st("disableProviderPing")))}}class wx{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Vi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ci(new Pi(n,st("disableProviderPing")))}}class bx{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),s=Vi(r);t[s]=this.createHttpProvider(s,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ci(new Pi(n,st("disableProviderPing")))}}class Ex{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Vi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ci(new Pi(n,st("disableProviderPing")))}}class Ix{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Vi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ci(new Pi(n,st("disableProviderPing")))}}class xx{constructor(t){this.name="near",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const n=r||xi(`${this.name}:${t}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;t[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace);return typeof n>"u"?void 0:new ci(new Pi(n,st("disableProviderPing")))}}var Px=Object.defineProperty,Sx=Object.defineProperties,Ox=Object.getOwnPropertyDescriptors,Ql=Object.getOwnPropertySymbols,Rx=Object.prototype.hasOwnProperty,Tx=Object.prototype.propertyIsEnumerable,Yl=(a,t,r)=>t in a?Px(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,po=(a,t)=>{for(var r in t||(t={}))Rx.call(t,r)&&Yl(a,r,t[r]);if(Ql)for(var r of Ql(t))Tx.call(t,r)&&Yl(a,r,t[r]);return a},dc=(a,t)=>Sx(a,Ox(t));class Vc{constructor(t){this.events=new qc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Vl})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Vc(t);return await r.initialize(),r}async request(t,r){const[n,s]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:po({},t),chainId:`${n}:${s}`,topic:this.session.topic})}sendAsync(t,r,n){const s=new Date().getTime();this.request(t,n).then(c=>r(null,xo(s,c))).catch(c=>r(c,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Gt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:s}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await s().then(c=>{this.session=c,this.namespaces||(this.namespaces=yx(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==Ff)throw c;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[n,s]=this.validateChain(t);this.getProvider(n).setDefaultChain(s,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(mn(r)){for(const n of r)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await ZI.init({logger:this.providerOpts.logger||Vl,relayUrl:this.providerOpts.relayUrl||ix,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>Fn(r)))];pc("client",this.client),pc("events",this.events),pc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const n=px(r,this.session),s=Wf(n),c=dx(this.namespaces,this.optionalNamespaces),l=dc(po({},c[r]),{accounts:n,chains:s});switch(r){case"eip155":this.rpcProviders[r]=new mx({namespace:l});break;case"solana":this.rpcProviders[r]=new _x({namespace:l});break;case"cosmos":this.rpcProviders[r]=new wx({namespace:l});break;case"polkadot":this.rpcProviders[r]=new vx({namespace:l});break;case"cip34":this.rpcProviders[r]=new bx({namespace:l});break;case"elrond":this.rpcProviders[r]=new Ex({namespace:l});break;case"multiversx":this.rpcProviders[r]=new Ix({namespace:l});break;case"near":this.rpcProviders[r]=new xx({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:n}=r;if(n.name==="accountsChanged"){const s=n.data;s&&mn(s)&&this.events.emit("accountsChanged",s.map(gx))}else if(n.name==="chainChanged"){const s=r.chainId,c=r.event.data,l=Fn(s),d=fc(s)!==fc(c)?`${l}:${fc(c)}`:s;this.onChainChanged(d)}else this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var n;const{namespaces:s}=r,c=(n=this.client)==null?void 0:n.session.get(t);this.session=dc(po({},c),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",dc(po({},Gt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(ui.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:n,sessionProperties:s}=t;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=s,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(t){const[r,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(l=>Fn(l)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const s=Fn(Object.keys(this.namespaces)[0]),c=this.rpcProviders[s].getDefaultChain();return[s,c]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var n;if(!this.namespaces)return;const[s,c]=this.validateChain(t);r||this.getProvider(s).setDefaultChain(c),((n=this.namespaces[s])!=null?n:this.namespaces[`${s}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Fl}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Fl}/${t}`)}}const Ax=Vc,Cx="wc",$x="ethereum_provider",Nx=`${Cx}@2:${$x}:`,Dx="https://rpc.walletconnect.com/v1/",Nc=["eth_sendTransaction","personal_sign"],Lx=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Dc=["chainChanged","accountsChanged"],jx=["chainChanged","accountsChanged","message","disconnect","connect"];var qx=Object.defineProperty,Mx=Object.defineProperties,zx=Object.getOwnPropertyDescriptors,Xl=Object.getOwnPropertySymbols,Ux=Object.prototype.hasOwnProperty,Hx=Object.prototype.propertyIsEnumerable,Zl=(a,t,r)=>t in a?qx(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Wn=(a,t)=>{for(var r in t||(t={}))Ux.call(t,r)&&Zl(a,r,t[r]);if(Xl)for(var r of Xl(t))Hx.call(t,r)&&Zl(a,r,t[r]);return a},ef=(a,t)=>Mx(a,zx(t));function bo(a){return Number(a[0].split(":")[1])}function gc(a){return`0x${a.toString(16)}`}function kx(a){const{chains:t,optionalChains:r,methods:n,optionalMethods:s,events:c,optionalEvents:l,rpcMap:d}=a;if(!mn(t))throw new Error("Invalid chains");const _={chains:t,methods:n||Nc,events:c||Dc,rpcMap:Wn({},t.length?{[bo(t)]:d[bo(t)]}:{})},p=c==null?void 0:c.filter(D=>!Dc.includes(D)),b=n==null?void 0:n.filter(D=>!Nc.includes(D));if(!r&&!l&&!s&&!(p!=null&&p.length)&&!(b!=null&&b.length))return{required:t.length?_:void 0};const S=(p==null?void 0:p.length)&&(b==null?void 0:b.length)||!r,x={chains:[...new Set(S?_.chains.concat(r||[]):r)],methods:[...new Set(_.methods.concat(s!=null&&s.length?s:Lx))],events:[...new Set(_.events.concat(l!=null&&l.length?l:jx))],rpcMap:d};return{required:t.length?_:void 0,optional:r.length?x:void 0}}class Fc{constructor(){this.events=new Or.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=Nx,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new Fc;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:n}=kx(this.rpc);try{const s=await new Promise(async(l,d)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),d(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(ef(Wn({namespaces:Wn({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(p=>{l(p)}).catch(p=>{d(new Error(p.message))})});if(!s)return;const c=dw(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:gc(this.chainId)})}catch(s){throw this.signer.logger.error(s),s}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",gc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",ef(Wn({},Gt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",gc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,n,s]=t.split(":");return{chainId:`${r}:${n}`,address:s}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,n;const s=(r=t==null?void 0:t.chains)!=null?r:[],c=(n=t==null?void 0:t.optionalChains)!=null?n:[],l=s.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const d=s.length?(t==null?void 0:t.methods)||Nc:[],_=s.length?(t==null?void 0:t.events)||Dc:[],p=(t==null?void 0:t.optionalMethods)||[],b=(t==null?void 0:t.optionalEvents)||[],S=(t==null?void 0:t.rpcMap)||this.buildRpcMap(l,t.projectId),x=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:s==null?void 0:s.map(D=>this.formatChainId(D)),optionalChains:c.map(D=>this.formatChainId(D)),methods:d,events:_,optionalMethods:p,optionalEvents:b,rpcMap:S,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:x,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const n={};return t.forEach(s=>{n[s]=this.getRpcUrl(s,r)}),n}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?bo(this.rpc.chains):bo(this.rpc.optionalChains),this.signer=await Ax.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await gw(()=>import("./index-I64FNLPf.js").then(s=>s.i),__vite__mapDeps([0,1,2]));r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Wn({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:n,rpcMap:s}=t;r&&mn(r)&&(this.rpc.chains=r.map(c=>this.formatChainId(c)),r.forEach(c=>{this.rpc.rpcMap[c]=(s==null?void 0:s[c])||this.getRpcUrl(c)})),n&&mn(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(c=>this.formatChainId(c)),n.forEach(c=>{this.rpc.rpcMap[c]=(s==null?void 0:s[c])||this.getRpcUrl(c)}))}getRpcUrl(t,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[t])||`${Dx}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const nP=Fc;export{nP as EthereumProvider,jx as OPTIONAL_EVENTS,Lx as OPTIONAL_METHODS,Dc as REQUIRED_EVENTS,Nc as REQUIRED_METHODS,Fc as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-I64FNLPf.js","assets/index-d5cPsESa.js","assets/index-A6_kHUeh.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
